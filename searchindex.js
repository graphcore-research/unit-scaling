Search.setIndex({"docnames": ["api_reference", "blog", "development", "generated/unit_scaling", "generated/unit_scaling.CrossEntropyLoss", "generated/unit_scaling.Dropout", "generated/unit_scaling.Embedding", "generated/unit_scaling.GELU", "generated/unit_scaling.LayerNorm", "generated/unit_scaling.Linear", "generated/unit_scaling.MHSA", "generated/unit_scaling.MLP", "generated/unit_scaling.Softmax", "generated/unit_scaling.TransformerDecoder", "generated/unit_scaling.TransformerLayer", "generated/unit_scaling.analysis", "generated/unit_scaling.analysis.example_batch", "generated/unit_scaling.analysis.graph_to_dataframe", "generated/unit_scaling.analysis.plot", "generated/unit_scaling.analysis.visualiser", "generated/unit_scaling.constraints", "generated/unit_scaling.constraints.amean", "generated/unit_scaling.constraints.apply_constraint", "generated/unit_scaling.constraints.gmean", "generated/unit_scaling.constraints.hmean", "generated/unit_scaling.constraints.to_grad_input_scale", "generated/unit_scaling.constraints.to_left_grad_scale", "generated/unit_scaling.constraints.to_output_scale", "generated/unit_scaling.constraints.to_right_grad_scale", "generated/unit_scaling.formats", "generated/unit_scaling.formats.FPFormat", "generated/unit_scaling.formats.format_to_tuple", "generated/unit_scaling.formats.tuple_to_format", "generated/unit_scaling.functional", "generated/unit_scaling.functional.add", "generated/unit_scaling.functional.cross_entropy", "generated/unit_scaling.functional.dropout", "generated/unit_scaling.functional.embedding", "generated/unit_scaling.functional.gelu", "generated/unit_scaling.functional.layer_norm", "generated/unit_scaling.functional.linear", "generated/unit_scaling.functional.matmul", "generated/unit_scaling.functional.residual_add", "generated/unit_scaling.functional.residual_split", "generated/unit_scaling.functional.scale_elementwise", "generated/unit_scaling.functional.scaled_dot_product_attention", "generated/unit_scaling.functional.softmax", "generated/unit_scaling.scale", "generated/unit_scaling.scale.scale_bwd", "generated/unit_scaling.scale.scale_fwd", "generated/unit_scaling.transforms", "generated/unit_scaling.transforms.Metrics", "generated/unit_scaling.transforms.compile", "generated/unit_scaling.transforms.prune_non_float_tensors", "generated/unit_scaling.transforms.prune_same_scale_tensors", "generated/unit_scaling.transforms.prune_selected_nodes", "generated/unit_scaling.transforms.simulate_format", "generated/unit_scaling.transforms.simulate_fp8", "generated/unit_scaling.transforms.track_scales", "generated/unit_scaling.transforms.unit_scale", "generated/unit_scaling.transforms.utils", "generated/unit_scaling.transforms.utils.apply_transform", "generated/unit_scaling.transforms.utils.patch_to_expand_modules", "generated/unit_scaling.transforms.utils.replace_node_with_function", "generated/unit_scaling.utils", "generated/unit_scaling.utils.ScalePair", "generated/unit_scaling.utils.ScaleTracker", "generated/unit_scaling.utils.ScaleTrackingInterpreter", "generated/unit_scaling.utils.analyse_module", "generated/unit_scaling.visualiser", "index", "limitations", "posts/almost_scaled_dot_product_attention", "user_guide"], "filenames": ["api_reference.rst", "blog.rst", "development.rst", "generated/unit_scaling.rst", "generated/unit_scaling.CrossEntropyLoss.rst", "generated/unit_scaling.Dropout.rst", "generated/unit_scaling.Embedding.rst", "generated/unit_scaling.GELU.rst", "generated/unit_scaling.LayerNorm.rst", "generated/unit_scaling.Linear.rst", "generated/unit_scaling.MHSA.rst", "generated/unit_scaling.MLP.rst", "generated/unit_scaling.Softmax.rst", "generated/unit_scaling.TransformerDecoder.rst", "generated/unit_scaling.TransformerLayer.rst", "generated/unit_scaling.analysis.rst", "generated/unit_scaling.analysis.example_batch.rst", "generated/unit_scaling.analysis.graph_to_dataframe.rst", "generated/unit_scaling.analysis.plot.rst", "generated/unit_scaling.analysis.visualiser.rst", "generated/unit_scaling.constraints.rst", "generated/unit_scaling.constraints.amean.rst", "generated/unit_scaling.constraints.apply_constraint.rst", "generated/unit_scaling.constraints.gmean.rst", "generated/unit_scaling.constraints.hmean.rst", "generated/unit_scaling.constraints.to_grad_input_scale.rst", "generated/unit_scaling.constraints.to_left_grad_scale.rst", "generated/unit_scaling.constraints.to_output_scale.rst", "generated/unit_scaling.constraints.to_right_grad_scale.rst", "generated/unit_scaling.formats.rst", "generated/unit_scaling.formats.FPFormat.rst", "generated/unit_scaling.formats.format_to_tuple.rst", "generated/unit_scaling.formats.tuple_to_format.rst", "generated/unit_scaling.functional.rst", "generated/unit_scaling.functional.add.rst", "generated/unit_scaling.functional.cross_entropy.rst", "generated/unit_scaling.functional.dropout.rst", "generated/unit_scaling.functional.embedding.rst", "generated/unit_scaling.functional.gelu.rst", "generated/unit_scaling.functional.layer_norm.rst", "generated/unit_scaling.functional.linear.rst", "generated/unit_scaling.functional.matmul.rst", "generated/unit_scaling.functional.residual_add.rst", "generated/unit_scaling.functional.residual_split.rst", "generated/unit_scaling.functional.scale_elementwise.rst", "generated/unit_scaling.functional.scaled_dot_product_attention.rst", "generated/unit_scaling.functional.softmax.rst", "generated/unit_scaling.scale.rst", "generated/unit_scaling.scale.scale_bwd.rst", "generated/unit_scaling.scale.scale_fwd.rst", "generated/unit_scaling.transforms.rst", "generated/unit_scaling.transforms.Metrics.rst", "generated/unit_scaling.transforms.compile.rst", "generated/unit_scaling.transforms.prune_non_float_tensors.rst", "generated/unit_scaling.transforms.prune_same_scale_tensors.rst", "generated/unit_scaling.transforms.prune_selected_nodes.rst", "generated/unit_scaling.transforms.simulate_format.rst", "generated/unit_scaling.transforms.simulate_fp8.rst", "generated/unit_scaling.transforms.track_scales.rst", "generated/unit_scaling.transforms.unit_scale.rst", "generated/unit_scaling.transforms.utils.rst", "generated/unit_scaling.transforms.utils.apply_transform.rst", "generated/unit_scaling.transforms.utils.patch_to_expand_modules.rst", "generated/unit_scaling.transforms.utils.replace_node_with_function.rst", "generated/unit_scaling.utils.rst", "generated/unit_scaling.utils.ScalePair.rst", "generated/unit_scaling.utils.ScaleTracker.rst", "generated/unit_scaling.utils.ScaleTrackingInterpreter.rst", "generated/unit_scaling.utils.analyse_module.rst", "generated/unit_scaling.visualiser.rst", "index.rst", "limitations.rst", "posts/almost_scaled_dot_product_attention.md", "user_guide.rst"], "titles": ["<span class=\"section-number\">5. </span>API reference", "<span class=\"section-number\">4. </span>Unit Scaling blog", "<span class=\"section-number\">2. </span>Unit Scaling", "<span class=\"section-number\">5.1. </span>unit_scaling", "<span class=\"section-number\">5.1.5. </span>unit_scaling.CrossEntropyLoss", "<span class=\"section-number\">5.1.6. </span>unit_scaling.Dropout", "<span class=\"section-number\">5.1.7. </span>unit_scaling.Embedding", "<span class=\"section-number\">5.1.2. </span>unit_scaling.GELU", "<span class=\"section-number\">5.1.8. </span>unit_scaling.LayerNorm", "<span class=\"section-number\">5.1.9. </span>unit_scaling.Linear", "<span class=\"section-number\">5.1.3. </span>unit_scaling.MHSA", "<span class=\"section-number\">5.1.4. </span>unit_scaling.MLP", "<span class=\"section-number\">5.1.10. </span>unit_scaling.Softmax", "<span class=\"section-number\">5.1.11. </span>unit_scaling.TransformerDecoder", "<span class=\"section-number\">5.1.12. </span>unit_scaling.TransformerLayer", "<span class=\"section-number\">5.2. </span>unit_scaling.analysis", "<span class=\"section-number\">5.2.1. </span>unit_scaling.analysis.example_batch", "<span class=\"section-number\">5.2.2. </span>unit_scaling.analysis.graph_to_dataframe", "<span class=\"section-number\">5.2.3. </span>unit_scaling.analysis.plot", "<span class=\"section-number\">5.2.4. </span>unit_scaling.analysis.visualiser", "<span class=\"section-number\">5.3. </span>unit_scaling.constraints", "<span class=\"section-number\">5.3.1. </span>unit_scaling.constraints.amean", "<span class=\"section-number\">5.3.2. </span>unit_scaling.constraints.apply_constraint", "<span class=\"section-number\">5.3.3. </span>unit_scaling.constraints.gmean", "<span class=\"section-number\">5.3.4. </span>unit_scaling.constraints.hmean", "<span class=\"section-number\">5.3.5. </span>unit_scaling.constraints.to_grad_input_scale", "<span class=\"section-number\">5.3.6. </span>unit_scaling.constraints.to_left_grad_scale", "<span class=\"section-number\">5.3.7. </span>unit_scaling.constraints.to_output_scale", "<span class=\"section-number\">5.3.8. </span>unit_scaling.constraints.to_right_grad_scale", "<span class=\"section-number\">5.4. </span>unit_scaling.formats", "<span class=\"section-number\">5.4.3. </span>unit_scaling.formats.FPFormat", "<span class=\"section-number\">5.4.1. </span>unit_scaling.formats.format_to_tuple", "<span class=\"section-number\">5.4.2. </span>unit_scaling.formats.tuple_to_format", "<span class=\"section-number\">5.5. </span>unit_scaling.functional", "<span class=\"section-number\">5.5.1. </span>unit_scaling.functional.add", "<span class=\"section-number\">5.5.2. </span>unit_scaling.functional.cross_entropy", "<span class=\"section-number\">5.5.3. </span>unit_scaling.functional.dropout", "<span class=\"section-number\">5.5.4. </span>unit_scaling.functional.embedding", "<span class=\"section-number\">5.5.5. </span>unit_scaling.functional.gelu", "<span class=\"section-number\">5.5.6. </span>unit_scaling.functional.layer_norm", "<span class=\"section-number\">5.5.7. </span>unit_scaling.functional.linear", "<span class=\"section-number\">5.5.8. </span>unit_scaling.functional.matmul", "<span class=\"section-number\">5.5.9. </span>unit_scaling.functional.residual_add", "<span class=\"section-number\">5.5.10. </span>unit_scaling.functional.residual_split", "<span class=\"section-number\">5.5.11. </span>unit_scaling.functional.scale_elementwise", "<span class=\"section-number\">5.5.12. </span>unit_scaling.functional.scaled_dot_product_attention", "<span class=\"section-number\">5.5.13. </span>unit_scaling.functional.softmax", "<span class=\"section-number\">5.6. </span>unit_scaling.scale", "<span class=\"section-number\">5.6.1. </span>unit_scaling.scale.scale_bwd", "<span class=\"section-number\">5.6.2. </span>unit_scaling.scale.scale_fwd", "<span class=\"section-number\">5.7. </span>unit_scaling.transforms", "<span class=\"section-number\">5.7.9. </span>unit_scaling.transforms.Metrics", "<span class=\"section-number\">5.7.1. </span>unit_scaling.transforms.compile", "<span class=\"section-number\">5.7.2. </span>unit_scaling.transforms.prune_non_float_tensors", "<span class=\"section-number\">5.7.3. </span>unit_scaling.transforms.prune_same_scale_tensors", "<span class=\"section-number\">5.7.4. </span>unit_scaling.transforms.prune_selected_nodes", "<span class=\"section-number\">5.7.5. </span>unit_scaling.transforms.simulate_format", "<span class=\"section-number\">5.7.6. </span>unit_scaling.transforms.simulate_fp8", "<span class=\"section-number\">5.7.7. </span>unit_scaling.transforms.track_scales", "<span class=\"section-number\">5.7.8. </span>unit_scaling.transforms.unit_scale", "<span class=\"section-number\">5.8. </span>unit_scaling.transforms.utils", "<span class=\"section-number\">5.8.1. </span>unit_scaling.transforms.utils.apply_transform", "<span class=\"section-number\">5.8.2. </span>unit_scaling.transforms.utils.patch_to_expand_modules", "<span class=\"section-number\">5.8.3. </span>unit_scaling.transforms.utils.replace_node_with_function", "<span class=\"section-number\">5.9. </span>unit_scaling.utils", "<span class=\"section-number\">5.9.2. </span>unit_scaling.utils.ScalePair", "<span class=\"section-number\">5.9.3. </span>unit_scaling.utils.ScaleTracker", "<span class=\"section-number\">5.9.4. </span>unit_scaling.utils.ScaleTrackingInterpreter", "<span class=\"section-number\">5.9.1. </span>unit_scaling.utils.analyse_module", "<span class=\"section-number\">5.1.1. </span>unit_scaling.visualiser", "Unit Scaling", "<span class=\"section-number\">3. </span>Limitations", "Almost-scaled dot-product attention", "<span class=\"section-number\">1. </span>User guide"], "terms": {"unit": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 20, 23, 33, 34, 35, 36, 37, 38, 39, 40, 41, 43, 45, 46, 50, 52, 56, 57, 58, 59, 64, 68, 71, 72], "scale": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 50, 52, 53, 54, 56, 57, 58, 59, 64, 68, 69, 71], "i": [0, 4, 5, 6, 7, 8, 9, 12, 13, 16, 17, 18, 19, 22, 27, 35, 36, 37, 38, 40, 41, 42, 43, 45, 46, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 63, 66, 67, 69, 70, 71, 72], "implement": [0, 2, 5, 10, 11, 12, 13, 14, 19, 45, 52, 59, 61, 68, 69, 70, 73], "us": [0, 2, 4, 5, 6, 7, 8, 9, 10, 13, 14, 16, 17, 19, 20, 22, 24, 30, 36, 37, 41, 42, 43, 45, 46, 50, 51, 52, 54, 56, 57, 58, 59, 61, 62, 66, 67, 68, 69, 70, 71, 72, 73], "thin": 0, "wrapper": [0, 59, 61], "around": [0, 59, 61, 71], "exist": [0, 59, 66, 73], "torch": [0, 3, 4, 5, 6, 7, 8, 9, 12, 17, 18, 19, 33, 34, 35, 37, 41, 45, 46, 50, 52, 56, 57, 58, 59, 61, 62, 66, 68, 69, 71, 73], "nn": [0, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 17, 18, 19, 33, 37, 52, 56, 57, 59, 61, 62, 66, 67, 68, 69, 73], "class": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 29, 30, 35, 37, 46, 50, 51, 59, 64, 65, 66, 67, 68, 73], "function": [0, 3, 5, 7, 9, 10, 11, 12, 13, 14, 15, 17, 18, 20, 22, 29, 47, 50, 52, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 66, 67, 68, 70, 71, 73], "document": [0, 2, 6, 12, 73], "also": [0, 4, 58, 59, 66, 72, 73], "inherit": 0, "from": [0, 5, 6, 8, 9, 12, 16, 18, 19, 36, 37, 52, 53, 54, 56, 57, 58, 59, 61, 66, 67, 68, 69, 73], "standard": [0, 8, 12, 19, 29, 42, 43, 52, 57, 59, 61, 65, 66, 67, 68, 69, 73], "pytorch": [0, 2, 15, 45, 52, 59, 66, 73], "doc": [0, 2, 71], "modif": [0, 66], "note": [0, 2, 4, 6, 13, 35, 37, 41, 45, 52, 58, 59, 61, 66, 73], "some": [0, 2, 4, 35, 40, 41, 45, 59, 70, 72, 73], "mai": [0, 2, 4, 19, 40, 41, 43, 45, 52, 54, 58, 59, 66, 69, 70, 71, 73], "longer": 0, "relev": [0, 8, 18, 19, 69], "ar": [0, 1, 4, 5, 8, 9, 12, 18, 19, 35, 37, 41, 43, 45, 51, 54, 56, 57, 58, 59, 61, 66, 67, 69, 72, 73], "nevertheless": 0, "The": [0, 2, 4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 17, 18, 22, 30, 34, 35, 37, 38, 40, 41, 43, 44, 45, 46, 52, 53, 54, 56, 57, 58, 59, 61, 66, 67, 70, 72, 73], "built": [0, 68], "mirror": 0, "close": 0, "possibl": [0, 37, 73], "can": [0, 2, 4, 5, 6, 18, 43, 45, 52, 54, 58, 59, 62, 66, 67, 70, 71, 72, 73], "easili": 0, "swap": [0, 73], "out": [0, 2, 5, 9, 34, 40, 41, 42, 66, 70, 72, 73], "equival": [0, 4, 6, 8, 45, 56, 57, 59, 68, 73], "For": [0, 2, 6, 8, 19, 41, 42, 43, 45, 58, 66, 69, 70, 72, 73], "code": [0, 19, 68, 69, 73], "which": [0, 4, 8, 11, 12, 19, 43, 46, 53, 54, 55, 56, 57, 58, 59, 61, 62, 63, 66, 67, 69, 72, 73], "follow": [0, 2, 4, 19, 41, 44, 45, 52, 58, 62, 66, 69, 70, 72, 73], "import": [0, 18, 52, 53, 54, 58, 59, 72, 73], "f": [0, 35, 37, 44, 45, 73], "appli": [0, 4, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 22, 34, 35, 36, 38, 39, 40, 41, 42, 43, 44, 45, 46, 48, 49, 52, 53, 54, 59, 61, 62, 66, 72, 73], "first": [0, 2, 6, 41, 44, 52, 61, 66, 67, 73], "ad": [0, 8, 45, 58, 71, 72, 73], "unit_sc": [0, 70, 71, 73], "uu": [0, 73], "u": [0, 9, 59, 68, 73], "replac": [0, 59, 63, 73], "letter": 0, "those": [0, 4, 35, 56, 57, 70, 73], "assum": [0, 25, 26, 27, 28, 45, 72, 73], "thei": [0, 1, 2, 18, 19, 59, 66, 69, 70, 72, 73], "support": [0, 2, 4, 5, 6, 7, 9, 19, 34, 35, 36, 37, 40, 41, 45, 52, 59, 61, 66, 69], "click": 0, "below": [0, 8, 12, 35, 73], "full": [0, 16, 58, 66, 72, 73], "transform": [1, 8, 9, 13, 14, 17, 18, 19, 40, 42, 43, 44, 69, 70, 71, 72, 73], "seem": [1, 72], "all": [1, 6, 9, 17, 18, 19, 37, 45, 46, 53, 54, 55, 59, 66, 69, 72, 73], "you": [1, 4, 40, 41, 45, 66, 67, 71, 72, 73], "need": [1, 4, 43, 52, 58, 66, 68, 72, 73], "we": [1, 2, 19, 54, 57, 59, 61, 66, 67, 69, 70, 71, 72, 73], "don": [1, 18, 19, 53, 54, 69, 72, 73], "t": [1, 6, 18, 19, 32, 37, 40, 52, 53, 54, 59, 61, 62, 66, 69, 71, 72, 73], "fulli": [1, 67, 72], "understand": [1, 72, 73], "why": [1, 45, 72, 73], "work": [1, 2, 19, 42, 43, 52, 60, 68, 69, 70, 71, 73], "so": [1, 12, 45, 46, 52, 58, 59, 61, 66, 67, 72, 73], "well": [1, 4, 42, 43, 71, 72, 73], "while": [1, 66, 72], "notic": [1, 2, 40, 41, 72], "someth": [1, 72, 73], "surpris": [1, 72], "about": [1, 51, 72], "heart": [1, 72], "architectur": [1, 4, 35, 72], "how": [1, 2, 66, 70, 72], "output": [1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 18, 19, 25, 26, 27, 28, 34, 35, 37, 38, 40, 41, 44, 45, 46, 53, 66, 67, 68, 69, 72, 73], "dougla": [1, 72], "orr": [1, 72], "octob": [1, 72], "2023": [1, 2, 70, 72, 73], "A": [2, 4, 5, 6, 10, 11, 12, 13, 14, 35, 37, 41, 45, 46, 51, 52, 70, 72, 73], "librari": [2, 58, 59, 70, 71, 73], "base": [2, 19, 40, 45, 66, 69, 73], "paper": [2, 5, 8, 59, 70, 72, 73], "box": [2, 67, 70, 73], "low": [2, 70, 73], "precis": [2, 9, 41, 45, 70, 73], "train": [2, 4, 5, 6, 8, 36, 37, 43, 45, 70, 71, 72, 73], "found": [2, 70, 72, 73], "http": [2, 14, 70, 73], "graphcor": [2, 70, 72, 73], "research": [2, 70, 73], "github": [2, 70, 73], "io": [2, 45], "current": [2, 13, 19, 45, 52, 59, 61, 67, 69, 70, 71, 73], "its": [2, 41, 44, 49, 51, 52, 63, 66, 70, 73], "beta": [2, 8, 40, 41, 45, 70, 73], "releas": [2, 52, 70, 73], "featur": [2, 5, 40, 41, 70, 71, 73], "have": [2, 4, 6, 17, 18, 37, 40, 41, 43, 53, 54, 56, 57, 58, 59, 66, 70, 71, 72, 73], "yet": [2, 59, 70, 72, 73], "occasion": [2, 70, 73], "bug": [2, 70, 71, 73], "present": [2, 63, 70, 73], "re": [2, 19, 46, 69, 70, 71, 72, 73], "keen": [2, 70, 71, 73], "help": [2, 70, 71, 72, 73], "user": [2, 19, 45, 56, 57, 58, 59, 61, 62, 66, 69, 70], "ani": [2, 5, 7, 9, 12, 18, 19, 27, 40, 45, 55, 58, 59, 61, 62, 63, 66, 67, 68, 69, 70, 71, 73], "problem": [2, 4, 70, 73], "encount": [2, 70, 73], "To": [2, 67, 70, 73], "run": [2, 17, 18, 45, 56, 57, 67, 70, 73], "pip": [2, 70, 73], "git": [2, 70, 73], "com": [2, 70, 73], "demonstr": [2, 13, 70], "an": [2, 4, 5, 6, 8, 9, 11, 12, 16, 17, 18, 19, 27, 36, 37, 41, 43, 44, 45, 53, 54, 55, 56, 58, 59, 65, 66, 67, 69, 72, 73], "overview": [2, 70, 73], "see": [2, 4, 6, 7, 9, 10, 11, 12, 13, 14, 34, 35, 36, 37, 38, 39, 40, 41, 44, 45, 46, 59, 66, 67, 70, 71, 72, 73], "fp8": [2, 57, 70, 73], "notebook": [2, 70, 72, 73], "show": [2, 18, 70, 73], "nanogpt": [2, 70], "model": [2, 15, 18, 19, 43, 53, 54, 56, 57, 58, 59, 64, 69, 70, 72], "more": [2, 6, 37, 45, 46, 58, 66, 71, 72, 73], "depth": [2, 73], "explan": [2, 72], "consult": 2, "our": [2, 59, 61, 66, 70, 71, 72, 73], "And": 2, "practic": [2, 18, 58, 62, 73], "introduct": [2, 73], "guid": [2, 59, 70], "who": [2, 70, 71, 73], "wish": [2, 61, 62, 70, 73], "thi": [2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 22, 30, 34, 36, 37, 38, 40, 41, 43, 44, 45, 46, 52, 53, 54, 56, 57, 58, 59, 61, 62, 66, 67, 69, 70, 71, 72, 73], "codebas": [2, 70, 73], "setup": 2, "requir": [2, 4, 45, 58, 59, 66, 73], "time": [2, 8, 34, 41, 73], "python3": [2, 68], "m": [2, 5, 7, 9, 12, 41, 52, 56, 57, 58, 59, 61], "venv": 2, "sourc": [2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 28, 30, 31, 32, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 48, 49, 51, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 63, 65, 66, 67, 68, 69], "bin": 2, "activ": [2, 8, 11, 13, 14, 56, 72, 73], "r": [2, 6, 37, 66], "dev": 2, "txt": 2, "Or": 2, "ipu": 2, "subsequ": 2, "pre": [2, 67, 73], "flight": 2, "check": [2, 66, 72, 73], "command": 2, "id": [2, 16], "recommend": [2, 19, 23, 42, 43, 69, 70, 73], "python": [2, 68], "intepret": 2, "set": [2, 4, 5, 8, 9, 35, 36, 45, 51, 55, 58, 59, 66, 73], "format": [2, 56, 57, 70, 73], "save": [2, 66], "enabl": [2, 45, 47, 59, 61, 66, 73], "consid": [2, 4, 72, 73], "env": [2, 66], "file": 2, "pythonpath": 2, "exampl": [2, 4, 5, 6, 7, 8, 9, 12, 13, 34, 35, 37, 41, 45, 66, 67, 68, 71, 72, 73], "echo": 2, "pwd": 2, "differ": [2, 9, 19, 37, 41, 43, 45, 47, 52, 61, 69, 72, 73], "path": [2, 16, 19, 69], "devcontain": 2, "cd": 2, "make": [2, 18, 45, 59, 61, 72, 73], "html": 2, "view": [2, 18], "_build": 2, "index": [2, 4, 6, 37, 66], "your": [2, 66, 73], "browser": 2, "copyright": 2, "c": [2, 4, 8, 34, 35, 45, 66], "ltd": 2, "under": [2, 37, 72], "mit": 2, "md": 2, "further": [2, 72, 73], "detail": [2, 6, 7, 9, 10, 11, 12, 13, 14, 34, 35, 36, 37, 38, 39, 40, 41, 44, 46, 59, 66, 67, 71, 73], "version": [3, 19, 33, 41, 44, 52, 58, 59, 61, 62, 69, 73], "common": [3, 20, 33, 34, 71, 73], "modul": [3, 5, 6, 8, 9, 11, 13, 14, 17, 18, 19, 22, 37, 41, 50, 52, 53, 54, 56, 57, 58, 59, 61, 62, 67, 68, 69, 72, 73], "weight": [4, 6, 8, 9, 13, 14, 35, 37, 39, 40, 42, 43, 56, 59, 68, 72, 73], "tensor": [4, 5, 6, 9, 12, 16, 18, 19, 30, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 48, 49, 51, 53, 54, 58, 61, 65, 66, 67, 68, 69, 72, 73], "none": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 18, 22, 34, 35, 37, 38, 39, 40, 41, 44, 45, 46, 63, 65, 66, 67, 68, 73], "size_averag": [4, 35], "ignore_index": [4, 35], "int": [4, 6, 8, 9, 10, 11, 12, 13, 14, 16, 19, 30, 31, 32, 34, 35, 37, 39, 46, 51, 66, 67, 69, 73], "100": [4, 35], "reduc": [4, 35, 56, 57], "reduct": [4, 35], "str": [4, 7, 9, 10, 11, 12, 13, 14, 16, 18, 19, 22, 30, 34, 35, 38, 40, 41, 44, 46, 55, 67, 68, 69], "mean": [4, 5, 7, 8, 9, 12, 18, 21, 23, 24, 35, 40, 52, 73], "label_smooth": [4, 35], "float": [4, 5, 6, 8, 10, 13, 14, 18, 19, 21, 22, 23, 24, 25, 26, 27, 28, 30, 34, 35, 36, 37, 39, 42, 43, 44, 45, 48, 49, 51, 53, 54, 58, 65, 67, 69, 73], "0": [4, 5, 6, 7, 8, 12, 13, 14, 34, 35, 36, 37, 38, 42, 43, 45, 46, 66, 68, 72, 73], "comput": [4, 5, 6, 8, 12, 21, 23, 24, 35, 37, 45, 46, 66, 73], "cross": [4, 35, 73], "entropi": [4, 35, 73], "loss": [4, 18, 19, 35, 53, 54, 58, 69, 73], "between": [4, 18, 35, 43, 73], "input": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 17, 18, 19, 25, 26, 27, 28, 34, 35, 36, 37, 38, 39, 40, 41, 43, 44, 45, 46, 48, 49, 54, 57, 58, 59, 66, 67, 68, 69, 72, 73], "logit": [4, 35], "target": [4, 35, 55, 63, 67, 73], "It": [4, 19, 46, 66, 69, 72, 73], "when": [4, 7, 8, 9, 12, 35, 38, 41, 45, 56, 57, 58, 62, 67, 72, 73], "classif": 4, "If": [4, 5, 6, 8, 9, 35, 36, 37, 40, 41, 45, 46, 56, 57, 66, 67, 72], "provid": [4, 19, 21, 23, 24, 25, 26, 27, 28, 45, 54, 58, 59, 69, 71, 73], "option": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 18, 19, 22, 34, 37, 38, 40, 41, 42, 43, 44, 45, 46, 51, 54, 59, 61, 62, 63, 66, 67, 68, 69], "argument": [4, 7, 38, 41, 66, 67, 73], "should": [4, 12, 35, 42, 43, 44, 45, 56, 57, 58, 59, 61, 66, 67, 68, 73], "1d": 4, "assign": 4, "each": [4, 5, 6, 8, 9, 18, 19, 35, 37, 45, 56, 57, 58, 66, 67, 68, 69, 73], "particularli": [4, 73], "unbalanc": 4, "expect": [4, 8, 37, 56, 57, 73], "contain": [4, 6, 17, 35, 37, 51, 53, 56, 57, 58, 63, 65, 66, 72, 73], "unnorm": [4, 35], "do": [4, 5, 6, 36, 37, 66, 67, 73], "posit": [4, 13, 67], "sum": [4, 12, 35, 46, 72], "1": [4, 5, 6, 7, 8, 9, 12, 34, 35, 37, 38, 41, 42, 43, 45, 46, 54, 66, 68, 70, 73], "gener": [4, 16, 17, 18, 19, 30, 53, 54, 59, 68, 69, 73], "ha": [4, 5, 8, 22, 35, 41, 45, 58, 59, 66, 72, 73], "size": [4, 6, 8, 9, 10, 11, 13, 14, 16, 19, 35, 37, 45, 66, 69], "unbatch": 4, "minibatch": [4, 35], "d_1": [4, 35], "d_2": [4, 35], "d_k": [4, 35], "k": [4, 9, 35, 41, 72], "geq": [4, 35], "dimension": [4, 6, 8, 12, 35, 41], "case": [4, 7, 9, 10, 11, 12, 13, 14, 19, 34, 35, 38, 40, 41, 44, 46, 54, 59, 62, 69, 72, 73], "last": [4, 8, 9, 39, 52], "being": [4, 6, 35, 43, 52, 61, 66, 67], "higher": [4, 45], "dimens": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 39, 40, 41, 46, 66], "per": [4, 8, 35, 66], "pixel": 4, "2d": 4, "imag": [4, 8], "criterion": 4, "either": [4, 35, 66], "indic": [4, 6, 18, 19, 35, 37, 45, 66, 69], "rang": [4, 12, 19, 46, 52, 56, 57, 59, 67, 69, 73], "where": [4, 6, 7, 8, 9, 12, 35, 37, 38, 40, 41, 45, 56, 58, 59, 67, 73], "number": [4, 7, 9, 10, 12, 13, 14, 16, 27, 29, 30, 34, 35, 37, 39, 40, 73], "specifi": [4, 6, 35, 37, 45, 46, 54, 58, 66, 73], "accept": [4, 66], "necessarili": 4, "unreduc": 4, "e": [4, 6, 8, 37, 41, 42, 43, 45, 52, 53, 54, 58, 66], "describ": [4, 5, 35], "ell": 4, "x": [4, 7, 8, 18, 30, 38, 59, 66, 68, 73], "y": [4, 8, 40, 66], "l": [4, 45], "l_1": 4, "dot": [4, 41, 45, 70], "l_n": 4, "top": [4, 59], "quad": 4, "w_": 4, "y_n": 4, "log": [4, 72, 73], "frac": [4, 5, 8, 9, 12, 45, 46], "exp": [4, 12, 46], "x_": [4, 12, 46], "n": [4, 6, 8, 12, 35, 41, 45, 67, 72], "sum_": 4, "cdot": [4, 72], "mathbb": 4, "text": [4, 6, 7, 8, 9, 12, 16, 34, 35, 38, 46], "ignor": [4, 35, 73], "_index": 4, "w": [4, 6, 8, 37, 66], "span": 4, "default": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 18, 19, 34, 35, 36, 37, 38, 40, 41, 42, 43, 44, 45, 46, 54, 59, 61, 62, 63, 66, 68, 69, 73], "begin": [4, 35, 73], "end": [4, 35, 73], "logsoftmax": 4, "nllloss": 4, "probabl": [4, 5, 10, 13, 14, 35, 36, 45], "label": [4, 16, 19, 69], "beyond": [4, 73], "singl": [4, 8, 52, 72], "item": 4, "blend": 4, "smooth": [4, 35], "etc": 4, "w_c": 4, "y_": 4, "perform": [4, 45, 46, 66, 73], "better": [4, 59, 72], "allow": [4, 43, 52, 72, 73], "optim": [4, 45, 52, 61, 62], "onli": [4, 8, 19, 25, 26, 27, 28, 30, 35, 41, 48, 49, 52, 53, 56, 57, 58, 61, 66, 67, 69, 71, 73], "too": [4, 45, 56, 57], "restrict": [4, 41], "paramet": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 28, 34, 35, 36, 37, 40, 41, 42, 43, 44, 45, 46, 48, 49, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 63, 67, 68, 69], "manual": [4, 35, 52, 59, 73], "rescal": [4, 12, 35], "given": [4, 6, 16, 30, 32, 35, 37, 45, 53, 54, 55, 56, 57, 63, 66, 68, 73], "bool": [4, 5, 6, 8, 9, 18, 19, 35, 36, 37, 45, 63, 66, 67, 68, 69], "deprec": [4, 35], "By": [4, 35, 59, 62, 73], "averag": [4, 35], "over": [4, 8, 35, 45, 59, 66, 72, 73], "element": [4, 5, 8, 12, 35, 36, 38, 44, 45, 46, 72], "batch": [4, 6, 8, 16, 19, 35, 37, 41, 69], "multipl": [4, 35, 41, 48, 49, 54, 73], "sampl": [4, 5, 6, 9, 16, 35, 36, 37], "field": [4, 35], "fals": [4, 5, 6, 8, 9, 18, 35, 36, 37, 45, 66, 68], "instead": [4, 35], "true": [4, 5, 6, 8, 9, 18, 19, 35, 36, 37, 45, 56, 57, 63, 66, 67, 68, 69], "valu": [4, 6, 8, 9, 12, 18, 19, 30, 35, 42, 43, 45, 53, 56, 57, 59, 66, 67, 69, 72, 73], "doe": [4, 6, 35, 41, 52, 61, 62, 73], "contribut": [4, 6, 35, 37], "gradient": [4, 6, 7, 9, 10, 11, 12, 13, 14, 25, 26, 27, 28, 34, 35, 37, 38, 40, 41, 43, 44, 46, 51, 56, 59, 66, 72, 73], "non": [4, 6, 29, 30, 35, 37, 41, 43, 54, 66, 73], "applic": [4, 35, 66], "observ": [4, 35], "depend": [4, 18, 35, 41, 45, 59, 67, 72, 73], "return": [4, 12, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 28, 32, 35, 41, 42, 43, 44, 45, 46, 48, 49, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 66, 67, 68, 69, 73], "taken": [4, 73], "process": [4, 6, 35, 53, 59, 67], "meantim": [4, 35], "two": [4, 25, 35, 41, 43, 45, 52, 66, 73], "arg": [4, 19, 35, 44, 63, 66, 67, 69], "overrid": [4, 35, 66], "amount": [4, 35], "becom": [4, 35], "mixtur": [4, 35], "origin": [4, 35, 49, 67, 72], "ground": [4, 35], "truth": [4, 35], "uniform": [4, 35], "distribut": [4, 5, 7, 35, 36, 38, 71, 72, 73], "rethink": [4, 35], "incept": [4, 35], "vision": [4, 35], "shape": [4, 5, 6, 7, 8, 9, 12, 34, 35, 37, 40, 45, 66], "same": [4, 5, 7, 8, 9, 12, 35, 41, 45, 54, 56, 57, 66, 72, 73], "otherwis": [4, 66], "scalar": [4, 8, 41, 48, 49, 65, 73], "align": [4, 35], "randn": [4, 5, 7, 8, 9, 12, 34, 35, 68, 73], "3": [4, 6, 7, 8, 12, 34, 35, 37, 38, 73], "5": [4, 5, 6, 7, 8, 13, 14, 34, 35, 36, 37, 38, 42, 43, 70, 73], "requires_grad": [4, 6, 35, 66], "empti": 4, "dtype": [4, 6, 8, 9, 35, 40, 41, 45, 46, 66, 67], "long": 4, "random_": 4, "backward": [4, 9, 17, 18, 19, 30, 35, 41, 43, 47, 48, 51, 53, 54, 56, 57, 58, 59, 65, 66, 67, 68, 69, 72, 73], "softmax": [4, 10, 13, 14, 35, 45, 70, 72, 73], "dim": [4, 12, 35, 45, 46], "p": [5, 6, 36, 37, 41], "inplac": [5, 36, 66, 68], "bernoulli": [5, 36], "channel": [5, 8], "zero": [5, 6, 8, 36, 37, 45, 59, 66], "independ": [5, 59], "everi": [5, 12, 66, 67], "forward": [5, 17, 18, 19, 30, 47, 48, 49, 51, 52, 56, 57, 58, 59, 61, 62, 65, 66, 67, 68, 69, 72, 73], "call": [5, 17, 18, 19, 45, 52, 53, 54, 56, 57, 58, 59, 61, 62, 63, 66, 67, 68, 69], "proven": 5, "effect": [5, 56, 57, 72, 73], "techniqu": [5, 73], "regular": [5, 59], "prevent": [5, 46, 66], "co": 5, "adapt": [5, 73], "neuron": 5, "improv": [5, 45], "neural": 5, "network": 5, "detector": 5, "_": [5, 45, 66], "furthermor": 5, "factor": [5, 11, 25, 26, 27, 28, 43, 45, 47, 48, 49, 59, 72, 73], "dure": [5, 6, 18, 19, 37, 66, 69, 73], "evalu": [5, 8, 67, 73], "simpli": [5, 73], "ident": [5, 73], "oper": [5, 18, 19, 20, 36, 40, 41, 45, 46, 47, 54, 59, 66, 68, 69, 71, 72, 73], "place": [5, 36, 37, 66, 73], "2": [5, 6, 7, 8, 12, 34, 37, 38, 40, 41, 45, 54, 66, 68, 73], "20": [5, 8, 9, 34], "16": [5, 54, 73], "num_embed": 6, "embedding_dim": [6, 8, 37], "padding_idx": [6, 37], "max_norm": [6, 37], "norm_typ": [6, 37], "scale_grad_by_freq": [6, 37], "spars": [6, 12, 37, 40, 41], "_weight": 6, "_freez": 6, "devic": [6, 8, 9, 40, 41, 45, 67], "lookup": [6, 37], "tabl": [6, 37], "look": [6, 37, 41, 67, 72, 73], "up": [6, 37, 66, 67, 72, 73], "fix": [6, 37, 72, 73], "dictionari": [6, 59], "often": [6, 37, 73], "store": [6, 67], "word": [6, 37], "retriev": [6, 22, 37, 66, 67], "them": [6, 12, 46, 59, 66, 67, 71], "list": [6, 8, 37, 61, 67, 71], "correspond": [6, 19, 22, 32, 37, 59, 66, 69], "vector": [6, 37, 41], "entri": [6, 37], "therefor": [6, 37], "updat": [6, 37, 73], "remain": [6, 37], "pad": [6, 37], "newli": 6, "construct": [6, 37], "anoth": 6, "norm": [6, 37], "larger": [6, 37, 59, 73], "than": [6, 37, 45, 52, 58, 59, 67], "renorm": [6, 37], "invers": [6, 37, 72], "frequenc": [6, 37], "mini": [6, 8, 37], "matrix": [6, 37, 41], "regard": [6, 37, 73], "learnabl": [6, 8, 9], "initi": [6, 8, 9, 37, 73], "mathcal": [6, 9], "type": [6, 9, 13, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 34, 37, 38, 42, 43, 44, 45, 46, 48, 49, 51, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 63, 67, 68, 69], "inttensor": 6, "longtensor": [6, 37], "arbitrari": [6, 17, 18, 19, 37, 59, 65, 69, 73], "extract": [6, 37, 67], "h": [6, 8], "_dim": 6, "10": [6, 8, 34, 37, 68, 73], "4": [6, 11, 34, 37, 66, 68, 73], "9": [6, 37], "xdoctest": [6, 37, 66], "ignore_w": [6, 37], "determinist": [6, 37, 45], "0251": 6, "6902": 6, "7172": 6, "6431": 6, "0748": 6, "6969": 6, "4970": 6, "3448": 6, "9685": 6, "3677": 6, "7265": 6, "1685": 6, "4362": 6, "4004": 6, "9400": 6, "9124": 6, "3616": 6, "1151": 6, "0000": [6, 37], "1535": 6, "0309": 6, "9315": 6, "1655": 6, "9897": 6, "0635": 6, "chang": [6, 18, 45, 52, 54, 72, 73], "7895": 6, "7089": 6, "0364": 6, "6778": 6, "5803": 6, "2678": 6, "no_grad": 6, "ones": [6, 8, 37, 45], "classmethod": 6, "from_pretrain": 6, "freez": 6, "creat": 6, "instanc": [6, 8, 58], "floattensor": 6, "pass": [6, 17, 18, 19, 30, 43, 45, 47, 48, 49, 51, 56, 57, 58, 59, 62, 65, 66, 67, 68, 69, 72, 73], "second": [6, 41, 66], "get": [6, 71, 73], "learn": [6, 8, 9, 72, 73], "pretrain": 6, "6": [6, 34, 68], "1000": 6, "3000": 6, "approxim": [7, 11, 13, 14, 38, 73], "constraint": [7, 9, 10, 11, 12, 13, 14, 34, 38, 40, 41, 44, 46, 67, 70, 73], "gmean": [7, 9, 10, 11, 12, 13, 14, 34, 38, 40, 41, 44, 46, 70, 73], "gaussian": [7, 38], "error": [7, 18, 19, 38, 45, 66, 67, 69], "linear": [7, 38, 56, 57, 68, 70, 73], "phi": [7, 38], "cumul": [7, 38], "tanh": [7, 38], "estim": [7, 8, 38], "sqrt": [7, 8, 9, 38, 45], "pi": [7, 38], "044715": [7, 38], "algorithm": [7, 45], "name": [7, 9, 10, 11, 12, 13, 14, 16, 19, 22, 34, 38, 40, 41, 44, 46, 67, 69], "In": [7, 9, 10, 11, 12, 13, 14, 18, 34, 38, 40, 41, 43, 44, 45, 46, 59, 62, 66, 72, 73], "must": [7, 9, 10, 11, 12, 13, 14, 22, 34, 38, 40, 41, 44, 46, 52, 53, 54, 66, 72, 73], "one": [7, 9, 10, 11, 12, 13, 14, 22, 34, 38, 40, 41, 44, 45, 46, 52, 66, 73], "hmean": [7, 9, 10, 11, 12, 13, 14, 34, 38, 40, 41, 44, 46, 70], "amean": [7, 9, 10, 11, 12, 13, 14, 34, 38, 40, 41, 44, 46, 70], "to_output_scal": [7, 9, 10, 11, 12, 13, 14, 34, 38, 40, 41, 44, 46, 70], "to_grad_input_scal": [7, 9, 11, 12, 38, 40, 44, 46, 70], "normalized_shap": [8, 39], "ep": [8, 39], "1e": [8, 39, 73], "05": [8, 39, 54, 73], "elementwise_affin": 8, "bia": [8, 9, 39, 40, 68, 73], "layer": [8, 9, 10, 11, 13, 14, 39, 42, 43, 52, 59, 73], "normal": [8, 30, 39, 72, 73], "mathrm": [8, 72], "var": 8, "epsilon": 8, "gamma": 8, "deviat": [8, 65, 66, 67, 68, 73], "calcul": 8, "d": [8, 40, 66, 68, 73], "affin": 8, "via": [8, 53, 54, 58, 59, 67, 73], "bias": [8, 59], "unbias": 8, "unlik": [8, 18, 19, 69, 73], "entir": [8, 73], "plane": 8, "statist": 8, "data": [8, 9, 16, 40, 46, 51, 67], "both": [8, 41, 45, 66, 68, 73], "mode": [8, 66], "_shape": 8, "ldot": 8, "integ": [8, 34, 66], "treat": [8, 12], "singleton": 8, "specif": [8, 45, 56, 57, 67], "denomin": 8, "numer": [8, 18, 19, 37, 50, 56, 57, 69, 73], "stabil": 8, "boolean": [8, 45, 66], "addit": [8, 9, 12, 34, 40, 58, 62, 73], "nlp": 8, "sentence_length": 8, "embed": [8, 13, 70], "layer_norm": [8, 70], "three": [8, 26, 28, 45, 72], "spatial": 8, "shown": [8, 18, 73], "in_featur": 9, "out_featur": 9, "incom": [9, 40], "tensorfloat32": [9, 40, 41], "On": [9, 41], "certain": [9, 39, 41, 54, 67], "rocm": [9, 41], "float16": [9, 41, 45], "_featur": [9, 40], "h_": 9, "includ": [9, 40, 71, 72], "30": 9, "128": [9, 45], "print": [9, 68, 73], "hidden_s": [10, 11, 13, 14, 68], "head": [10, 13, 14, 72], "dropout_p": [10, 13, 14, 45], "multi": [10, 13, 14], "self": [10, 13, 14, 42, 43, 67, 68, 70, 73], "attent": [10, 13, 14, 16, 42, 43, 45, 70, 73], "warn": [10, 13, 14, 19, 69], "here": [10, 13, 14, 45, 59, 61, 71, 73], "like": [10, 13, 14, 66, 73], "give": [10, 13, 14, 59, 70, 72, 73], "incorrect": [10, 13, 14, 66], "hidden": [10, 11, 13, 14], "post": [10, 13, 14, 72], "dropout": [10, 13, 14, 45, 70], "act_fn": [11, 13, 14], "gelu": [11, 13, 14, 59, 70, 73], "expansion_factor": 11, "": [11, 25, 26, 27, 28, 40, 41, 45, 58, 66, 67, 68, 72, 73], "intermedi": [11, 58, 67], "increas": [11, 45, 66], "rel": [11, 13, 14, 42, 43, 54, 72], "lie": [12, 46], "multipli": [12, 41, 72, 73], "li": 12, "adjust": 12, "accordingli": 12, "defin": [12, 22, 45, 46, 59, 66, 73], "x_i": [12, 46], "sum_j": [12, 46], "x_j": [12, 46], "unspecifi": 12, "inf": [12, 45], "along": [12, 16, 46, 73], "slice": [12, 46, 54, 67], "vocab_s": 13, "mhsa_tau": [13, 14], "01": [13, 14, 42, 43, 73], "mlp_tau": [13, 14], "decod": 13, "just": [13, 16, 66, 67, 72, 73], "lack": 13, "kei": [13, 45, 51, 58, 59, 70], "causal": [13, 45], "mask": [13, 16, 45], "usag": 13, "infer": 13, "token": [13, 16, 19, 69], "vocabulari": 13, "branch": [13, 14, 42, 43, 73], "skip": [13, 14, 42, 43, 66, 72, 73], "connect": [13, 14, 42, 43, 59, 72, 73], "mlp": [13, 14, 42, 43, 68, 70, 73], "prenorm": 14, "arxiv": 14, "org": 14, "ab": 14, "2002": 14, "04745": 14, "tool": [15, 73], "analys": [15, 68, 73], "other": [15, 34, 41, 45, 58, 71, 73], "metric": [15, 17, 18, 58, 70], "within": [15, 52, 61, 67, 73], "pretrainedtokenizerbas": [16, 19, 69], "batch_siz": [16, 19, 66, 69, 73], "seq_len": [16, 19, 69], "dataset_path": [16, 19, 69], "wikitext": [16, 19, 69], "dataset_nam": [16, 19, 69], "103": [16, 19, 69], "v1": [16, 19, 69], "shuffle_buffer_s": 16, "10000": 16, "seed": 16, "1472": 16, "tupl": [16, 22, 31, 32, 43, 63, 66, 67, 68, 73], "dataset": [16, 19, 69], "shift": 16, "sequenc": [16, 19, 39, 69], "length": [16, 19, 69], "huggingfac": [16, 19, 69], "visualis": [16, 18, 58, 70], "random": [16, 45, 66], "chunk": 16, "determin": [16, 41, 73], "10_000": 16, "shuffl": 16, "input_idx": 16, "attn_mask": [16, 19, 45, 69], "g": [17, 18, 53, 54, 58, 66, 72], "graph": [17, 18, 19, 53, 54, 55, 58, 59, 61, 62, 63, 66, 67, 69], "datafram": 17, "convert": [17, 31, 73], "fx": [17, 18, 52, 53, 54, 55, 58, 61, 62, 67, 68, 73], "annot": [17, 68], "panda": 17, "indend": 17, "been": [17, 18, 22, 53, 54, 59, 66, 73], "track_scal": [17, 18, 19, 53, 54, 69, 70], "possibli": [17, 18], "scales_graph": [17, 18, 19, 53, 54, 58, 69], "result": [17, 18, 42, 43, 58, 67], "inform": [17, 45, 51, 54, 58], "intern": [17, 56, 57, 58], "plot": [17, 19, 58, 69, 70], "pd": 17, "titl": 18, "mean_ab": [18, 51], "prune_same_scal": 18, "show_arrow": 18, "show_error_bar": 18, "show_zero_tensor": 18, "xmin": 18, "xmax": 18, "ax": [18, 19, 69], "matplotlib": [18, 19, 69], "intend": [18, 54, 58, 65, 66], "inpt": [18, 53, 54, 58], "point": [18, 19, 30, 37, 45, 53, 54, 58, 69, 73], "automat": [18, 19, 45, 58, 59, 62, 66, 68, 69, 73], "prune": [18, 19, 53, 54, 55, 69], "deem": [18, 19, 54, 69], "perspect": [18, 19, 69, 73], "faint": [18, 19, 69], "colour": [18, 19, 69], "horizont": [18, 19, 69], "line": [18, 19, 69, 73], "row": [18, 19, 37, 69], "repres": [18, 19, 51, 55, 58, 59, 61, 63, 65, 66, 67, 68, 69, 73], "bar": [18, 19, 69], "maximum": [18, 19, 30, 37, 69], "minimum": [18, 19, 30, 69], "seen": [18, 19, 69, 72, 73], "track": [18, 19, 53, 58, 69], "axi": 18, "abs_mean": [18, 51], "std": [18, 51], "abs_max": [18, 51], "abs_min": [18, 51], "numel": [18, 51], "reshap": [18, 54], "clearer": 18, "arrow": 18, "denot": [18, 73], "max": [18, 73], "min": [18, 73], "displai": 18, "plot_kwarg": [19, 69], "experiment": [19, 56, 57, 59, 69], "conveni": [19, 61, 69], "method": [19, 52, 53, 54, 56, 57, 58, 61, 66, 67, 68, 69, 70, 73], "combin": [19, 40, 41, 42, 52, 69, 73], "example_batch": [19, 69, 70], "wide": [19, 59, 69], "interfac": [19, 59, 61, 69], "futur": [19, 52, 66, 69], "now": [19, 58, 62, 66, 69, 73], "templat": [19, 69], "tracked_model": [19, 69], "keyword": [19, 67, 69], "alias": 20, "arithmet": 21, "group": [21, 22, 23, 24], "constrain": [21, 23, 24, 59, 73], "constraint_nam": 22, "rais": [22, 45, 66], "valueerror": 22, "after": [22, 41, 59, 66], "geometr": [23, 73], "harmon": 24, "xavier": [24, 73], "glorot": [24, 73], "output_scal": [25, 26, 27, 28, 44, 73], "grad_input_scal": [25, 27, 44, 73], "select": [25, 26, 27, 28, 45, 72], "chosen": [25, 26, 27, 28, 45], "op": [25, 26, 27, 28, 52, 56, 57, 66, 67, 71, 73], "equal": [25, 26, 27, 28, 37, 73], "left_grad_scal": [26, 28], "right_grad_scal": [26, 28], "left": [26, 28, 41, 73], "right": [26, 28, 41], "grad": [27, 44, 48, 49, 66, 73], "simul": [29, 56, 57], "exponent_bit": [30, 31, 32], "mantissa_bit": [30, 31, 32], "round": [30, 56, 57], "stochast": [30, 56, 57], "represent": [30, 56, 57], "properti": [30, 72], "bit": 30, "max_absolute_valu": 30, "absolut": 30, "min_absolute_norm": 30, "min_absolute_subnorm": 30, "subnorm": 30, "quantis": [30, 56, 57], "differenti": [30, 66], "quantise_bwd": 30, "quantise_fwd": 30, "fpformat": [31, 32, 56, 70], "alpha": 34, "_i": 34, "broadcast": [34, 41], "promot": 34, "complex": [34, 67], "to_left_grad_scal": [34, 41, 70], "to_right_grad_scal": [34, 41, 70], "0202": 34, "0985": 34, "3506": 34, "6056": 34, "21": 34, "19": 34, "3944": 34, "b": [34, 40, 66], "9732": 34, "3497": 34, "6245": 34, "4022": 34, "3743": 34, "7724": 34, "5811": 34, "8017": 34, "7695": 34, "3930": 34, "3672": 34, "1450": 34, "18": 34, "6971": 34, "0736": 34, "17": 34, "0994": 34, "3216": 34, "7845": 34, "1610": 34, "1868": 34, "4090": 34, "8": [34, 45, 73], "9902": 34, "3667": 34, "7": 34, "3925": 34, "6147": 34, "crossentropyloss": [35, 70, 73], "predict": 35, "section": [35, 70, 73], "divid": 35, "randint": 35, "int64": 35, "dictionaryand": 37, "analyt": 37, "respect": [37, 66], "column": 37, "modifi": [37, 66, 72], "v": [37, 42, 43, 72], "embedding_matrix": 37, "rand": [37, 45], "8490": 37, "9625": 37, "6753": 37, "9666": 37, "7761": 37, "6108": 37, "6246": 37, "9751": 37, "3618": 37, "4161": 37, "2419": 37, "7383": 37, "0237": 37, "7794": 37, "0528": 37, "3385": 37, "8612": 37, "1867": 37, "zero_": 37, "5609": 37, "5384": 37, "8720": 37, "6262": 37, "2438": 37, "7471": 37, "wise": [38, 44], "param": 38, "layernorm": [39, 70], "xa": 40, "layout": [40, 41, 67], "autograd": [40, 41, 66], "miss": [40, 41, 71], "pleas": [40, 41, 45, 66, 73], "open": [40, 41, 72], "request": [40, 41, 71], "product": [41, 45, 70], "behavior": [41, 66], "prepend": 41, "purpos": [41, 56, 57, 73], "remov": [41, 54, 63, 73], "least": 41, "append": [41, 73], "thu": [41, 73], "j": 41, "logic": 41, "valid": [41, 59, 73], "even": [41, 73], "though": [41, 43, 52, 61, 71, 73], "final": [41, 58, 59], "particular": [41, 59, 72, 73], "mm": 41, "residu": [42, 43, 59, 72, 73], "tau": [42, 43, 73], "add": [42, 59, 66, 70, 71, 73], "togeth": [42, 73], "conjunct": [42, 43, 58, 73], "residual_split": [42, 70, 73], "These": [42, 43, 58, 73], "reflect": [42, 43, 68, 73], "empir": [42, 43], "fairli": [42, 43], "insensit": [42, 43], "001": [42, 43], "caus": [42, 43, 73], "signific": [42, 43, 54, 73], "degrad": [42, 43, 73], "come": [42, 52], "split": 43, "prior": [43, 45, 66], "residual_add": [43, 70, 73], "necessari": [43, 53, 66, 73], "delai": [43, 73], "still": [43, 52, 59, 66, 71], "normalis": 43, "benefici": 43, "behav": 43, "order": [43, 45, 67, 73], "callabl": [44, 55, 59, 61, 62, 63, 67, 68, 73], "take": [44, 45, 59, 73], "kwarg": [44, 63, 66, 67], "queri": 45, "is_caus": 45, "usewhatev": 45, "underli": [45, 52], "implementationi": 45, "avail": [45, 58, 73], "flash": 45, "aprob": 45, "greater": 45, "effici": [45, 66, 73], "def": [45, 59, 66, 68, 73], "scale_factor": 45, "math": [45, 68], "els": 45, "attn_bia": 45, "assert": 45, "temp_mask": 45, "tril": 45, "diagon": 45, "masked_fill_": 45, "logical_not": 45, "attn_weight": 45, "transpos": 45, "subject": 45, "There": [45, 66, 73], "flashattent": 45, "fast": 45, "memori": [45, 66, 73], "exact": [45, 73], "awar": 45, "match": 45, "abov": [45, 72, 73], "formul": 45, "kernel": [45, 73], "cuda": 45, "backend": [45, 52, 61, 62], "attempt": [45, 66, 73], "most": [45, 66, 71, 72, 73], "fine": 45, "grain": 45, "control": [45, 73], "what": [45, 53, 66, 70, 72], "disabl": 45, "context": [45, 66], "manag": 45, "prefer": 45, "mechan": [45, 73], "sdp_kernel": 45, "enable_flash_sdp": 45, "enable_mem_efficient_sdp": 45, "enable_math_sdp": 45, "fuse": [45, 73], "limit": [45, 58, 70], "event": 45, "reason": [45, 58, 71, 72], "cannot": 45, "due": 45, "natur": 45, "float64": 45, "numerical_accuraci": 45, "circumst": 45, "cudnn": 45, "nondeterminist": 45, "undesir": 45, "try": [45, 73], "potenti": 45, "cost": 45, "ev": 45, "part": 45, "score": 45, "ensur": [45, 66, 67, 72, 73], "32": 45, "64": [45, 73], "enable_math": 45, "desir": [46, 73], "cast": 46, "befor": [46, 56, 57, 66, 67, 72, 73], "overflow": [46, 73], "unchang": 48, "dynamo": 50, "sake": [50, 58], "fwd_tensor": 51, "fwd": [51, 73], "bwd": [51, 68, 73], "object": [51, 58, 66], "slightli": [52, 54, 72, 73], "doesn": [52, 59, 61, 62, 66], "nest": [52, 59, 61], "unit_scal": [52, 58, 70, 71], "address": [52, 73], "introduc": [52, 72, 73], "compos": 52, "move": [52, 61], "_dynamo": [52, 61, 62], "execut": [52, 61, 67], "new": [52, 56, 57, 58, 61, 62, 63, 70, 71, 73], "optimis": [52, 61, 62, 70], "cach": [52, 61], "thereaft": [52, 61], "written": [52, 66], "successfulli": 52, "rather": 52, "graphmodul": [52, 61, 67], "simulate_fp8": [52, 58, 59, 70, 71], "without": [52, 68, 71, 73], "global": 52, "wai": [52, 59, 66, 73], "node": [53, 54, 55, 58, 63, 67], "suppli": [53, 54, 56, 59, 61, 66, 73], "identifi": [53, 59], "pruned_graph": [53, 54], "rtol": 54, "52587890625e": 54, "previou": [54, 59], "never": 54, "negligibli": 54, "toler": 54, "iter": [55, 61, 62], "onc": [55, 66], "complet": [55, 71], "fwd_format": 56, "bwd_format": 56, "torchdynamo": [56, 57, 59, 61, 62], "matmul": [56, 57, 70], "scaled_dot_product_attent": [56, 57, 70], "insert": [56, 57], "inspect": [56, 57], "correct": [56, 57, 66, 72, 73], "fp32": [56, 57, 73], "speedup": [56, 57, 73], "variou": [56, 58], "As": [57, 73], "literatur": 57, "noun": 57, "et": 57, "al": 57, "2022": 57, "micikeviciu": 57, "e4": [57, 73], "e5": [57, 73], "record": [58, 66, 67], "access": [58, 66], "meta": 58, "associ": 58, "analysi": [58, 59, 68, 69, 70, 73], "requires_grad_": [58, 68, 73], "alwai": [58, 66], "chain": 58, "prune_non_float_tensor": [58, 70], "prune_same_scale_tensor": [58, 70], "tend": [58, 73], "dict": [59, 63, 67], "trace": 59, "procedur": 59, "recurs": [59, 61, 62, 67, 68], "whether": [59, 66], "inner": 59, "build": [59, 73], "fundament": 59, "proce": 59, "five": 59, "stage": 59, "accord": 59, "identif": 59, "done": 59, "special": [59, 71], "compar": 59, "unconstrain": 59, "proof": 59, "henc": 59, "initialis": [59, 72, 73], "abl": [59, 73], "much": [59, 73], "approach": [59, 61, 73], "express": [59, 63, 72], "compil": [59, 61, 62, 70, 71, 73], "own": [59, 61], "system": [59, 61], "easi": [59, 61], "howev": [59, 61, 72, 73], "interoper": [59, 61], "definit": 59, "custom": [59, 66], "basic": [59, 73], "told": 59, "explicitli": [59, 72], "substitut": 59, "new_gelu": 59, "test": [59, 71, 72, 73], "said": 59, "suffici": [59, 73], "anticip": 59, "mani": [59, 66, 72, 73], "ultim": 59, "reli": 59, "alon": 59, "prioriti": 59, "copi": 59, "non_recurse_funct": [61, 62], "graph_modul": 61, "backend_1": 61, "backend_2": 61, "_modul": 61, "fn": 62, "captur": 62, "wrap": [62, 67, 68, 73], "typic": [62, 73], "expand": [62, 66], "patch": 62, "target_fn": 63, "keep_type_expr": 63, "accompani": [63, 72], "retain": [63, 72], "develop": [64, 73], "dataclass": 65, "pair": 65, "scalepair": [66, 70], "static": 66, "ctx": 66, "functionctx": 66, "formula": 66, "alia": 66, "vjp": 66, "overridden": 66, "subclass": 66, "were": 66, "attribut": [66, 67], "needs_input_grad": 66, "is_trac": 66, "autogener": 66, "vmap": 66, "jvp": 66, "extend": 66, "func": 66, "grad_input": 66, "got": 66, "mark_dirti": 66, "mark": 66, "insid": 66, "matter": 66, "torch_doctest_autograd": 66, "staticmethod": 66, "x_npy": 66, "numpi": 66, "share": [66, 73], "storag": 66, "once_differenti": 66, "grad_output": 66, "doubl": 66, "clone": [66, 70, 73], "would": 66, "lead": [66, 73], "wrong": 66, "engin": 66, "know": [66, 72], "unless": 66, "runtimeerror": 66, "variabl": 66, "mark_non_differenti": 66, "go": [66, 72, 73], "sort": 66, "idx": 66, "save_for_backward": 66, "g1": 66, "g2": 66, "saved_tensor": 66, "zeros_lik": 66, "index_add_": 66, "oppos": 66, "directli": [66, 71, 73], "leak": 66, "hook": 66, "saved_tensors_hook": 66, "intermediari": 66, "neither": 66, "nor": 66, "decor": 66, "recomput": 66, "tutori": [66, 73], "through": [66, 67, 71, 72, 73], "made": 66, "weren": 66, "content": 66, "z": [66, 72], "grad_out": 66, "gx": 66, "gy": 66, "gz": 66, "save_for_forward": 66, "x_t": 66, "y_t": 66, "fwad": 66, "dual_level": 66, "a_dual": 66, "make_du": 66, "set_materialize_grad": 66, "materi": 66, "undefin": 66, "simplefunc": 66, "No": 66, "handl": [66, 67], "induc": 66, "setup_context": 66, "signatur": 66, "happen": [66, 72], "info": 66, "in_dim": 66, "rule": [66, 72], "underneath": 66, "generate_vmap_rul": 66, "choos": 66, "out_dim": 66, "similar": [66, 73], "structur": [66, 67], "instrument": 67, "boxed_run": 67, "args_list": 67, "interpret": 67, "convent": 67, "clear": 67, "promptli": 67, "dealloc": 67, "compat": 67, "api": [67, 70, 73], "guarante": [67, 71], "call_funct": 67, "semant": 67, "invoc": 67, "call_method": 67, "memory_format": 67, "opoverload": 67, "call_modul": 67, "fetch_args_kwargs_from_env": 67, "fetch": 67, "concret": 67, "environ": 67, "fetch_attr": 67, "hierarchi": 67, "qualifi": 67, "get_attr": 67, "Will": 67, "wa": 67, "map_nodes_to_valu": 67, "descend": 67, "belong": 67, "report": 67, "realli": 67, "referenc": 67, "placehold": 67, "tracer": 67, "target_to_funct": 67, "initial_env": 67, "enable_io_process": 67, "start": [67, 73], "map": 67, "popul": 67, "partial": 67, "process_input": 67, "process_output": 67, "run_nod": 67, "recurse_modul": 68, "syntax_highlight": 68, "autowrap_modul": 68, "einop": 68, "home": 68, "runner": 68, "local": 68, "lib": 68, "site": 68, "packag": 68, "__init__": [68, 73], "py": 68, "autowrap_funct": 68, "dummi": 68, "union": 68, "fed": [68, 73], "plain": 68, "toggl": 68, "behavour": 68, "moduletyp": 68, "whose": 68, "string": 68, "super": [68, 73], "fc1": 68, "relu": 68, "fc2": 68, "236": 68, "fc1_weight": 68, "018": [68, 73], "54": 68, "fc1_bia": 68, "0182": 68, "51": 68, "_c": [68, 73], "_nn": [68, 73], "578": [68, 73], "204": [68, 73], "337": 68, "288": 68, "fc2_weight": 68, "00902": [68, 73], "13": 68, "fc2_bia": 68, "00904": 68, "31": 68, "linear_1": [68, 73], "235": 68, "999": [68, 73], "welcom": 70, "design": [70, 72, 73], "facilit": 70, "outlin": [70, 73], "icml": [70, 73], "refer": [70, 73], "video": 70, "broad": 70, "fork": [70, 73], "repo": [70, 73], "instruct": [70, 73], "consider": 70, "licens": 70, "blog": 70, "almost": 70, "mhsa": 70, "transformerdecod": 70, "transformerlay": 70, "graph_to_datafram": 70, "apply_constraint": 70, "format_to_tupl": 70, "tuple_to_format": 70, "cross_entropi": [70, 73], "scale_elementwis": 70, "scale_bwd": 70, "scale_fwd": 70, "prune_selected_nod": 70, "simulate_format": 70, "util": [70, 73], "apply_transform": 70, "patch_to_expand_modul": 70, "replace_node_with_funct": 70, "analyse_modul": [70, 73], "scaletrack": 70, "scaletrackinginterpret": 70, "despit": 71, "best": [71, 73], "effort": 71, "free": 71, "assist": 71, "anyon": 71, "want": 71, "issu": [71, 73], "known": 71, "coverag": 71, "ve": [71, 72], "focuss": 71, "difficulti": 71, "although": [71, 73], "suspect": 71, "haven": 71, "exhaust": 71, "encourag": 71, "touch": 71, "tl": 72, "dr": 72, "isn": 72, "properli": 72, "good": [72, 73], "thing": 72, "deep": [72, 73], "roughli": [72, 73], "preserv": [72, 73], "varianc": 72, "behaviour": [72, 73], "satur": 72, "nonlinear": 72, "stabl": 72, "prime": 72, "q": 72, "color": 72, "green": 72, "But": 72, "insuffici": 72, "whole": 72, "deriv": [72, 73], "red": 72, "illustr": 72, "ll": 72, "explain": 72, "dynam": [72, 73], "wors": 72, "condens": 72, "summari": 72, "think": 72, "sim": 72, "infti": 72, "flat": 72, "uncorrel": 72, "spike": 72, "gt": 72, "assumpt": [72, 73], "companion": 72, "find": [72, 73], "temperatur": 72, "propos": 72, "small": [72, 73], "autoregress": 72, "charact": 72, "languag": 72, "shakespear": 72, "saw": 72, "rate": 72, "sweep": 72, "unfortun": 72, "block": [72, 73], "tini": 72, "shakespar": 72, "bert": 72, "intrigu": 72, "presum": 72, "accid": 72, "turn": 72, "solut": 72, "bad": 72, "reproduc": 72, "inde": 72, "care": [72, 73], "core": 72, "principl": 72, "underpin": 72, "far": [72, 73], "question": 72, "interest": 72, "With": 72, "thank": 72, "charli": 72, "blake": 72, "feedback": 72, "douglaso": 72, "ai": 72, "read": 73, "cover": 73, "brief": 73, "discuss": 73, "paradigm": 73, "aim": 73, "involv": 73, "term": 73, "usual": 73, "scratch": 73, "advantag": 73, "great": 73, "headroom": 73, "grow": 73, "shrink": 73, "underflow": 73, "occur": 73, "becaus": 73, "drift": 73, "stai": 73, "smaller": 73, "fp16": 73, "experi": 73, "decreas": 73, "faster": 73, "treatment": 73, "motiv": 73, "keep": 73, "sens": 73, "might": 73, "bf16": 73, "veri": 73, "larg": 73, "3e": 73, "38": 73, "45": 73, "60": 73, "000": 73, "6e": 73, "put": 73, "speed": 73, "scope": 73, "next": 73, "step": 73, "tricki": 73, "easier": 73, "breakdown": 73, "alongsid": 73, "unscaledmlp": 73, "linear_2": 73, "annotated_cod": 73, "linear_1_weight": 73, "83": 73, "linear_1_bia": 73, "84": 73, "177": 73, "322": 73, "289": 73, "linear_2_weight": 73, "48": 73, "linear_2_bia": 73, "00894": 73, "198": 73, "firstli": 73, "decompos": 73, "level": 73, "secondli": 73, "fwd_scale": 73, "bwd_scale": 73, "sign": 73, "receiv": 73, "enough": 73, "unscal": 73, "could": 73, "drop": 73, "scaledmlp": 73, "716": 73, "729": 73, "707": 73, "706": 73, "693": 73, "03": 73, "979": 73, "repeat": 73, "until": 73, "measur": 73, "art": 73, "aris": 73, "clearli": 73, "explod": 73, "clip": 73, "convers": 73, "steadili": 73, "exactli": 73, "meet": 73, "concern": 73, "significantli": 73, "merit": 73, "investig": 73, "attain": 73, "divis": 73, "substanti": 73, "push": 73, "themselv": 73, "solv": 73, "outsid": 73, "separ": 73, "altern": 73, "form": 73, "residuallay": 73, "contrast": 73, "ratio": 73, "50": 73, "hyperparamet": 73, "leav": 73, "tune": 73, "fact": 73, "down": 73, "emploi": 73, "trick": 73, "comprehens": 73, "scenario": 73, "produc": 73, "arriv": 73, "fan_in": 73, "fan_out": 73, "grad_weight_scal": 73, "grad_bias_scal": 73, "ideal": 73, "compromis": 73, "extra": 73, "eager": 73, "trip": 73, "fortun": 73, "hi": 73, "overhead": 73, "elimin": 73, "fusion": 73, "stack": 73, "answer": 73, "old": 73, "jit": 73, "script": 73, "torchscript": 73, "program": 73, "rectifi": 73, "flexibl": 73, "theori": 73, "unit_scaled_funct": 73, "unitscaledmodul": 73, "incur": 73, "naiv": 73, "benchmark": 73, "thorough": 73, "strongli": 73, "latest": 73, "fail": 73, "recent": 73, "upgrad": 73, "preview": 73, "nightli": 73}, "objects": {"": [[3, 0, 0, "-", "unit_scaling"]], "unit_scaling": [[4, 1, 1, "", "CrossEntropyLoss"], [5, 1, 1, "", "Dropout"], [6, 1, 1, "", "Embedding"], [7, 1, 1, "", "GELU"], [8, 1, 1, "", "LayerNorm"], [9, 1, 1, "", "Linear"], [10, 1, 1, "", "MHSA"], [11, 1, 1, "", "MLP"], [12, 1, 1, "", "Softmax"], [13, 1, 1, "", "TransformerDecoder"], [14, 1, 1, "", "TransformerLayer"], [15, 0, 0, "-", "analysis"], [20, 0, 0, "-", "constraints"], [29, 0, 0, "-", "formats"], [33, 0, 0, "-", "functional"], [47, 0, 0, "-", "scale"], [50, 0, 0, "-", "transforms"], [64, 0, 0, "-", "utils"], [69, 4, 1, "", "visualiser"]], "unit_scaling.Embedding": [[6, 2, 1, "", "from_pretrained"], [6, 3, 1, "", "weight"]], "unit_scaling.LayerNorm": [[8, 3, 1, "", "bias"], [8, 3, 1, "", "weight"]], "unit_scaling.Linear": [[9, 3, 1, "", "bias"], [9, 3, 1, "", "weight"]], "unit_scaling.analysis": [[16, 4, 1, "", "example_batch"], [17, 4, 1, "", "graph_to_dataframe"], [18, 4, 1, "", "plot"], [19, 4, 1, "", "visualiser"]], "unit_scaling.constraints": [[21, 4, 1, "", "amean"], [22, 4, 1, "", "apply_constraint"], [23, 4, 1, "", "gmean"], [24, 4, 1, "", "hmean"], [25, 4, 1, "", "to_grad_input_scale"], [26, 4, 1, "", "to_left_grad_scale"], [27, 4, 1, "", "to_output_scale"], [28, 4, 1, "", "to_right_grad_scale"]], "unit_scaling.formats": [[30, 1, 1, "", "FPFormat"], [31, 4, 1, "", "format_to_tuple"], [32, 4, 1, "", "tuple_to_format"]], "unit_scaling.formats.FPFormat": [[30, 5, 1, "", "bits"], [30, 5, 1, "", "max_absolute_value"], [30, 5, 1, "", "min_absolute_normal"], [30, 5, 1, "", "min_absolute_subnormal"], [30, 2, 1, "", "quantise"], [30, 2, 1, "", "quantise_bwd"], [30, 2, 1, "", "quantise_fwd"]], "unit_scaling.functional": [[34, 4, 1, "", "add"], [35, 4, 1, "", "cross_entropy"], [36, 4, 1, "", "dropout"], [37, 4, 1, "", "embedding"], [38, 4, 1, "", "gelu"], [39, 4, 1, "", "layer_norm"], [40, 4, 1, "", "linear"], [41, 4, 1, "", "matmul"], [42, 4, 1, "", "residual_add"], [43, 4, 1, "", "residual_split"], [44, 4, 1, "", "scale_elementwise"], [45, 4, 1, "", "scaled_dot_product_attention"], [46, 4, 1, "", "softmax"]], "unit_scaling.scale": [[48, 4, 1, "", "scale_bwd"], [49, 4, 1, "", "scale_fwd"]], "unit_scaling.transforms": [[51, 1, 1, "", "Metrics"], [52, 4, 1, "", "compile"], [53, 4, 1, "", "prune_non_float_tensors"], [54, 4, 1, "", "prune_same_scale_tensors"], [55, 4, 1, "", "prune_selected_nodes"], [56, 4, 1, "", "simulate_format"], [57, 4, 1, "", "simulate_fp8"], [58, 4, 1, "", "track_scales"], [59, 4, 1, "", "unit_scale"], [60, 0, 0, "-", "utils"]], "unit_scaling.transforms.Metrics": [[51, 1, 1, "", "Data"]], "unit_scaling.transforms.utils": [[61, 4, 1, "", "apply_transform"], [62, 4, 1, "", "patch_to_expand_modules"], [63, 4, 1, "", "replace_node_with_function"]], "unit_scaling.utils": [[65, 1, 1, "", "ScalePair"], [66, 1, 1, "", "ScaleTracker"], [67, 1, 1, "", "ScaleTrackingInterpreter"], [68, 4, 1, "", "analyse_module"]], "unit_scaling.utils.ScaleTracker": [[66, 2, 1, "", "backward"], [66, 3, 1, "", "is_traceable"], [66, 2, 1, "", "jvp"], [66, 2, 1, "", "mark_dirty"], [66, 2, 1, "", "mark_non_differentiable"], [66, 2, 1, "", "save_for_backward"], [66, 2, 1, "", "save_for_forward"], [66, 2, 1, "", "set_materialize_grads"], [66, 2, 1, "", "setup_context"], [66, 2, 1, "", "vjp"], [66, 2, 1, "", "vmap"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[67, 2, 1, "", "boxed_run"], [67, 2, 1, "", "call_function"], [67, 2, 1, "", "call_method"], [67, 2, 1, "", "call_module"], [67, 2, 1, "", "fetch_args_kwargs_from_env"], [67, 2, 1, "", "fetch_attr"], [67, 2, 1, "", "get_attr"], [67, 2, 1, "", "map_nodes_to_values"], [67, 2, 1, "", "output"], [67, 2, 1, "", "placeholder"], [67, 2, 1, "", "run"], [67, 2, 1, "", "run_node"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:function", "5": "py:property"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "function", "Python function"], "5": ["py", "property", "Python property"]}, "titleterms": {"api": 0, "refer": 0, "unit": [1, 2, 70, 73], "scale": [1, 2, 47, 48, 49, 70, 72, 73], "blog": 1, "almost": [1, 72], "dot": [1, 72], "product": [1, 72], "self": 1, "attent": [1, 72], "instal": [2, 70, 73], "what": [2, 73], "i": [2, 73], "develop": [2, 70], "licens": 2, "unit_sc": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "crossentropyloss": 4, "dropout": [5, 36], "embed": [6, 37], "gelu": [7, 38], "layernorm": 8, "linear": [9, 40], "mhsa": 10, "mlp": 11, "softmax": [12, 46], "transformerdecod": 13, "transformerlay": 14, "analysi": [15, 16, 17, 18, 19], "example_batch": 16, "graph_to_datafram": 17, "plot": 18, "visualis": [19, 69], "constraint": [20, 21, 22, 23, 24, 25, 26, 27, 28], "amean": 21, "apply_constraint": 22, "gmean": 23, "hmean": 24, "to_grad_input_scal": 25, "to_left_grad_scal": 26, "to_output_scal": 27, "to_right_grad_scal": 28, "format": [29, 30, 31, 32], "fpformat": 30, "format_to_tupl": 31, "tuple_to_format": 32, "function": [33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46], "add": 34, "cross_entropi": 35, "layer_norm": 39, "matmul": 41, "residual_add": 42, "residual_split": 43, "scale_elementwis": 44, "scaled_dot_product_attent": 45, "scale_bwd": 48, "scale_fwd": 49, "transform": [50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63], "metric": 51, "compil": 52, "prune_non_float_tensor": 53, "prune_same_scale_tensor": 54, "prune_selected_nod": 55, "simulate_format": 56, "simulate_fp8": 57, "track_scal": 58, "unit_scal": 59, "util": [60, 61, 62, 63, 64, 65, 66, 67, 68], "apply_transform": 61, "patch_to_expand_modul": 62, "replace_node_with_funct": 63, "scalepair": 65, "scaletrack": 66, "scaletrackinginterpret": 67, "analyse_modul": 68, "get": 70, "start": 70, "content": 70, "limit": 71, "where": 72, "doe": 72, "d_": 72, "seq": 72, "e": 72, "1": 72, "2": 72, "come": 72, "from": 72, "work": 72, "No": 72, "conclus": 72, "user": 73, "guid": 73, "how": 73, "model": 73, "kei": 73, "consider": 73, "optimis": 73}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"API reference": [[0, "api-reference"]], "Unit Scaling blog": [[1, "unit-scaling-blog"]], "Almost scaled dot-product self attention": [[1, "almost-scaled-dot-product-self-attention"]], "Unit Scaling": [[2, "unit-scaling"], [70, "unit-scaling"]], "Installation": [[2, "installation"], [70, "installation"], [73, "installation"]], "What is unit scaling?": [[2, "what-is-unit-scaling"], [73, "what-is-unit-scaling"]], "Development": [[2, "development"], [70, "development"]], "License": [[2, "license"]], "unit_scaling": [[3, "module-unit_scaling"]], "unit_scaling.CrossEntropyLoss": [[4, "unit-scaling-crossentropyloss"]], "unit_scaling.Dropout": [[5, "unit-scaling-dropout"]], "unit_scaling.Embedding": [[6, "unit-scaling-embedding"]], "unit_scaling.GELU": [[7, "unit-scaling-gelu"]], "unit_scaling.LayerNorm": [[8, "unit-scaling-layernorm"]], "unit_scaling.Linear": [[9, "unit-scaling-linear"]], "unit_scaling.MHSA": [[10, "unit-scaling-mhsa"]], "unit_scaling.MLP": [[11, "unit-scaling-mlp"]], "unit_scaling.Softmax": [[12, "unit-scaling-softmax"]], "unit_scaling.TransformerDecoder": [[13, "unit-scaling-transformerdecoder"]], "unit_scaling.TransformerLayer": [[14, "unit-scaling-transformerlayer"]], "unit_scaling.analysis": [[15, "module-unit_scaling.analysis"]], "unit_scaling.analysis.example_batch": [[16, "unit-scaling-analysis-example-batch"]], "unit_scaling.analysis.graph_to_dataframe": [[17, "unit-scaling-analysis-graph-to-dataframe"]], "unit_scaling.analysis.plot": [[18, "unit-scaling-analysis-plot"]], "unit_scaling.analysis.visualiser": [[19, "unit-scaling-analysis-visualiser"]], "unit_scaling.constraints": [[20, "module-unit_scaling.constraints"]], "unit_scaling.constraints.amean": [[21, "unit-scaling-constraints-amean"]], "unit_scaling.constraints.apply_constraint": [[22, "unit-scaling-constraints-apply-constraint"]], "unit_scaling.constraints.gmean": [[23, "unit-scaling-constraints-gmean"]], "unit_scaling.constraints.hmean": [[24, "unit-scaling-constraints-hmean"]], "unit_scaling.constraints.to_grad_input_scale": [[25, "unit-scaling-constraints-to-grad-input-scale"]], "unit_scaling.constraints.to_left_grad_scale": [[26, "unit-scaling-constraints-to-left-grad-scale"]], "unit_scaling.constraints.to_output_scale": [[27, "unit-scaling-constraints-to-output-scale"]], "unit_scaling.constraints.to_right_grad_scale": [[28, "unit-scaling-constraints-to-right-grad-scale"]], "unit_scaling.formats": [[29, "module-unit_scaling.formats"]], "unit_scaling.formats.FPFormat": [[30, "unit-scaling-formats-fpformat"]], "unit_scaling.formats.format_to_tuple": [[31, "unit-scaling-formats-format-to-tuple"]], "unit_scaling.formats.tuple_to_format": [[32, "unit-scaling-formats-tuple-to-format"]], "unit_scaling.functional": [[33, "module-unit_scaling.functional"]], "unit_scaling.functional.add": [[34, "unit-scaling-functional-add"]], "unit_scaling.functional.cross_entropy": [[35, "unit-scaling-functional-cross-entropy"]], "unit_scaling.functional.dropout": [[36, "unit-scaling-functional-dropout"]], "unit_scaling.functional.embedding": [[37, "unit-scaling-functional-embedding"]], "unit_scaling.functional.gelu": [[38, "unit-scaling-functional-gelu"]], "unit_scaling.functional.layer_norm": [[39, "unit-scaling-functional-layer-norm"]], "unit_scaling.functional.linear": [[40, "unit-scaling-functional-linear"]], "unit_scaling.functional.matmul": [[41, "unit-scaling-functional-matmul"]], "unit_scaling.functional.residual_add": [[42, "unit-scaling-functional-residual-add"]], "unit_scaling.functional.residual_split": [[43, "unit-scaling-functional-residual-split"]], "unit_scaling.functional.scale_elementwise": [[44, "unit-scaling-functional-scale-elementwise"]], "unit_scaling.functional.scaled_dot_product_attention": [[45, "unit-scaling-functional-scaled-dot-product-attention"]], "unit_scaling.functional.softmax": [[46, "unit-scaling-functional-softmax"]], "unit_scaling.scale": [[47, "module-unit_scaling.scale"]], "unit_scaling.scale.scale_bwd": [[48, "unit-scaling-scale-scale-bwd"]], "unit_scaling.scale.scale_fwd": [[49, "unit-scaling-scale-scale-fwd"]], "unit_scaling.transforms": [[50, "module-unit_scaling.transforms"]], "unit_scaling.transforms.Metrics": [[51, "unit-scaling-transforms-metrics"]], "unit_scaling.transforms.compile": [[52, "unit-scaling-transforms-compile"]], "unit_scaling.transforms.prune_non_float_tensors": [[53, "unit-scaling-transforms-prune-non-float-tensors"]], "unit_scaling.transforms.prune_same_scale_tensors": [[54, "unit-scaling-transforms-prune-same-scale-tensors"]], "unit_scaling.transforms.prune_selected_nodes": [[55, "unit-scaling-transforms-prune-selected-nodes"]], "unit_scaling.transforms.simulate_format": [[56, "unit-scaling-transforms-simulate-format"]], "unit_scaling.transforms.simulate_fp8": [[57, "unit-scaling-transforms-simulate-fp8"]], "unit_scaling.transforms.track_scales": [[58, "unit-scaling-transforms-track-scales"]], "unit_scaling.transforms.unit_scale": [[59, "unit-scaling-transforms-unit-scale"]], "unit_scaling.transforms.utils": [[60, "module-unit_scaling.transforms.utils"]], "unit_scaling.transforms.utils.apply_transform": [[61, "unit-scaling-transforms-utils-apply-transform"]], "unit_scaling.transforms.utils.patch_to_expand_modules": [[62, "unit-scaling-transforms-utils-patch-to-expand-modules"]], "unit_scaling.transforms.utils.replace_node_with_function": [[63, "unit-scaling-transforms-utils-replace-node-with-function"]], "unit_scaling.utils": [[64, "module-unit_scaling.utils"]], "unit_scaling.utils.ScalePair": [[65, "unit-scaling-utils-scalepair"]], "unit_scaling.utils.ScaleTracker": [[66, "unit-scaling-utils-scaletracker"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[67, "unit-scaling-utils-scaletrackinginterpreter"]], "unit_scaling.utils.analyse_module": [[68, "unit-scaling-utils-analyse-module"]], "unit_scaling.visualiser": [[69, "unit-scaling-visualiser"]], "Getting Started": [[70, "getting-started"]], "Contents": [[70, null]], "Limitations": [[71, "limitations"]], "Almost-scaled dot-product attention": [[72, "almost-scaled-dot-product-attention"]], "Where does (d_{seq}/e)^{1/2} come from?": [[72, "where-does-d-seq-e-1-2-come-from"]], "Does it work? \u2026No!": [[72, "does-it-work-no"]], "Conclusion": [[72, "conclusion"]], "User guide": [[73, "user-guide"]], "How to unit-scale a model": [[73, "how-to-unit-scale-a-model"]], "Key considerations for unit scaling": [[73, "key-considerations-for-unit-scaling"]], "Optimising unit-scaled models": [[73, "optimising-unit-scaled-models"]]}, "indexentries": {"module": [[3, "module-unit_scaling"], [15, "module-unit_scaling.analysis"], [20, "module-unit_scaling.constraints"], [29, "module-unit_scaling.formats"], [33, "module-unit_scaling.functional"], [47, "module-unit_scaling.scale"], [50, "module-unit_scaling.transforms"], [60, "module-unit_scaling.transforms.utils"], [64, "module-unit_scaling.utils"]], "unit_scaling": [[3, "module-unit_scaling"]], "crossentropyloss (class in unit_scaling)": [[4, "unit_scaling.CrossEntropyLoss"]], "dropout (class in unit_scaling)": [[5, "unit_scaling.Dropout"]], "embedding (class in unit_scaling)": [[6, "unit_scaling.Embedding"]], "from_pretrained() (unit_scaling.embedding class method)": [[6, "unit_scaling.Embedding.from_pretrained"]], "weight (unit_scaling.embedding attribute)": [[6, "unit_scaling.Embedding.weight"]], "gelu (class in unit_scaling)": [[7, "unit_scaling.GELU"]], "layernorm (class in unit_scaling)": [[8, "unit_scaling.LayerNorm"]], "bias (unit_scaling.layernorm attribute)": [[8, "unit_scaling.LayerNorm.bias"]], "weight (unit_scaling.layernorm attribute)": [[8, "unit_scaling.LayerNorm.weight"]], "linear (class in unit_scaling)": [[9, "unit_scaling.Linear"]], "bias (unit_scaling.linear attribute)": [[9, "unit_scaling.Linear.bias"]], "weight (unit_scaling.linear attribute)": [[9, "unit_scaling.Linear.weight"]], "mhsa (class in unit_scaling)": [[10, "unit_scaling.MHSA"]], "mlp (class in unit_scaling)": [[11, "unit_scaling.MLP"]], "softmax (class in unit_scaling)": [[12, "unit_scaling.Softmax"]], "transformerdecoder (class in unit_scaling)": [[13, "unit_scaling.TransformerDecoder"]], "transformerlayer (class in unit_scaling)": [[14, "unit_scaling.TransformerLayer"]], "unit_scaling.analysis": [[15, "module-unit_scaling.analysis"]], "example_batch() (in module unit_scaling.analysis)": [[16, "unit_scaling.analysis.example_batch"]], "graph_to_dataframe() (in module unit_scaling.analysis)": [[17, "unit_scaling.analysis.graph_to_dataframe"]], "plot() (in module unit_scaling.analysis)": [[18, "unit_scaling.analysis.plot"]], "visualiser() (in module unit_scaling.analysis)": [[19, "unit_scaling.analysis.visualiser"]], "unit_scaling.constraints": [[20, "module-unit_scaling.constraints"]], "amean() (in module unit_scaling.constraints)": [[21, "unit_scaling.constraints.amean"]], "apply_constraint() (in module unit_scaling.constraints)": [[22, "unit_scaling.constraints.apply_constraint"]], "gmean() (in module unit_scaling.constraints)": [[23, "unit_scaling.constraints.gmean"]], "hmean() (in module unit_scaling.constraints)": [[24, "unit_scaling.constraints.hmean"]], "to_grad_input_scale() (in module unit_scaling.constraints)": [[25, "unit_scaling.constraints.to_grad_input_scale"]], "to_left_grad_scale() (in module unit_scaling.constraints)": [[26, "unit_scaling.constraints.to_left_grad_scale"]], "to_output_scale() (in module unit_scaling.constraints)": [[27, "unit_scaling.constraints.to_output_scale"]], "to_right_grad_scale() (in module unit_scaling.constraints)": [[28, "unit_scaling.constraints.to_right_grad_scale"]], "unit_scaling.formats": [[29, "module-unit_scaling.formats"]], "fpformat (class in unit_scaling.formats)": [[30, "unit_scaling.formats.FPFormat"]], "bits (unit_scaling.formats.fpformat property)": [[30, "unit_scaling.formats.FPFormat.bits"]], "max_absolute_value (unit_scaling.formats.fpformat property)": [[30, "unit_scaling.formats.FPFormat.max_absolute_value"]], "min_absolute_normal (unit_scaling.formats.fpformat property)": [[30, "unit_scaling.formats.FPFormat.min_absolute_normal"]], "min_absolute_subnormal (unit_scaling.formats.fpformat property)": [[30, "unit_scaling.formats.FPFormat.min_absolute_subnormal"]], "quantise() (unit_scaling.formats.fpformat method)": [[30, "unit_scaling.formats.FPFormat.quantise"]], "quantise_bwd() (unit_scaling.formats.fpformat method)": [[30, "unit_scaling.formats.FPFormat.quantise_bwd"]], "quantise_fwd() (unit_scaling.formats.fpformat method)": [[30, "unit_scaling.formats.FPFormat.quantise_fwd"]], "format_to_tuple() (in module unit_scaling.formats)": [[31, "unit_scaling.formats.format_to_tuple"]], "tuple_to_format() (in module unit_scaling.formats)": [[32, "unit_scaling.formats.tuple_to_format"]], "unit_scaling.functional": [[33, "module-unit_scaling.functional"]], "add() (in module unit_scaling.functional)": [[34, "unit_scaling.functional.add"]], "cross_entropy() (in module unit_scaling.functional)": [[35, "unit_scaling.functional.cross_entropy"]], "dropout() (in module unit_scaling.functional)": [[36, "unit_scaling.functional.dropout"]], "embedding() (in module unit_scaling.functional)": [[37, "unit_scaling.functional.embedding"]], "gelu() (in module unit_scaling.functional)": [[38, "unit_scaling.functional.gelu"]], "layer_norm() (in module unit_scaling.functional)": [[39, "unit_scaling.functional.layer_norm"]], "linear() (in module unit_scaling.functional)": [[40, "unit_scaling.functional.linear"]], "matmul() (in module unit_scaling.functional)": [[41, "unit_scaling.functional.matmul"]], "residual_add() (in module unit_scaling.functional)": [[42, "unit_scaling.functional.residual_add"]], "residual_split() (in module unit_scaling.functional)": [[43, "unit_scaling.functional.residual_split"]], "scale_elementwise() (in module unit_scaling.functional)": [[44, "unit_scaling.functional.scale_elementwise"]], "scaled_dot_product_attention() (in module unit_scaling.functional)": [[45, "unit_scaling.functional.scaled_dot_product_attention"]], "softmax() (in module unit_scaling.functional)": [[46, "unit_scaling.functional.softmax"]], "unit_scaling.scale": [[47, "module-unit_scaling.scale"]], "scale_bwd() (in module unit_scaling.scale)": [[48, "unit_scaling.scale.scale_bwd"]], "scale_fwd() (in module unit_scaling.scale)": [[49, "unit_scaling.scale.scale_fwd"]], "unit_scaling.transforms": [[50, "module-unit_scaling.transforms"]], "metrics (class in unit_scaling.transforms)": [[51, "unit_scaling.transforms.Metrics"]], "metrics.data (class in unit_scaling.transforms)": [[51, "unit_scaling.transforms.Metrics.Data"]], "compile() (in module unit_scaling.transforms)": [[52, "unit_scaling.transforms.compile"]], "prune_non_float_tensors() (in module unit_scaling.transforms)": [[53, "unit_scaling.transforms.prune_non_float_tensors"]], "prune_same_scale_tensors() (in module unit_scaling.transforms)": [[54, "unit_scaling.transforms.prune_same_scale_tensors"]], "prune_selected_nodes() (in module unit_scaling.transforms)": [[55, "unit_scaling.transforms.prune_selected_nodes"]], "simulate_format() (in module unit_scaling.transforms)": [[56, "unit_scaling.transforms.simulate_format"]], "simulate_fp8() (in module unit_scaling.transforms)": [[57, "unit_scaling.transforms.simulate_fp8"]], "track_scales() (in module unit_scaling.transforms)": [[58, "unit_scaling.transforms.track_scales"]], "unit_scale() (in module unit_scaling.transforms)": [[59, "unit_scaling.transforms.unit_scale"]], "unit_scaling.transforms.utils": [[60, "module-unit_scaling.transforms.utils"]], "apply_transform() (in module unit_scaling.transforms.utils)": [[61, "unit_scaling.transforms.utils.apply_transform"]], "patch_to_expand_modules() (in module unit_scaling.transforms.utils)": [[62, "unit_scaling.transforms.utils.patch_to_expand_modules"]], "replace_node_with_function() (in module unit_scaling.transforms.utils)": [[63, "unit_scaling.transforms.utils.replace_node_with_function"]], "unit_scaling.utils": [[64, "module-unit_scaling.utils"]], "scalepair (class in unit_scaling.utils)": [[65, "unit_scaling.utils.ScalePair"]], "scaletracker (class in unit_scaling.utils)": [[66, "unit_scaling.utils.ScaleTracker"]], "backward() (unit_scaling.utils.scaletracker static method)": [[66, "unit_scaling.utils.ScaleTracker.backward"]], "is_traceable (unit_scaling.utils.scaletracker attribute)": [[66, "unit_scaling.utils.ScaleTracker.is_traceable"]], "jvp() (unit_scaling.utils.scaletracker static method)": [[66, "unit_scaling.utils.ScaleTracker.jvp"]], "mark_dirty() (unit_scaling.utils.scaletracker method)": [[66, "unit_scaling.utils.ScaleTracker.mark_dirty"]], "mark_non_differentiable() (unit_scaling.utils.scaletracker method)": [[66, "unit_scaling.utils.ScaleTracker.mark_non_differentiable"]], "save_for_backward() (unit_scaling.utils.scaletracker method)": [[66, "unit_scaling.utils.ScaleTracker.save_for_backward"]], "save_for_forward() (unit_scaling.utils.scaletracker method)": [[66, "unit_scaling.utils.ScaleTracker.save_for_forward"]], "set_materialize_grads() (unit_scaling.utils.scaletracker method)": [[66, "unit_scaling.utils.ScaleTracker.set_materialize_grads"]], "setup_context() (unit_scaling.utils.scaletracker static method)": [[66, "unit_scaling.utils.ScaleTracker.setup_context"]], "vjp() (unit_scaling.utils.scaletracker static method)": [[66, "unit_scaling.utils.ScaleTracker.vjp"]], "vmap() (unit_scaling.utils.scaletracker static method)": [[66, "unit_scaling.utils.ScaleTracker.vmap"]], "scaletrackinginterpreter (class in unit_scaling.utils)": [[67, "unit_scaling.utils.ScaleTrackingInterpreter"]], "boxed_run() (unit_scaling.utils.scaletrackinginterpreter method)": [[67, "unit_scaling.utils.ScaleTrackingInterpreter.boxed_run"]], "call_function() (unit_scaling.utils.scaletrackinginterpreter method)": [[67, "unit_scaling.utils.ScaleTrackingInterpreter.call_function"]], "call_method() (unit_scaling.utils.scaletrackinginterpreter method)": [[67, "unit_scaling.utils.ScaleTrackingInterpreter.call_method"]], "call_module() (unit_scaling.utils.scaletrackinginterpreter method)": [[67, "unit_scaling.utils.ScaleTrackingInterpreter.call_module"]], "fetch_args_kwargs_from_env() (unit_scaling.utils.scaletrackinginterpreter method)": [[67, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_args_kwargs_from_env"]], "fetch_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[67, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_attr"]], "get_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[67, "unit_scaling.utils.ScaleTrackingInterpreter.get_attr"]], "map_nodes_to_values() (unit_scaling.utils.scaletrackinginterpreter method)": [[67, "unit_scaling.utils.ScaleTrackingInterpreter.map_nodes_to_values"]], "output() (unit_scaling.utils.scaletrackinginterpreter method)": [[67, "unit_scaling.utils.ScaleTrackingInterpreter.output"]], "placeholder() (unit_scaling.utils.scaletrackinginterpreter method)": [[67, "unit_scaling.utils.ScaleTrackingInterpreter.placeholder"]], "run() (unit_scaling.utils.scaletrackinginterpreter method)": [[67, "unit_scaling.utils.ScaleTrackingInterpreter.run"]], "run_node() (unit_scaling.utils.scaletrackinginterpreter method)": [[67, "unit_scaling.utils.ScaleTrackingInterpreter.run_node"]], "analyse_module() (in module unit_scaling.utils)": [[68, "unit_scaling.utils.analyse_module"]], "visualiser() (in module unit_scaling)": [[69, "unit_scaling.visualiser"]]}})