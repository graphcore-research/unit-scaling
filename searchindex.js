Search.setIndex({"docnames": ["api_reference", "development", "generated/unit_scaling", "generated/unit_scaling.CrossEntropyLoss", "generated/unit_scaling.Dropout", "generated/unit_scaling.Embedding", "generated/unit_scaling.GELU", "generated/unit_scaling.LayerNorm", "generated/unit_scaling.Linear", "generated/unit_scaling.MHSA", "generated/unit_scaling.MLP", "generated/unit_scaling.Softmax", "generated/unit_scaling.TransformerDecoder", "generated/unit_scaling.TransformerLayer", "generated/unit_scaling.constraints", "generated/unit_scaling.constraints.amean", "generated/unit_scaling.constraints.gmean", "generated/unit_scaling.constraints.hmean", "generated/unit_scaling.constraints.to_grad_input_scale", "generated/unit_scaling.constraints.to_left_grad_scale", "generated/unit_scaling.constraints.to_output_scale", "generated/unit_scaling.constraints.to_right_grad_scale", "generated/unit_scaling.functional", "generated/unit_scaling.functional.cross_entropy", "generated/unit_scaling.functional.dropout", "generated/unit_scaling.functional.embedding", "generated/unit_scaling.functional.gelu", "generated/unit_scaling.functional.layer_norm", "generated/unit_scaling.functional.linear", "generated/unit_scaling.functional.matmul", "generated/unit_scaling.functional.residual_add", "generated/unit_scaling.functional.residual_split", "generated/unit_scaling.functional.scale_elementwise", "generated/unit_scaling.functional.softmax", "generated/unit_scaling.scale", "generated/unit_scaling.scale.scale_bwd", "generated/unit_scaling.scale.scale_fwd", "generated/unit_scaling.utils", "generated/unit_scaling.utils.ScalePair", "generated/unit_scaling.utils.ScaleTracker", "generated/unit_scaling.utils.ScaleTrackingInterpreter", "generated/unit_scaling.utils.analyse_module", "index", "limitations", "user_guide"], "filenames": ["api_reference.rst", "development.rst", "generated/unit_scaling.rst", "generated/unit_scaling.CrossEntropyLoss.rst", "generated/unit_scaling.Dropout.rst", "generated/unit_scaling.Embedding.rst", "generated/unit_scaling.GELU.rst", "generated/unit_scaling.LayerNorm.rst", "generated/unit_scaling.Linear.rst", "generated/unit_scaling.MHSA.rst", "generated/unit_scaling.MLP.rst", "generated/unit_scaling.Softmax.rst", "generated/unit_scaling.TransformerDecoder.rst", "generated/unit_scaling.TransformerLayer.rst", "generated/unit_scaling.constraints.rst", "generated/unit_scaling.constraints.amean.rst", "generated/unit_scaling.constraints.gmean.rst", "generated/unit_scaling.constraints.hmean.rst", "generated/unit_scaling.constraints.to_grad_input_scale.rst", "generated/unit_scaling.constraints.to_left_grad_scale.rst", "generated/unit_scaling.constraints.to_output_scale.rst", "generated/unit_scaling.constraints.to_right_grad_scale.rst", "generated/unit_scaling.functional.rst", "generated/unit_scaling.functional.cross_entropy.rst", "generated/unit_scaling.functional.dropout.rst", "generated/unit_scaling.functional.embedding.rst", "generated/unit_scaling.functional.gelu.rst", "generated/unit_scaling.functional.layer_norm.rst", "generated/unit_scaling.functional.linear.rst", "generated/unit_scaling.functional.matmul.rst", "generated/unit_scaling.functional.residual_add.rst", "generated/unit_scaling.functional.residual_split.rst", "generated/unit_scaling.functional.scale_elementwise.rst", "generated/unit_scaling.functional.softmax.rst", "generated/unit_scaling.scale.rst", "generated/unit_scaling.scale.scale_bwd.rst", "generated/unit_scaling.scale.scale_fwd.rst", "generated/unit_scaling.utils.rst", "generated/unit_scaling.utils.ScalePair.rst", "generated/unit_scaling.utils.ScaleTracker.rst", "generated/unit_scaling.utils.ScaleTrackingInterpreter.rst", "generated/unit_scaling.utils.analyse_module.rst", "index.rst", "limitations.rst", "user_guide.rst"], "titles": ["API Reference", "Unit Scaling", "unit_scaling", "unit_scaling.CrossEntropyLoss", "unit_scaling.Dropout", "unit_scaling.Embedding", "unit_scaling.GELU", "unit_scaling.LayerNorm", "unit_scaling.Linear", "unit_scaling.MHSA", "unit_scaling.MLP", "unit_scaling.Softmax", "unit_scaling.TransformerDecoder", "unit_scaling.TransformerLayer", "unit_scaling.constraints", "unit_scaling.constraints.amean", "unit_scaling.constraints.gmean", "unit_scaling.constraints.hmean", "unit_scaling.constraints.to_grad_input_scale", "unit_scaling.constraints.to_left_grad_scale", "unit_scaling.constraints.to_output_scale", "unit_scaling.constraints.to_right_grad_scale", "unit_scaling.functional", "unit_scaling.functional.cross_entropy", "unit_scaling.functional.dropout", "unit_scaling.functional.embedding", "unit_scaling.functional.gelu", "unit_scaling.functional.layer_norm", "unit_scaling.functional.linear", "unit_scaling.functional.matmul", "unit_scaling.functional.residual_add", "unit_scaling.functional.residual_split", "unit_scaling.functional.scale_elementwise", "unit_scaling.functional.softmax", "unit_scaling.scale", "unit_scaling.scale.scale_bwd", "unit_scaling.scale.scale_fwd", "unit_scaling.utils", "unit_scaling.utils.ScalePair", "unit_scaling.utils.ScaleTracker", "unit_scaling.utils.ScaleTrackingInterpreter", "unit_scaling.utils.analyse_module", "Unit Scaling", "Limitations", "User Guide"], "terms": {"unit": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 22, 23, 24, 25, 26, 27, 28, 29, 31, 33, 37, 41, 43], "scale": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 31, 32, 33, 37, 41, 43], "i": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 20, 23, 24, 25, 26, 28, 29, 31, 32, 33, 39, 40, 42, 43], "implement": [0, 4, 9, 10, 11, 12, 13, 41, 43, 44], "us": [0, 1, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 17, 24, 25, 29, 30, 31, 33, 39, 40, 41, 42, 44], "thin": 0, "wrapper": 0, "around": 0, "exist": [0, 44], "torch": [0, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 22, 23, 25, 26, 28, 29, 32, 33, 39, 41, 44], "nn": [0, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 22, 25, 39, 40, 41, 44], "class": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 23, 33, 37, 38, 39, 40, 41, 44], "function": [0, 2, 4, 6, 8, 9, 10, 11, 12, 13, 14, 34, 37, 39, 40, 41, 42, 43, 44], "document": [0, 5], "also": [0, 3, 39, 44], "inherit": 0, "from": [0, 4, 5, 7, 8, 11, 24, 39, 40, 41, 44], "standard": [0, 7, 11, 31, 38, 39, 40, 41, 44], "pytorch": [0, 1, 44], "doc": [0, 1, 11], "modif": [0, 39], "note": [0, 1, 3, 5, 12, 23, 25, 29, 39, 44], "some": [0, 3, 23, 28, 29, 43, 44], "mai": [0, 3, 28, 29, 39, 44], "longer": 0, "relev": 0, "ar": [0, 3, 4, 7, 8, 11, 23, 29, 31, 39, 43, 44], "nevertheless": 0, "The": [0, 3, 5, 7, 8, 11, 23, 25, 29, 31, 39, 40, 43, 44], "built": [0, 41], "mirror": 0, "close": 0, "possibl": [0, 25, 44], "can": [0, 3, 4, 5, 39, 40, 44], "easili": 0, "swap": [0, 44], "out": [0, 1, 4, 8, 28, 29, 30, 39, 42, 44], "equival": [0, 3, 5, 7, 41, 44], "For": [0, 1, 5, 7, 29, 42, 44], "code": [0, 41, 44], "which": [0, 3, 7, 9, 10, 11, 12, 13, 29, 31, 33, 40, 44], "follow": [0, 1, 29, 32, 39, 43, 44], "import": [0, 43, 44], "f": [0, 23, 25, 32, 44], "appli": [0, 3, 6, 7, 8, 9, 10, 11, 12, 13, 23, 24, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 39, 44], "first": [0, 1, 5, 29, 32, 39, 40, 44], "ad": [0, 7, 44], "unit_sc": [0, 42, 44], "uu": [0, 44], "u": [0, 8, 41, 44], "replac": [0, 2, 44], "letter": 0, "those": [0, 3, 23, 43, 44], "assum": [0, 18, 19, 20, 21, 44], "thei": [0, 39, 43, 44], "support": [0, 1, 3, 4, 5, 8, 23, 24, 25, 28, 29, 39, 43], "click": 0, "below": [0, 7, 11, 23, 44], "full": [0, 39, 44], "A": [1, 2, 3, 4, 5, 9, 10, 11, 12, 13, 23, 25, 29, 33, 44], "librari": [1, 42, 43, 44], "base": [1, 28, 39, 44], "paper": [1, 4, 7, 42, 44], "box": [1, 42, 44], "low": [1, 42, 44], "precis": [1, 8, 29, 42, 44], "train": [1, 3, 4, 5, 7, 24, 25, 42, 43, 44], "user": [1, 39, 42, 43], "who": [1, 44], "wish": [1, 44], "thi": [1, 3, 4, 5, 7, 8, 12, 24, 25, 28, 29, 31, 33, 39, 40, 42, 43, 44], "codebas": [1, 44], "setup": 1, "requir": [1, 3, 39, 43, 44], "time": [1, 7, 29], "python3": [1, 41], "m": [1, 4, 6, 8, 11, 29], "venv": 1, "add": [1, 30], "bin": 1, "activ": [1, 7, 10, 12, 13, 44], "sourc": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 38, 39, 40, 41], "path_to_poplar_sdk": 1, "enabl": [1, 34, 39, 44], "If": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 23, 24, 25, 26, 28, 29, 32, 33, 39, 40], "run": [1, 40, 44], "ipu": 1, "pip": [1, 44], "instal": [1, 42], "wheel": 1, "poplar_sdk_en": 1, "poptorch": 1, "whl": 1, "r": [1, 5, 25, 39], "dev": 1, "txt": 1, "subsequ": 1, "pre": [1, 40, 44], "flight": 1, "check": [1, 39, 44], "help": [1, 44], "see": [1, 3, 5, 13, 23, 24, 25, 26, 27, 33, 39, 40, 42, 44], "command": 1, "id": 1, "recommend": [1, 16, 42, 44], "python": [1, 41], "intepret": 1, "set": [1, 3, 4, 7, 8, 23, 24, 39, 43, 44], "format": [1, 44], "save": [1, 39], "consid": [1, 3, 44], "env": 1, "file": 1, "pythonpath": 1, "e": [1, 3, 5, 7, 11, 12, 25, 29, 39, 40, 44], "g": [1, 11, 12, 39, 40], "echo": 1, "pwd": 1, "differ": [1, 8, 29, 34, 44], "path": 1, "devcontain": 1, "cd": 1, "make": [1, 44], "html": 1, "view": 1, "_build": 1, "index": [1, 3, 5, 25], "your": [1, 39, 44], "browser": 1, "copyright": 1, "c": [1, 3, 7, 23, 39], "2023": [1, 42, 44], "graphcor": [1, 44], "ltd": 1, "under": [1, 25], "mit": 1, "notic": [1, 28, 29], "md": 1, "further": [1, 44], "detail": [1, 5, 23, 24, 25, 27, 33, 39, 40, 44], "version": [2, 22, 29, 32, 44], "variou": 2, "modul": [2, 4, 5, 7, 8, 10, 12, 13, 25, 29, 40, 41, 44], "weight": [3, 5, 7, 8, 12, 13, 23, 25, 27, 28, 30, 31, 41, 44], "option": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 23, 25, 26, 27, 28, 29, 30, 31, 32, 33, 38, 40, 41], "tensor": [3, 4, 5, 8, 11, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 38, 39, 40, 41, 44], "none": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 23, 25, 26, 27, 28, 29, 32, 33, 38, 39, 40, 41, 44], "size_averag": [3, 23], "ignore_index": [3, 23], "int": [3, 5, 7, 8, 9, 10, 11, 12, 13, 23, 25, 27, 33, 39, 40, 44], "100": [3, 23], "reduc": [3, 23], "reduct": [3, 23], "str": [3, 6, 23, 40, 41], "mean": [3, 4, 6, 7, 8, 11, 15, 16, 17, 23, 28, 43, 44], "label_smooth": [3, 23], "float": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 38, 40, 44], "0": [3, 4, 5, 6, 7, 11, 12, 13, 23, 24, 25, 26, 30, 31, 33, 39, 41, 44], "comput": [3, 4, 5, 7, 11, 15, 16, 17, 23, 25, 33, 39, 44], "cross": [3, 23, 44], "entropi": [3, 23, 44], "loss": [3, 23, 44], "between": [3, 23, 31, 43, 44], "input": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 18, 19, 20, 21, 23, 24, 25, 26, 27, 28, 29, 31, 32, 33, 35, 36, 39, 40, 41, 44], "logit": [3, 23], "target": [3, 23, 40, 44], "It": [3, 33, 39, 44], "when": [3, 6, 7, 8, 11, 23, 26, 29, 40, 44], "classif": 3, "problem": [3, 43, 44], "provid": [3, 6, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 26, 28, 32, 33, 44], "argument": [3, 6, 26, 29, 39, 40, 44], "should": [3, 11, 23, 30, 31, 32, 39, 40, 41, 44], "1d": 3, "assign": 3, "each": [3, 4, 5, 7, 8, 23, 25, 39, 40, 41, 44], "particularli": [3, 44], "you": [3, 28, 29, 39], "have": [3, 5, 25, 28, 29, 39, 43, 44], "an": [3, 4, 5, 7, 8, 10, 11, 20, 24, 25, 29, 31, 32, 38, 39, 40, 44], "unbalanc": 3, "expect": [3, 7, 44], "contain": [3, 5, 23, 25, 38, 44], "unnorm": [3, 23], "do": [3, 4, 5, 24, 25, 39, 40], "need": [3, 31, 39, 41, 44], "posit": [3, 12, 40, 43], "sum": [3, 11, 23, 33], "1": [3, 4, 5, 6, 7, 8, 11, 23, 25, 26, 29, 33, 39, 41, 44], "gener": [3, 41, 43, 44], "ha": [3, 4, 7, 23, 29, 39, 43, 44], "size": [3, 5, 7, 8, 9, 10, 12, 13, 23, 25], "unbatch": 3, "minibatch": [3, 23], "d_1": [3, 23], "d_2": [3, 23], "d_k": [3, 23], "k": [3, 8, 23, 29], "geq": [3, 23], "dimension": [3, 5, 7, 11, 23, 29], "case": [3, 23, 44], "last": [3, 7, 8, 27], "being": [3, 5, 23, 31, 40], "higher": 3, "dimens": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 27, 28, 29, 33], "per": [3, 7, 23], "pixel": 3, "2d": 3, "imag": [3, 7], "criterion": 3, "either": [3, 23, 29, 39], "indic": [3, 5, 23, 25, 39], "rang": [3, 11, 33, 44], "where": [3, 5, 6, 7, 8, 11, 23, 25, 26, 28, 29, 44], "number": [3, 6, 8, 9, 11, 12, 13, 20, 23, 25, 27, 28, 44], "specifi": [3, 5, 23, 25, 33, 44], "accept": [3, 39], "necessarili": 3, "unreduc": 3, "describ": [3, 4, 23], "ell": 3, "x": [3, 6, 7, 26, 39, 41, 44], "y": [3, 7, 28, 39], "l": 3, "l_1": 3, "dot": [3, 29], "l_n": 3, "top": 3, "quad": 3, "w_": 3, "y_n": 3, "log": [3, 44], "frac": [3, 4, 7, 8, 11, 33], "exp": [3, 11, 33], "x_": [3, 11, 33], "n": [3, 5, 7, 11, 23, 29, 40], "sum_": 3, "cdot": 3, "mathbb": 3, "text": [3, 5, 6, 7, 8, 11, 23, 26, 33], "ignor": [3, 23, 44], "_index": 3, "w": [3, 5, 7, 25, 39], "span": 3, "well": [3, 44], "default": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 23, 24, 25, 26, 28, 29, 30, 31, 32, 33, 39, 41, 44], "begin": [3, 23, 44], "end": [3, 23, 44], "combin": [3, 28, 29, 30, 44], "logsoftmax": 3, "nllloss": 3, "probabl": [3, 4, 9, 12, 13, 23, 24], "label": 3, "beyond": [3, 44], "singl": [3, 6, 7, 8, 9, 10, 11, 12, 13, 26, 28, 29, 32, 33], "item": 3, "blend": 3, "smooth": [3, 23], "etc": 3, "w_c": 3, "y_": 3, "perform": [3, 33, 39], "better": 3, "allow": [3, 44], "optim": 3, "onli": [3, 18, 19, 20, 21, 23, 29, 35, 36, 39, 40, 44], "too": 3, "restrict": [3, 29], "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 28, 29, 30, 31, 32, 33, 35, 36, 40, 41], "manual": [3, 23], "rescal": [3, 11, 23], "given": [3, 5, 23, 25, 39, 41, 44], "bool": [3, 4, 5, 7, 8, 23, 24, 25, 39, 40, 41], "deprec": [3, 23], "By": [3, 23, 44], "averag": [3, 23], "over": [3, 7, 23, 44], "element": [3, 4, 7, 11, 23, 24, 26, 32, 33], "batch": [3, 5, 7, 23, 25, 29], "multipl": [3, 23, 29, 35, 36], "sampl": [3, 4, 5, 8, 23, 24, 25], "field": [3, 23], "fals": [3, 4, 5, 7, 8, 23, 24, 25, 39, 41], "instead": [3, 23], "true": [3, 4, 5, 7, 8, 23, 24, 25, 39, 40, 41], "valu": [3, 5, 7, 8, 11, 23, 39, 40, 44], "doe": [3, 5, 23, 29, 44], "contribut": [3, 5, 23, 25], "gradient": [3, 5, 6, 8, 9, 10, 11, 12, 13, 18, 19, 20, 21, 23, 25, 26, 28, 29, 31, 32, 33, 39, 44], "non": [3, 5, 23, 25, 29, 39, 43, 44], "applic": [3, 23, 39], "observ": [3, 23], "depend": [3, 23, 29, 40, 44], "return": [3, 6, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 23, 26, 28, 29, 30, 31, 32, 33, 35, 36, 39, 40, 41, 44], "output": [3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 18, 19, 20, 21, 23, 25, 28, 29, 32, 39, 40, 41, 44], "taken": [3, 44], "process": [3, 5, 23, 40], "meantim": [3, 23], "two": [3, 18, 23, 29, 31, 44], "arg": [3, 23, 32, 39, 40], "overrid": [3, 23], "amount": [3, 23], "becom": [3, 23], "mixtur": [3, 23], "origin": [3, 23, 36, 40], "ground": [3, 23], "truth": [3, 23], "uniform": [3, 23], "distribut": [3, 4, 6, 23, 24, 26, 43, 44], "rethink": [3, 23], "incept": [3, 23], "architectur": [3, 23], "vision": [3, 23], "shape": [3, 4, 5, 6, 7, 8, 11, 23, 25, 28, 39], "same": [3, 4, 6, 7, 8, 11, 23, 29, 39, 44], "otherwis": 3, "scalar": [3, 7, 29, 35, 36, 38, 44], "align": [3, 23], "exampl": [3, 4, 5, 6, 7, 8, 11, 23, 25, 29, 39, 40, 41, 44], "randn": [3, 4, 6, 7, 8, 11, 23, 41, 44], "3": [3, 5, 6, 7, 11, 23, 25, 26, 44], "5": [3, 4, 5, 6, 7, 23, 24, 25, 26, 44], "requires_grad": [3, 5, 23, 39], "empti": 3, "dtype": [3, 5, 7, 8, 23, 28, 29, 33, 39, 40], "long": 3, "random_": 3, "backward": [3, 8, 23, 29, 31, 34, 35, 38, 39, 40, 41, 44], "softmax": [3, 9, 12, 13, 23, 42, 44], "dim": [3, 11, 23, 33], "p": [4, 5, 24, 25, 29], "inplac": [4, 24, 39, 41], "bernoulli": [4, 24], "channel": [4, 7], "zero": [4, 5, 7, 24, 39], "independ": 4, "everi": [4, 11, 39, 40], "forward": [4, 34, 35, 36, 38, 39, 40, 41, 44], "call": [4, 39, 40, 41], "proven": 4, "effect": [4, 44], "techniqu": [4, 42, 44], "regular": 4, "prevent": [4, 33, 39], "co": 4, "adapt": [4, 44], "neuron": 4, "improv": 4, "neural": 4, "network": [4, 31], "featur": [4, 28, 29, 43, 44], "detector": 4, "_": [4, 39], "furthermor": 4, "factor": [4, 10, 18, 19, 20, 21, 34, 35, 36, 43, 44], "dure": [4, 5, 25, 39, 44], "evalu": [4, 7, 40], "simpli": [4, 44], "ident": [4, 44], "oper": [4, 14, 24, 28, 29, 33, 34, 39, 41, 43, 44], "place": [4, 24, 25, 39, 44], "ani": [4, 6, 8, 9, 11, 12, 13, 20, 28, 39, 40, 41, 44], "2": [4, 5, 6, 7, 11, 12, 13, 25, 26, 28, 29, 30, 31, 39, 41, 44], "20": [4, 7, 8], "16": [4, 44], "num_embed": 5, "embedding_dim": [5, 7, 25], "padding_idx": [5, 25], "max_norm": [5, 25], "norm_typ": [5, 25], "scale_grad_by_freq": [5, 25], "spars": [5, 11, 25, 28, 29], "_weight": 5, "devic": [5, 7, 8, 28, 29, 40], "lookup": [5, 25], "tabl": [5, 25], "look": [5, 25, 29, 40, 44], "up": [5, 25, 40, 44], "fix": [5, 25], "dictionari": 5, "often": [5, 25, 29, 44], "store": [5, 40], "word": [5, 25], "retriev": [5, 25, 39, 40], "them": [5, 11, 33, 39, 40], "list": [5, 7, 25, 40, 43], "correspond": [5, 25, 39], "vector": [5, 25, 29], "entri": [5, 25], "therefor": [5, 25], "updat": [5, 25, 44], "remain": [5, 25], "pad": [5, 25], "newli": 5, "construct": 5, "all": [5, 8, 29, 33, 39, 44], "anoth": 5, "norm": [5, 25], "larger": [5, 25, 44], "than": [5, 25, 40, 43], "renorm": [5, 25], "invers": [5, 25], "frequenc": [5, 25], "mini": [5, 7, 25], "t": [5, 25, 28, 39, 44], "matrix": [5, 25, 29], "more": [5, 25, 33, 39, 43, 44], "regard": [5, 25, 44], "learnabl": [5, 7, 8], "initi": [5, 7, 8, 44], "mathcal": [5, 8], "type": [5, 6, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 25, 26, 28, 29, 30, 31, 32, 33, 35, 36, 40, 41], "inttensor": 5, "longtensor": [5, 25], "arbitrari": [5, 25, 38, 43, 44], "extract": [5, 25, 40], "h": [5, 7], "_dim": 5, "10": [5, 7, 25, 41, 44], "4": [5, 10, 25, 39, 41, 44], "9": [5, 25], "xdoctest": [5, 25, 39], "ignore_w": [5, 25], "determinist": [5, 25], "0251": 5, "6902": 5, "7172": 5, "6431": 5, "0748": 5, "6969": 5, "4970": 5, "3448": 5, "9685": 5, "3677": 5, "7265": 5, "1685": 5, "4362": 5, "4004": 5, "9400": 5, "9124": 5, "3616": 5, "1151": 5, "0000": [5, 25], "1535": 5, "0309": 5, "9315": 5, "1655": 5, "9897": 5, "0635": 5, "chang": [5, 44], "7895": 5, "7089": 5, "0364": 5, "6778": 5, "5803": 5, "2678": 5, "no_grad": 5, "ones": [5, 7], "classmethod": 5, "from_pretrain": 5, "freez": 5, "creat": 5, "instanc": [5, 7], "floattensor": 5, "pass": [5, 31, 34, 35, 36, 38, 39, 40, 41, 44], "second": [5, 29], "get": [5, 42, 43], "learn": [5, 8, 44], "pretrain": 5, "6": [5, 41], "1000": 5, "3000": 5, "approxim": [6, 10, 12, 13, 26, 44], "constraint": [6, 8, 9, 10, 11, 12, 13, 26, 28, 29, 32, 33, 40, 42, 44], "callabl": [6, 8, 9, 10, 11, 12, 13, 26, 28, 29, 32, 33, 40, 41, 44], "gmean": [6, 8, 9, 10, 11, 12, 13, 26, 28, 29, 32, 33, 44], "gaussian": [6, 26], "error": [6, 26, 39, 40], "linear": [6, 26, 41, 42, 44], "phi": [6, 26], "cumul": [6, 26], "tanh": [6, 26], "estim": [6, 7, 26], "sqrt": [6, 7, 8, 26], "pi": [6, 26], "044715": [6, 26], "algorithm": 6, "binaryconstraint": [6, 8, 10, 11, 26, 28, 32, 33], "whichtak": [6, 8, 10, 11, 26, 28, 32, 33], "output_scal": [6, 8, 10, 11, 18, 19, 20, 21, 26, 28, 29, 32, 33, 44], "grad_input_scal": [6, 8, 10, 11, 18, 20, 26, 28, 32, 33, 44], "constrain": [6, 8, 9, 10, 11, 12, 13, 15, 16, 17, 26, 28, 29, 32, 33, 44], "usual": [6, 8, 10, 11, 26, 28, 32, 33, 44], "necessari": [6, 8, 10, 11, 26, 28, 29, 31, 32, 33, 39, 44], "valid": [6, 8, 10, 11, 26, 28, 29, 32, 33, 44], "normalized_shap": [7, 27], "union": [7, 29, 40, 41], "ep": [7, 27], "1e": [7, 27, 44], "05": [7, 27, 44], "elementwise_affin": 7, "layer": [7, 8, 9, 10, 12, 13, 27, 31, 44], "normal": [7, 27, 44], "mathrm": 7, "var": 7, "epsilon": 7, "gamma": 7, "beta": [7, 28, 29], "deviat": [7, 38, 39, 40, 41, 44], "calcul": 7, "d": [7, 28, 39, 41, 44], "affin": 7, "transform": [7, 8, 12, 13, 28, 32, 43, 44], "via": [7, 40], "bias": 7, "unbias": 7, "unlik": [7, 44], "bia": [7, 8, 27, 28, 41, 44], "entir": 7, "plane": 7, "statist": 7, "data": [7, 8, 28, 33, 40], "both": [7, 29, 41, 44], "mode": [7, 39], "_shape": 7, "ldot": 7, "integ": 7, "treat": [7, 11], "singleton": 7, "specif": [7, 40], "denomin": 7, "numer": [7, 44], "stabil": 7, "boolean": [7, 39], "nlp": 7, "sentence_length": 7, "embed": [7, 12, 42, 43], "layer_norm": 7, "three": [7, 19, 21, 29], "spatial": 7, "shown": [7, 44], "in_featur": 8, "out_featur": 8, "incom": [8, 28], "tensorfloat32": [8, 28, 29], "On": [8, 29], "certain": [8, 27, 29, 40], "rocm": [8, 29], "float16": [8, 29], "addit": [8, 11, 28, 44], "_featur": [8, 28], "h_": 8, "includ": [8, 28], "30": 8, "128": 8, "print": [8, 41, 44], "hidden_s": [9, 10, 12, 13, 41], "head": [9, 12, 13], "dropout_p": [9, 12, 13], "multi": 9, "self": [9, 40, 41, 44], "attent": [9, 12, 13, 43], "warn": [9, 12, 13], "here": [9, 12, 13, 43, 44], "like": [9, 12, 13, 39, 44], "give": [9, 12, 13, 44], "incorrect": [9, 12, 13, 39], "hidden": [9, 10, 12, 13], "post": [9, 12, 13], "dropout": [9, 12, 13, 42], "take": [9, 12, 13, 29, 32, 44], "grad": [9, 12, 13, 20, 32, 35, 36, 39, 44], "act_fn": [10, 12, 13], "gelu": [10, 12, 13, 42, 44], "expansion_factor": 10, "": [10, 18, 19, 20, 21, 28, 29, 39, 40, 41, 44], "intermedi": [10, 40], "increas": [10, 39], "rel": [10, 12, 13, 30, 31], "so": [11, 33, 39, 40, 44], "lie": [11, 33], "multipli": [11, 29, 44], "li": 11, "therein": 11, "adjust": 11, "accordingli": 11, "defin": [11, 33, 39, 44], "x_i": [11, 33], "sum_j": [11, 33], "x_j": [11, 33], "unspecif": 11, "inf": 11, "along": [11, 33, 44], "slice": [11, 33, 40], "vocab_s": 12, "tau": [12, 13, 30, 31, 44], "decod": 12, "current": [12, 40, 43, 44], "just": [12, 39, 40], "demonstr": 12, "lack": 12, "kei": [12, 42, 43], "causal": [12, 43], "mask": [12, 43], "usag": 12, "infer": 12, "token": 12, "vocabulari": 12, "residu": [12, 13, 30, 31, 44], "branch": [12, 13, 30, 31, 44], "skip": [12, 13, 30, 31, 39, 44], "connect": [12, 13, 30, 31, 44], "prenorm": 13, "http": [13, 44], "arxiv": 13, "org": 13, "ab": 13, "2002": 13, "04745": 13, "common": [14, 22, 44], "arithmet": 15, "group": [15, 16, 17], "geometr": [16, 44], "harmon": 17, "xavier": [17, 44], "glorot": [17, 44], "select": [18, 19, 20, 21], "chosen": [18, 19, 20, 21], "op": [18, 19, 20, 21, 39, 40, 43, 44], "equal": [18, 19, 20, 21, 25, 31, 44], "left_grad_scal": [19, 21, 29], "right_grad_scal": [19, 21, 29], "left": [19, 21, 29, 44], "right": [19, 21, 29], "crossentropyloss": [23, 42, 44], "predict": 23, "section": 23, "divid": 23, "randint": 23, "int64": 23, "dictionaryand": 25, "row": 25, "maximum": 25, "column": 25, "modifi": [25, 39], "point": [25, 44], "v": 25, "embedding_matrix": 25, "rand": 25, "8490": 25, "9625": 25, "6753": 25, "9666": 25, "7761": 25, "6108": 25, "6246": 25, "9751": 25, "3618": 25, "4161": 25, "2419": 25, "7383": 25, "0237": 25, "7794": 25, "0528": 25, "3385": 25, "8612": 25, "1867": 25, "zero_": 25, "5609": 25, "5384": 25, "8720": 25, "6262": 25, "2438": 25, "7471": 25, "wise": [26, 32], "math": [26, 41], "param": 26, "sequenc": 27, "layernorm": [27, 42], "xa": 28, "b": [28, 29, 39], "opper": 28, "layout": [28, 29, 40], "autograd": [28, 29, 39], "miss": [28, 29, 43], "pleas": [28, 29], "open": [28, 29], "request": [28, 29, 43], "tupl": [29, 31, 39, 40, 41, 44], "product": 29, "behavior": 29, "prepend": 29, "its": [29, 32, 36, 39, 44], "purpos": [29, 44], "after": [29, 39], "remov": 29, "least": 29, "one": [29, 39, 44], "append": [29, 44], "broadcast": 29, "thu": [29, 44], "must": [29, 39, 44], "j": 29, "other": [29, 44], "logic": 29, "determin": [29, 44], "even": [29, 44], "though": [29, 44], "final": 29, "In": [29, 39, 44], "particular": [29, 44], "mm": 29, "order": [29, 31, 40, 44], "atupl": 29, "expectedthat": 29, "isprovid": 29, "togeth": [30, 44], "conjunct": [30, 31, 44], "residual_split": [30, 44], "come": 30, "result": [30, 31, 40], "split": 31, "prior": [31, 39], "residual_add": [31, 44], "delai": [31, 44], "still": [31, 39, 43], "normalis": 31, "typic": [31, 44], "kwarg": [32, 39, 40], "re": [33, 44], "desir": [33, 44], "cast": 33, "befor": [33, 39, 40, 44], "overflow": [33, 44], "unchang": 35, "develop": [37, 42, 43, 44], "model": [37, 42, 43], "dataclass": 38, "pair": 38, "intend": [38, 39, 43], "repres": [38, 39, 40, 41, 44], "record": [39, 40], "suppli": [39, 44], "dict": [39, 40], "static": 39, "ctx": 39, "functionctx": 39, "formula": 39, "differenti": 39, "automat": [39, 41], "alia": 39, "vjp": 39, "overridden": 39, "subclass": 39, "context": 39, "mani": [39, 43, 44], "were": 39, "attribut": [39, 40], "needs_input_grad": 39, "whether": 39, "jvp": 39, "grad_input": 39, "got": 39, "respect": 39, "object": 39, "mark_dirti": 39, "mark": 39, "most": [39, 44], "onc": [39, 43], "insid": 39, "method": [39, 40, 41, 42, 43, 44], "been": [39, 43, 44], "ensur": [39, 44], "correct": [39, 44], "our": [39, 42, 44], "doesn": 39, "matter": 39, "staticmethod": 39, "def": [39, 41, 44], "x_npy": 39, "numpi": 39, "share": [39, 44], "storag": 39, "once_differenti": 39, "grad_output": 39, "doubl": 39, "clone": [39, 44], "would": 39, "lead": [39, 44], "wrong": 39, "engin": 39, "know": 39, "unless": 39, "we": [39, 40, 42, 43, 44], "runtimeerror": 39, "variabl": 39, "mark_non_differenti": 39, "effici": [39, 44], "alwai": 39, "go": [39, 44], "sort": 39, "func": 39, "idx": 39, "save_for_backward": 39, "g1": 39, "g2": 39, "saved_tensor": 39, "zeros_lik": 39, "index_add_": 39, "futur": 39, "oppos": 39, "directli": 39, "memori": [39, 43], "leak": 39, "hook": 39, "graph": [39, 40], "saved_tensors_hook": 39, "intermediari": 39, "neither": 39, "nor": 39, "custom": 39, "decor": 39, "rais": 39, "recomput": 39, "tutori": 39, "access": 39, "through": [39, 40, 44], "made": 39, "weren": 39, "content": 39, "extend": 39, "how": [39, 42], "z": 39, "grad_out": 39, "gx": 39, "gy": 39, "gz": 39, "save_for_forward": 39, "x_t": 39, "y_t": 39, "fwad": 39, "dual_level": 39, "a_dual": 39, "make_du": 39, "set_materialize_grad": 39, "materi": 39, "undefin": 39, "expand": 39, "simplefunc": 39, "No": 39, "handl": [39, 40], "now": [39, 44], "induc": 39, "graphmodul": 40, "wrap": [40, 41], "fx": [40, 41, 44], "execut": 40, "instrument": 40, "call_funct": 40, "node": 40, "semant": 40, "invoc": 40, "keyword": 40, "compat": 40, "api": [40, 42, 44], "guarante": 40, "call_method": 40, "complex": 40, "memory_format": 40, "call_modul": 40, "fetch_args_kwargs_from_env": 40, "fetch": 40, "concret": 40, "environ": 40, "fetch_attr": 40, "hierarchi": 40, "fulli": 40, "qualfii": 40, "name": 40, "get_attr": 40, "Will": 40, "wa": 40, "map_nodes_to_valu": 40, "recurs": [40, 41], "descend": 40, "structur": 40, "within": [40, 44], "belong": 40, "report": 40, "realli": 40, "referenc": 40, "placehold": 40, "To": [40, 44], "tracer": 40, "target_to_funct": 40, "initial_env": 40, "enable_io_process": 40, "interpret": 40, "start": [40, 42, 44], "map": 40, "popul": 40, "partial": 40, "process_input": 40, "process_output": 40, "run_nod": 40, "recurse_modul": 41, "syntax_highlight": 41, "autowrap_modul": 41, "einop": 41, "usr": 41, "local": 41, "lib": 41, "8": [41, 44], "dist": 41, "packag": 41, "__init__": [41, 44], "py": 41, "__w": 41, "autowrap_funct": 41, "dummi": 41, "annot": 41, "analys": [41, 44], "fed": [41, 44], "analysi": [41, 44], "plain": 41, "toggl": 41, "behavour": 41, "moduletyp": 41, "whose": 41, "without": [41, 44], "string": 41, "reflect": 41, "mlp": [41, 42, 44], "super": [41, 44], "fc1": 41, "relu": 41, "fc2": 41, "requires_grad_": [41, 44], "bwd": [41, 44], "236": 41, "fc1_weight": 41, "018": [41, 44], "54": 41, "fc1_bia": 41, "0182": 41, "51": 41, "_c": [41, 44], "_nn": [41, 44], "578": [41, 44], "204": [41, 44], "337": 41, "288": 41, "fc2_weight": 41, "00902": [41, 44], "13": 41, "fc2_bia": 41, "00904": 41, "31": 41, "linear_1": [41, 44], "235": 41, "999": [41, 44], "welcom": 42, "design": [42, 44], "facilit": 42, "outlin": 42, "icml": [42, 44], "new": 42, "guid": 42, "high": 42, "level": [42, 44], "overview": [42, 44], "simpl": 42, "fp16": [42, 44], "fp8": [42, 44], "what": 42, "consider": 42, "licens": 42, "limit": 42, "refer": [42, 44], "mhsa": 42, "transformerdecod": 42, "transformerlay": 42, "util": [42, 44], "earli": 43, "stage": 43, "yet": [43, 44], "roadmap": 43, "fuse": 43, "introduc": [43, 44], "slow": 43, "down": [43, 44], "trip": 43, "address": [43, 44], "next": [43, 44], "flash": 43, "interplai": 43, "investig": [43, 44], "work": [43, 44], "exhaust": 43, "encourag": 43, "touch": 43, "git": 44, "github": 44, "com": 44, "research": 44, "fork": 44, "repo": 44, "instruct": 44, "paradigm": 44, "deep": 44, "aim": 44, "involv": 44, "term": 44, "unprincipl": 44, "wai": 44, "preserv": 44, "As": 44, "scratch": 44, "assumpt": 44, "advantag": 44, "great": 44, "perspect": 44, "roughli": 44, "headroom": 44, "grow": 44, "shrink": 44, "underflow": 44, "occur": 44, "becaus": 44, "although": 44, "drift": 44, "stai": 44, "test": 44, "far": 44, "smaller": 44, "behaviour": 44, "dynam": 44, "slightli": 44, "experi": 44, "decreas": 44, "faster": 44, "depth": 44, "treatment": 44, "approach": 44, "similar": 44, "motiv": 44, "keep": 44, "sens": 44, "understand": 44, "might": 44, "fp32": 44, "bf16": 44, "issu": 44, "veri": 44, "larg": 44, "small": 44, "3e": 44, "38": 44, "45": 44, "e5": 44, "60": 44, "000": 44, "6e": 44, "e4": 44, "try": 44, "put": 44, "speed": 44, "discuss": 44, "scope": 44, "introduct": 44, "step": 44, "present": 44, "tricki": 44, "tool": 44, "easi": 44, "analyse_modul": 44, "line": 44, "breakdown": 44, "alongsid": 44, "unscaledmlp": 44, "linear_2": 44, "deriv": 44, "fwd": 44, "annotated_cod": 44, "linear_1_weight": 44, "83": 44, "linear_1_bia": 44, "84": 44, "177": 44, "322": 44, "289": 44, "linear_2_weight": 44, "48": 44, "linear_2_bia": 44, "00894": 44, "198": 44, "firstli": 44, "decompos": 44, "secondli": 44, "fwd_scale": 44, "bwd_scale": 44, "denot": 44, "sign": 44, "abov": 44, "receiv": 44, "These": 44, "enough": 44, "unscal": 44, "could": 44, "caus": 44, "signific": 44, "show": 44, "drop": 44, "scaledmlp": 44, "01": 44, "716": 44, "729": 44, "707": 44, "64": 44, "706": 44, "693": 44, "03": 44, "979": 44, "basic": 44, "avail": 44, "repeat": 44, "until": 44, "good": 44, "There": 44, "measur": 44, "someth": 44, "art": 44, "max": 44, "min": 44, "aris": 44, "seen": 44, "clearli": 44, "explod": 44, "clip": 44, "convers": 44, "tend": 44, "degrad": 44, "steadili": 44, "exactli": 44, "meet": 44, "practic": 44, "concern": 44, "significantli": 44, "merit": 44, "divis": 44, "substanti": 44, "cross_entropi": 44, "mechan": 44, "control": 44, "initialis": 44, "push": 44, "themselv": 44, "howev": 44, "solv": 44, "outsid": 44, "separ": 44, "altern": 44, "care": 44, "form": 44, "residuallay": 44, "contrast": 44, "domin": 44, "hyperparamet": 44, "abl": 44, "leav": 44, "tune": 44, "emploi": 44, "trick": 44, "comprehens": 44, "found": 44, "produc": 44, "arriv": 44, "fan_in": 44, "fan_out": 44, "grad_weight_scal": 44, "grad_bias_scal": 44, "batch_siz": 44, "ideal": 44, "exact": 44, "compromis": 44, "don": 44, "why": 44}, "objects": {"": [[2, 0, 0, "-", "unit_scaling"]], "unit_scaling": [[3, 1, 1, "", "CrossEntropyLoss"], [4, 1, 1, "", "Dropout"], [5, 1, 1, "", "Embedding"], [6, 1, 1, "", "GELU"], [7, 1, 1, "", "LayerNorm"], [8, 1, 1, "", "Linear"], [9, 1, 1, "", "MHSA"], [10, 1, 1, "", "MLP"], [11, 1, 1, "", "Softmax"], [12, 1, 1, "", "TransformerDecoder"], [13, 1, 1, "", "TransformerLayer"], [14, 0, 0, "-", "constraints"], [22, 0, 0, "-", "functional"], [34, 0, 0, "-", "scale"], [37, 0, 0, "-", "utils"]], "unit_scaling.Embedding": [[5, 2, 1, "", "from_pretrained"], [5, 3, 1, "", "weight"]], "unit_scaling.LayerNorm": [[7, 3, 1, "", "bias"], [7, 3, 1, "", "weight"]], "unit_scaling.Linear": [[8, 3, 1, "", "bias"], [8, 3, 1, "", "weight"]], "unit_scaling.constraints": [[15, 4, 1, "", "amean"], [16, 4, 1, "", "gmean"], [17, 4, 1, "", "hmean"], [18, 4, 1, "", "to_grad_input_scale"], [19, 4, 1, "", "to_left_grad_scale"], [20, 4, 1, "", "to_output_scale"], [21, 4, 1, "", "to_right_grad_scale"]], "unit_scaling.functional": [[23, 4, 1, "", "cross_entropy"], [24, 4, 1, "", "dropout"], [25, 4, 1, "", "embedding"], [26, 4, 1, "", "gelu"], [27, 4, 1, "", "layer_norm"], [28, 4, 1, "", "linear"], [29, 4, 1, "", "matmul"], [30, 4, 1, "", "residual_add"], [31, 4, 1, "", "residual_split"], [32, 4, 1, "", "scale_elementwise"], [33, 4, 1, "", "softmax"]], "unit_scaling.scale": [[35, 4, 1, "", "scale_bwd"], [36, 4, 1, "", "scale_fwd"]], "unit_scaling.utils": [[38, 1, 1, "", "ScalePair"], [39, 1, 1, "", "ScaleTracker"], [40, 1, 1, "", "ScaleTrackingInterpreter"], [41, 4, 1, "", "analyse_module"]], "unit_scaling.utils.ScaleTracker": [[39, 2, 1, "", "backward"], [39, 2, 1, "", "jvp"], [39, 2, 1, "", "mark_dirty"], [39, 2, 1, "", "mark_non_differentiable"], [39, 2, 1, "", "save_for_backward"], [39, 2, 1, "", "save_for_forward"], [39, 2, 1, "", "set_materialize_grads"], [39, 2, 1, "", "vjp"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[40, 2, 1, "", "call_function"], [40, 2, 1, "", "call_method"], [40, 2, 1, "", "call_module"], [40, 2, 1, "", "fetch_args_kwargs_from_env"], [40, 2, 1, "", "fetch_attr"], [40, 2, 1, "", "get_attr"], [40, 2, 1, "", "map_nodes_to_values"], [40, 2, 1, "", "output"], [40, 2, 1, "", "placeholder"], [40, 2, 1, "", "run"], [40, 2, 1, "", "run_node"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "function", "Python function"]}, "titleterms": {"api": 0, "refer": 0, "unit": [1, 42, 44], "scale": [1, 34, 35, 36, 42, 44], "develop": 1, "licens": 1, "unit_sc": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41], "crossentropyloss": 3, "dropout": [4, 24], "embed": [5, 25], "gelu": [6, 26], "layernorm": 7, "linear": [8, 28], "mhsa": 9, "mlp": 10, "softmax": [11, 33], "transformerdecod": 12, "transformerlay": 13, "constraint": [14, 15, 16, 17, 18, 19, 20, 21], "amean": 15, "gmean": 16, "hmean": 17, "to_grad_input_scal": 18, "to_left_grad_scal": 19, "to_output_scal": 20, "to_right_grad_scal": 21, "function": [22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33], "cross_entropi": 23, "layer_norm": 27, "matmul": 29, "residual_add": 30, "residual_split": 31, "scale_elementwis": 32, "scale_bwd": 35, "scale_fwd": 36, "util": [37, 38, 39, 40, 41], "scalepair": 38, "scaletrack": 39, "scaletrackinginterpret": 40, "analyse_modul": 41, "content": 42, "limit": 43, "user": 44, "guid": 44, "instal": 44, "what": 44, "i": 44, "how": 44, "model": 44, "kei": 44, "consider": 44}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"API Reference": [[0, "api-reference"]], "Unit Scaling": [[1, "unit-scaling"], [42, "unit-scaling"]], "Development": [[1, "development"]], "License": [[1, "license"]], "unit_scaling": [[2, "module-unit_scaling"]], "unit_scaling.CrossEntropyLoss": [[3, "unit-scaling-crossentropyloss"]], "unit_scaling.Dropout": [[4, "unit-scaling-dropout"]], "unit_scaling.Embedding": [[5, "unit-scaling-embedding"]], "unit_scaling.GELU": [[6, "unit-scaling-gelu"]], "unit_scaling.LayerNorm": [[7, "unit-scaling-layernorm"]], "unit_scaling.Linear": [[8, "unit-scaling-linear"]], "unit_scaling.MHSA": [[9, "unit-scaling-mhsa"]], "unit_scaling.MLP": [[10, "unit-scaling-mlp"]], "unit_scaling.Softmax": [[11, "unit-scaling-softmax"]], "unit_scaling.TransformerDecoder": [[12, "unit-scaling-transformerdecoder"]], "unit_scaling.TransformerLayer": [[13, "unit-scaling-transformerlayer"]], "unit_scaling.constraints": [[14, "module-unit_scaling.constraints"]], "unit_scaling.constraints.amean": [[15, "unit-scaling-constraints-amean"]], "unit_scaling.constraints.gmean": [[16, "unit-scaling-constraints-gmean"]], "unit_scaling.constraints.hmean": [[17, "unit-scaling-constraints-hmean"]], "unit_scaling.constraints.to_grad_input_scale": [[18, "unit-scaling-constraints-to-grad-input-scale"]], "unit_scaling.constraints.to_left_grad_scale": [[19, "unit-scaling-constraints-to-left-grad-scale"]], "unit_scaling.constraints.to_output_scale": [[20, "unit-scaling-constraints-to-output-scale"]], "unit_scaling.constraints.to_right_grad_scale": [[21, "unit-scaling-constraints-to-right-grad-scale"]], "unit_scaling.functional": [[22, "module-unit_scaling.functional"]], "unit_scaling.functional.cross_entropy": [[23, "unit-scaling-functional-cross-entropy"]], "unit_scaling.functional.dropout": [[24, "unit-scaling-functional-dropout"]], "unit_scaling.functional.embedding": [[25, "unit-scaling-functional-embedding"]], "unit_scaling.functional.gelu": [[26, "unit-scaling-functional-gelu"]], "unit_scaling.functional.layer_norm": [[27, "unit-scaling-functional-layer-norm"]], "unit_scaling.functional.linear": [[28, "unit-scaling-functional-linear"]], "unit_scaling.functional.matmul": [[29, "unit-scaling-functional-matmul"]], "unit_scaling.functional.residual_add": [[30, "unit-scaling-functional-residual-add"]], "unit_scaling.functional.residual_split": [[31, "unit-scaling-functional-residual-split"]], "unit_scaling.functional.scale_elementwise": [[32, "unit-scaling-functional-scale-elementwise"]], "unit_scaling.functional.softmax": [[33, "unit-scaling-functional-softmax"]], "unit_scaling.scale": [[34, "module-unit_scaling.scale"]], "unit_scaling.scale.scale_bwd": [[35, "unit-scaling-scale-scale-bwd"]], "unit_scaling.scale.scale_fwd": [[36, "unit-scaling-scale-scale-fwd"]], "unit_scaling.utils": [[37, "module-unit_scaling.utils"]], "unit_scaling.utils.ScalePair": [[38, "unit-scaling-utils-scalepair"]], "unit_scaling.utils.ScaleTracker": [[39, "unit-scaling-utils-scaletracker"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[40, "unit-scaling-utils-scaletrackinginterpreter"]], "unit_scaling.utils.analyse_module": [[41, "unit-scaling-utils-analyse-module"]], "Contents": [[42, null]], "Limitations": [[43, "limitations"]], "User Guide": [[44, "user-guide"]], "Installation": [[44, "installation"]], "What is unit scaling?": [[44, "what-is-unit-scaling"]], "How to unit-scale a model": [[44, "how-to-unit-scale-a-model"]], "Key considerations for unit scaling": [[44, "key-considerations-for-unit-scaling"]]}, "indexentries": {"module": [[2, "module-unit_scaling"], [14, "module-unit_scaling.constraints"], [22, "module-unit_scaling.functional"], [34, "module-unit_scaling.scale"], [37, "module-unit_scaling.utils"]], "unit_scaling": [[2, "module-unit_scaling"]], "crossentropyloss (class in unit_scaling)": [[3, "unit_scaling.CrossEntropyLoss"]], "dropout (class in unit_scaling)": [[4, "unit_scaling.Dropout"]], "embedding (class in unit_scaling)": [[5, "unit_scaling.Embedding"]], "from_pretrained() (unit_scaling.embedding class method)": [[5, "unit_scaling.Embedding.from_pretrained"]], "weight (unit_scaling.embedding attribute)": [[5, "unit_scaling.Embedding.weight"]], "gelu (class in unit_scaling)": [[6, "unit_scaling.GELU"]], "layernorm (class in unit_scaling)": [[7, "unit_scaling.LayerNorm"]], "bias (unit_scaling.layernorm attribute)": [[7, "unit_scaling.LayerNorm.bias"]], "weight (unit_scaling.layernorm attribute)": [[7, "unit_scaling.LayerNorm.weight"]], "linear (class in unit_scaling)": [[8, "unit_scaling.Linear"]], "bias (unit_scaling.linear attribute)": [[8, "unit_scaling.Linear.bias"]], "weight (unit_scaling.linear attribute)": [[8, "unit_scaling.Linear.weight"]], "mhsa (class in unit_scaling)": [[9, "unit_scaling.MHSA"]], "mlp (class in unit_scaling)": [[10, "unit_scaling.MLP"]], "softmax (class in unit_scaling)": [[11, "unit_scaling.Softmax"]], "transformerdecoder (class in unit_scaling)": [[12, "unit_scaling.TransformerDecoder"]], "transformerlayer (class in unit_scaling)": [[13, "unit_scaling.TransformerLayer"]], "unit_scaling.constraints": [[14, "module-unit_scaling.constraints"]], "amean() (in module unit_scaling.constraints)": [[15, "unit_scaling.constraints.amean"]], "gmean() (in module unit_scaling.constraints)": [[16, "unit_scaling.constraints.gmean"]], "hmean() (in module unit_scaling.constraints)": [[17, "unit_scaling.constraints.hmean"]], "to_grad_input_scale() (in module unit_scaling.constraints)": [[18, "unit_scaling.constraints.to_grad_input_scale"]], "to_left_grad_scale() (in module unit_scaling.constraints)": [[19, "unit_scaling.constraints.to_left_grad_scale"]], "to_output_scale() (in module unit_scaling.constraints)": [[20, "unit_scaling.constraints.to_output_scale"]], "to_right_grad_scale() (in module unit_scaling.constraints)": [[21, "unit_scaling.constraints.to_right_grad_scale"]], "unit_scaling.functional": [[22, "module-unit_scaling.functional"]], "cross_entropy() (in module unit_scaling.functional)": [[23, "unit_scaling.functional.cross_entropy"]], "dropout() (in module unit_scaling.functional)": [[24, "unit_scaling.functional.dropout"]], "embedding() (in module unit_scaling.functional)": [[25, "unit_scaling.functional.embedding"]], "gelu() (in module unit_scaling.functional)": [[26, "unit_scaling.functional.gelu"]], "layer_norm() (in module unit_scaling.functional)": [[27, "unit_scaling.functional.layer_norm"]], "linear() (in module unit_scaling.functional)": [[28, "unit_scaling.functional.linear"]], "matmul() (in module unit_scaling.functional)": [[29, "unit_scaling.functional.matmul"]], "residual_add() (in module unit_scaling.functional)": [[30, "unit_scaling.functional.residual_add"]], "residual_split() (in module unit_scaling.functional)": [[31, "unit_scaling.functional.residual_split"]], "scale_elementwise() (in module unit_scaling.functional)": [[32, "unit_scaling.functional.scale_elementwise"]], "softmax() (in module unit_scaling.functional)": [[33, "unit_scaling.functional.softmax"]], "unit_scaling.scale": [[34, "module-unit_scaling.scale"]], "scale_bwd() (in module unit_scaling.scale)": [[35, "unit_scaling.scale.scale_bwd"]], "scale_fwd() (in module unit_scaling.scale)": [[36, "unit_scaling.scale.scale_fwd"]], "unit_scaling.utils": [[37, "module-unit_scaling.utils"]], "scalepair (class in unit_scaling.utils)": [[38, "unit_scaling.utils.ScalePair"]], "scaletracker (class in unit_scaling.utils)": [[39, "unit_scaling.utils.ScaleTracker"]], "backward() (unit_scaling.utils.scaletracker static method)": [[39, "unit_scaling.utils.ScaleTracker.backward"]], "jvp() (unit_scaling.utils.scaletracker static method)": [[39, "unit_scaling.utils.ScaleTracker.jvp"]], "mark_dirty() (unit_scaling.utils.scaletracker method)": [[39, "unit_scaling.utils.ScaleTracker.mark_dirty"]], "mark_non_differentiable() (unit_scaling.utils.scaletracker method)": [[39, "unit_scaling.utils.ScaleTracker.mark_non_differentiable"]], "save_for_backward() (unit_scaling.utils.scaletracker method)": [[39, "unit_scaling.utils.ScaleTracker.save_for_backward"]], "save_for_forward() (unit_scaling.utils.scaletracker method)": [[39, "unit_scaling.utils.ScaleTracker.save_for_forward"]], "set_materialize_grads() (unit_scaling.utils.scaletracker method)": [[39, "unit_scaling.utils.ScaleTracker.set_materialize_grads"]], "vjp() (unit_scaling.utils.scaletracker static method)": [[39, "unit_scaling.utils.ScaleTracker.vjp"]], "scaletrackinginterpreter (class in unit_scaling.utils)": [[40, "unit_scaling.utils.ScaleTrackingInterpreter"]], "call_function() (unit_scaling.utils.scaletrackinginterpreter method)": [[40, "unit_scaling.utils.ScaleTrackingInterpreter.call_function"]], "call_method() (unit_scaling.utils.scaletrackinginterpreter method)": [[40, "unit_scaling.utils.ScaleTrackingInterpreter.call_method"]], "call_module() (unit_scaling.utils.scaletrackinginterpreter method)": [[40, "unit_scaling.utils.ScaleTrackingInterpreter.call_module"]], "fetch_args_kwargs_from_env() (unit_scaling.utils.scaletrackinginterpreter method)": [[40, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_args_kwargs_from_env"]], "fetch_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[40, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_attr"]], "get_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[40, "unit_scaling.utils.ScaleTrackingInterpreter.get_attr"]], "map_nodes_to_values() (unit_scaling.utils.scaletrackinginterpreter method)": [[40, "unit_scaling.utils.ScaleTrackingInterpreter.map_nodes_to_values"]], "output() (unit_scaling.utils.scaletrackinginterpreter method)": [[40, "unit_scaling.utils.ScaleTrackingInterpreter.output"]], "placeholder() (unit_scaling.utils.scaletrackinginterpreter method)": [[40, "unit_scaling.utils.ScaleTrackingInterpreter.placeholder"]], "run() (unit_scaling.utils.scaletrackinginterpreter method)": [[40, "unit_scaling.utils.ScaleTrackingInterpreter.run"]], "run_node() (unit_scaling.utils.scaletrackinginterpreter method)": [[40, "unit_scaling.utils.ScaleTrackingInterpreter.run_node"]], "analyse_module() (in module unit_scaling.utils)": [[41, "unit_scaling.utils.analyse_module"]]}})