Search.setIndex({"docnames": ["api_reference", "development", "generated/unit_scaling", "generated/unit_scaling.CrossEntropyLoss", "generated/unit_scaling.Dropout", "generated/unit_scaling.Embedding", "generated/unit_scaling.GELU", "generated/unit_scaling.LayerNorm", "generated/unit_scaling.Linear", "generated/unit_scaling.MHSA", "generated/unit_scaling.MLP", "generated/unit_scaling.Softmax", "generated/unit_scaling.TransformerDecoder", "generated/unit_scaling.TransformerLayer", "generated/unit_scaling.functional", "generated/unit_scaling.functional.cross_entropy", "generated/unit_scaling.functional.dropout", "generated/unit_scaling.functional.embedding", "generated/unit_scaling.functional.gelu", "generated/unit_scaling.functional.layer_norm", "generated/unit_scaling.functional.linear", "generated/unit_scaling.functional.matmul", "generated/unit_scaling.functional.residual_add", "generated/unit_scaling.functional.residual_split", "generated/unit_scaling.functional.scale_elementwise", "generated/unit_scaling.functional.softmax", "index", "limitations", "user_guide"], "filenames": ["api_reference.rst", "development.rst", "generated/unit_scaling.rst", "generated/unit_scaling.CrossEntropyLoss.rst", "generated/unit_scaling.Dropout.rst", "generated/unit_scaling.Embedding.rst", "generated/unit_scaling.GELU.rst", "generated/unit_scaling.LayerNorm.rst", "generated/unit_scaling.Linear.rst", "generated/unit_scaling.MHSA.rst", "generated/unit_scaling.MLP.rst", "generated/unit_scaling.Softmax.rst", "generated/unit_scaling.TransformerDecoder.rst", "generated/unit_scaling.TransformerLayer.rst", "generated/unit_scaling.functional.rst", "generated/unit_scaling.functional.cross_entropy.rst", "generated/unit_scaling.functional.dropout.rst", "generated/unit_scaling.functional.embedding.rst", "generated/unit_scaling.functional.gelu.rst", "generated/unit_scaling.functional.layer_norm.rst", "generated/unit_scaling.functional.linear.rst", "generated/unit_scaling.functional.matmul.rst", "generated/unit_scaling.functional.residual_add.rst", "generated/unit_scaling.functional.residual_split.rst", "generated/unit_scaling.functional.scale_elementwise.rst", "generated/unit_scaling.functional.softmax.rst", "index.rst", "limitations.rst", "user_guide.rst"], "titles": ["API Reference", "Unit Scaling", "unit_scaling", "unit_scaling.CrossEntropyLoss", "unit_scaling.Dropout", "unit_scaling.Embedding", "unit_scaling.GELU", "unit_scaling.LayerNorm", "unit_scaling.Linear", "unit_scaling.MHSA", "unit_scaling.MLP", "unit_scaling.Softmax", "unit_scaling.TransformerDecoder", "unit_scaling.TransformerLayer", "unit_scaling.functional", "unit_scaling.functional.cross_entropy", "unit_scaling.functional.dropout", "unit_scaling.functional.embedding", "unit_scaling.functional.gelu", "unit_scaling.functional.layer_norm", "unit_scaling.functional.linear", "unit_scaling.functional.matmul", "unit_scaling.functional.residual_add", "unit_scaling.functional.residual_split", "unit_scaling.functional.scale_elementwise", "unit_scaling.functional.softmax", "Unit Scaling", "Limitations", "User Guide"], "terms": {"unit": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 25, 27], "scale": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 27], "i": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 20, 21, 23, 24, 25, 26, 27], "implement": [0, 4, 9, 10, 11, 12, 13, 27, 28], "us": [0, 1, 3, 4, 5, 6, 7, 8, 9, 12, 13, 16, 17, 21, 22, 23, 25, 26, 28], "thin": 0, "wrapper": 0, "around": 0, "exist": [0, 28], "torch": [0, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 17, 18, 20, 21, 24, 25, 28], "nn": [0, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 17, 28], "class": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 25, 28], "function": [0, 1, 4, 6, 8, 9, 10, 11, 12, 13, 26, 27, 28], "document": [0, 1, 5], "also": [0, 3, 28], "inherit": 0, "from": [0, 4, 5, 7, 8, 11, 16, 28], "standard": [0, 7, 11, 23, 28], "pytorch": [0, 1, 28], "doc": [0, 1, 11, 28], "modif": 0, "note": [0, 1, 3, 5, 12, 15, 17, 21, 28], "some": [0, 3, 15, 20, 21, 27, 28], "mai": [0, 3, 20, 21, 28], "longer": 0, "relev": 0, "ar": [0, 1, 3, 4, 7, 8, 11, 15, 21, 23, 26, 28], "nevertheless": 0, "The": [0, 3, 5, 7, 8, 11, 15, 17, 21, 23, 27, 28], "built": 0, "mirror": 0, "close": 0, "possibl": [0, 17, 28], "can": [0, 1, 3, 4, 5, 28], "easili": 0, "swap": [0, 28], "out": [0, 1, 4, 8, 20, 21, 22, 26, 28], "equival": [0, 3, 5, 7, 28], "For": [0, 1, 5, 7, 21, 26, 28], "code": [0, 28], "which": [0, 3, 7, 9, 10, 11, 12, 13, 21, 23, 25, 28], "follow": [0, 1, 21, 24, 27, 28], "import": [0, 1, 26, 27, 28], "f": [0, 15, 17, 24, 28], "appli": [0, 3, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 28], "first": [0, 1, 5, 21, 24, 28], "ad": [0, 7, 28], "unit_sc": [0, 26, 28], "uu": [0, 28], "u": [0, 8, 28], "replac": [0, 28], "letter": 0, "those": [0, 3, 15, 27, 28], "assum": [0, 28], "thei": [0, 1, 26, 27, 28], "support": [0, 1, 3, 4, 5, 8, 15, 16, 17, 20, 21, 27], "click": 0, "below": [0, 7, 11, 15, 28], "full": [0, 28], "A": [1, 3, 4, 5, 9, 10, 11, 12, 13, 15, 17, 21, 25, 28], "librari": [1, 26, 27, 28], "base": [1, 20, 28], "paper": [1, 4, 7, 26, 28], "box": [1, 26, 28], "low": [1, 26, 28], "precis": [1, 8, 21, 26, 28], "train": [1, 3, 4, 5, 7, 16, 17, 26, 27, 28], "found": [1, 28], "http": [1, 13, 28], "graphcor": [1, 28], "research": [1, 28], "github": [1, 28], "io": 1, "warn": [1, 9, 12, 13, 26, 28], "thi": [1, 3, 4, 5, 7, 8, 12, 16, 17, 20, 21, 23, 25, 26, 27, 28], "current": [1, 12, 26, 27, 28], "its": [1, 21, 24, 26, 28], "alpha": 1, "releas": [1, 26, 28], "mean": [1, 3, 4, 6, 7, 8, 11, 15, 20, 26, 28], "unoptimis": [1, 26], "miss": [1, 20, 21, 26, 27, 28], "we": [1, 26, 27, 28], "hope": [1, 26, 28], "user": [1, 26, 27], "still": [1, 23, 26, 27, 28], "find": [1, 26, 28], "valuabl": [1, 26, 28], "should": [1, 3, 11, 15, 22, 23, 24, 26, 28], "expect": [1, 3, 7, 26, 28], "work": [1, 26, 27, 28], "seamlessli": [1, 26, 28], "keen": [1, 26, 28], "help": [1, 26, 28], "earli": [1, 26, 27, 28], "ani": [1, 4, 6, 8, 9, 11, 12, 13, 20, 26, 28], "problem": [1, 3, 26, 28], "encount": [1, 26, 28], "who": [1, 28], "wish": [1, 28], "codebas": [1, 28], "setup": 1, "requir": [1, 3, 27, 28], "time": [1, 7, 21, 28], "python3": 1, "m": [1, 4, 6, 8, 11, 21], "venv": 1, "sourc": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25], "bin": 1, "activ": [1, 7, 10, 12, 13, 28], "pip": [1, 28], "instal": [1, 26], "r": [1, 5, 17], "dev": 1, "txt": 1, "Or": 1, "ipu": 1, "subsequ": 1, "run": [1, 28], "pre": [1, 28], "flight": 1, "check": [1, 28], "see": [1, 3, 5, 13, 15, 16, 17, 18, 19, 25, 26, 28], "command": 1, "id": 1, "recommend": [1, 26, 28], "python": 1, "intepret": 1, "set": [1, 3, 4, 7, 8, 15, 16, 27, 28], "format": [1, 28], "save": 1, "enabl": [1, 28], "consid": [1, 3, 28], "env": 1, "file": 1, "pythonpath": 1, "e": [1, 3, 5, 7, 11, 12, 17, 21, 28], "g": [1, 11, 12], "echo": 1, "pwd": 1, "differ": [1, 8, 21, 28], "path": 1, "devcontain": 1, "cd": 1, "make": [1, 28], "html": 1, "view": 1, "_build": 1, "index": [1, 3, 5, 17], "your": [1, 28], "browser": 1, "copyright": 1, "c": [1, 3, 7, 15], "2023": [1, 26, 28], "ltd": 1, "under": [1, 17], "mit": 1, "notic": [1, 20, 21], "md": 1, "further": [1, 28], "detail": [1, 5, 15, 16, 17, 19, 25, 28], "version": [2, 14, 21, 24, 28], "common": [2, 14, 28], "modul": [2, 4, 5, 7, 8, 10, 12, 13, 17, 21, 28], "weight": [3, 5, 7, 8, 12, 13, 15, 17, 19, 20, 22, 23, 28], "tensor": [3, 4, 5, 8, 11, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28], "none": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 17, 18, 19, 20, 21, 24, 25, 28], "size_averag": [3, 15], "ignore_index": [3, 15], "int": [3, 5, 7, 8, 9, 10, 11, 12, 13, 15, 17, 19, 25, 28], "100": [3, 15], "reduc": [3, 15], "reduct": [3, 15], "str": [3, 6, 15], "label_smooth": [3, 15], "float": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 28], "0": [3, 4, 5, 6, 7, 11, 12, 13, 15, 16, 17, 18, 22, 23, 25, 28], "comput": [3, 4, 5, 7, 11, 15, 17, 25, 28], "cross": [3, 15, 28], "entropi": [3, 15, 28], "loss": [3, 15, 28], "between": [3, 15, 23, 27, 28], "input": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 23, 24, 25, 28], "logit": [3, 15], "target": [3, 15, 28], "It": [3, 25, 28], "when": [3, 6, 7, 8, 11, 15, 18, 21, 28], "classif": 3, "If": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 20, 21, 24, 25], "provid": [3, 6, 8, 9, 10, 11, 12, 13, 18, 20, 24, 25, 28], "option": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 17, 18, 20, 21, 22, 23, 24, 25], "argument": [3, 6, 18, 21, 28], "1d": 3, "assign": 3, "each": [3, 4, 5, 7, 8, 15, 17, 28], "particularli": [3, 28], "you": [3, 20, 21], "have": [3, 5, 17, 20, 21, 27, 28], "an": [3, 4, 5, 7, 8, 10, 11, 16, 17, 21, 23, 24, 28], "unbalanc": 3, "contain": [3, 5, 15, 17, 28], "unnorm": [3, 15], "do": [3, 4, 5, 16, 17, 28], "need": [3, 23, 28], "posit": [3, 12, 27], "sum": [3, 11, 15, 25], "1": [3, 4, 5, 6, 7, 8, 11, 15, 17, 18, 21, 25, 28], "gener": [3, 27, 28], "ha": [3, 4, 7, 15, 21, 27, 28], "size": [3, 5, 7, 8, 9, 10, 12, 13, 15, 17], "unbatch": 3, "minibatch": [3, 15], "d_1": [3, 15], "d_2": [3, 15], "d_k": [3, 15], "k": [3, 8, 15, 21], "geq": [3, 15], "dimension": [3, 5, 7, 11, 15, 21], "case": [3, 15, 28], "last": [3, 7, 8, 19], "being": [3, 5, 15, 23], "higher": 3, "dimens": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 19, 20, 21, 25], "per": [3, 7, 15], "pixel": 3, "2d": 3, "imag": [3, 7], "criterion": 3, "either": [3, 15, 21], "indic": [3, 5, 15, 17], "rang": [3, 11, 25, 28], "where": [3, 5, 6, 7, 8, 11, 15, 17, 18, 20, 21, 28], "number": [3, 6, 8, 9, 11, 12, 13, 15, 17, 19, 20, 28], "specifi": [3, 5, 15, 17, 25, 28], "accept": 3, "necessarili": 3, "unreduc": 3, "describ": [3, 4, 15], "ell": 3, "x": [3, 6, 7, 18, 28], "y": [3, 7, 20], "l": 3, "l_1": 3, "dot": [3, 21], "l_n": 3, "top": 3, "quad": 3, "w_": 3, "y_n": 3, "log": [3, 28], "frac": [3, 4, 7, 8, 11, 25], "exp": [3, 11, 25], "x_": [3, 11, 25], "n": [3, 5, 7, 11, 15, 21], "sum_": 3, "cdot": 3, "mathbb": 3, "text": [3, 5, 6, 7, 8, 11, 15, 18, 25], "ignor": [3, 15, 28], "_index": 3, "w": [3, 5, 7, 17], "span": 3, "well": [3, 28], "default": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 28], "begin": [3, 15, 28], "end": [3, 15, 28], "combin": [3, 20, 21, 22, 28], "logsoftmax": 3, "nllloss": 3, "probabl": [3, 4, 9, 12, 13, 15, 16], "label": 3, "beyond": [3, 28], "singl": [3, 6, 7, 8, 9, 10, 11, 12, 13, 18, 20, 21, 24, 25], "item": 3, "blend": 3, "smooth": [3, 15], "etc": 3, "w_c": 3, "y_": 3, "perform": [3, 25, 28], "better": 3, "allow": [3, 28], "optim": 3, "onli": [3, 15, 21, 28], "too": 3, "restrict": [3, 21], "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 20, 21, 22, 23, 24, 25], "manual": [3, 15], "rescal": [3, 11, 15], "given": [3, 5, 15, 17, 28], "bool": [3, 4, 5, 7, 8, 15, 16, 17], "deprec": [3, 15], "By": [3, 15, 28], "averag": [3, 15], "over": [3, 7, 15, 28], "element": [3, 4, 7, 11, 15, 16, 18, 24, 25], "batch": [3, 5, 7, 15, 17, 21], "multipl": [3, 15, 21, 28], "sampl": [3, 4, 5, 8, 15, 16, 17], "field": [3, 15], "fals": [3, 4, 5, 7, 8, 15, 16, 17], "instead": [3, 15], "true": [3, 4, 5, 7, 8, 15, 16, 17], "valu": [3, 5, 7, 8, 11, 15, 28], "doe": [3, 5, 15, 21, 28], "contribut": [3, 5, 15, 17], "gradient": [3, 5, 6, 8, 9, 10, 11, 12, 13, 15, 17, 18, 20, 21, 23, 24, 25, 28], "non": [3, 5, 15, 17, 21, 28], "applic": [3, 15], "observ": [3, 15], "depend": [3, 15, 21, 28], "return": [3, 6, 8, 9, 10, 11, 12, 13, 15, 18, 20, 21, 22, 23, 24, 25, 28], "output": [3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 15, 17, 20, 21, 24, 28], "taken": [3, 28], "process": [3, 5, 15], "meantim": [3, 15], "two": [3, 15, 21, 23, 28], "arg": [3, 15, 24], "overrid": [3, 15], "amount": [3, 15], "becom": [3, 15], "mixtur": [3, 15], "origin": [3, 15], "ground": [3, 15], "truth": [3, 15], "uniform": [3, 15], "distribut": [3, 4, 6, 15, 16, 18, 27, 28], "rethink": [3, 15], "incept": [3, 15], "architectur": [3, 15], "vision": [3, 15], "shape": [3, 4, 5, 6, 7, 8, 11, 15, 17, 20], "same": [3, 4, 6, 7, 8, 11, 15, 21, 28], "otherwis": 3, "scalar": [3, 7, 21, 28], "align": [3, 15], "exampl": [3, 4, 5, 6, 7, 8, 11, 15, 17, 21, 28], "randn": [3, 4, 6, 7, 8, 11, 15, 28], "3": [3, 5, 6, 7, 11, 15, 17, 18, 28], "5": [3, 4, 5, 6, 7, 15, 16, 17, 18, 28], "requires_grad": [3, 5, 15], "empti": 3, "dtype": [3, 5, 7, 8, 15, 20, 21, 25], "long": 3, "random_": 3, "backward": [3, 8, 15, 21, 23, 28], "softmax": [3, 9, 12, 13, 15, 26, 28], "dim": [3, 11, 15, 25], "p": [4, 5, 16, 17, 21], "inplac": [4, 16], "bernoulli": [4, 16], "channel": [4, 7], "zero": [4, 5, 7, 16], "independ": 4, "everi": [4, 11], "forward": [4, 28], "call": 4, "proven": 4, "effect": [4, 28], "techniqu": [4, 26, 28], "regular": 4, "prevent": [4, 25], "co": 4, "adapt": [4, 28], "neuron": 4, "improv": 4, "neural": 4, "network": [4, 23], "featur": [4, 20, 21, 27, 28], "detector": 4, "_": 4, "furthermor": 4, "factor": [4, 10, 28], "dure": [4, 5, 17, 28], "evalu": [4, 7, 28], "simpli": [4, 28], "ident": [4, 28], "oper": [4, 16, 20, 21, 25, 28], "place": [4, 16, 17, 28], "2": [4, 5, 6, 7, 11, 12, 13, 17, 18, 20, 21, 22, 23, 28], "20": [4, 7, 8], "16": [4, 28], "num_embed": 5, "embedding_dim": [5, 7, 17], "padding_idx": [5, 17], "max_norm": [5, 17], "norm_typ": [5, 17], "scale_grad_by_freq": [5, 17], "spars": [5, 11, 17, 20, 21], "_weight": 5, "_freez": 5, "devic": [5, 7, 8, 20, 21], "lookup": [5, 17], "tabl": [5, 17], "look": [5, 17, 21, 28], "up": [5, 17, 28], "fix": [5, 17, 28], "dictionari": 5, "often": [5, 17, 21, 28], "store": 5, "word": [5, 17], "retriev": [5, 17], "them": [5, 11, 25], "list": [5, 7, 17, 27], "correspond": [5, 17], "vector": [5, 17, 21], "entri": [5, 17], "therefor": [5, 17], "updat": [5, 17, 28], "remain": [5, 17], "pad": [5, 17], "newli": 5, "construct": 5, "all": [5, 8, 21, 25, 28], "anoth": 5, "norm": [5, 17], "larger": [5, 17, 28], "than": [5, 17], "renorm": [5, 17], "invers": [5, 17], "frequenc": [5, 17], "mini": [5, 7, 17], "t": [5, 17, 20, 28], "matrix": [5, 17, 21], "more": [5, 17, 25, 27, 28], "regard": [5, 17, 28], "learnabl": [5, 7, 8], "initi": [5, 7, 8, 28], "mathcal": [5, 8], "type": [5, 6, 8, 9, 10, 11, 12, 13, 17, 18, 20, 21, 22, 23, 24, 25], "inttensor": 5, "longtensor": [5, 17], "arbitrari": [5, 17, 27, 28], "extract": [5, 17], "h": [5, 7], "_dim": 5, "10": [5, 7, 17, 28], "4": [5, 10, 17, 28], "9": [5, 17], "xdoctest": [5, 17], "ignore_w": [5, 17], "determinist": [5, 17], "0251": 5, "6902": 5, "7172": 5, "6431": 5, "0748": 5, "6969": 5, "4970": 5, "3448": 5, "9685": 5, "3677": 5, "7265": 5, "1685": 5, "4362": 5, "4004": 5, "9400": 5, "9124": 5, "3616": 5, "1151": 5, "0000": [5, 17], "1535": 5, "0309": 5, "9315": 5, "1655": 5, "9897": 5, "0635": 5, "chang": [5, 28], "7895": 5, "7089": 5, "0364": 5, "6778": 5, "5803": 5, "2678": 5, "no_grad": 5, "ones": [5, 7], "classmethod": 5, "from_pretrain": 5, "freez": 5, "creat": 5, "instanc": [5, 7], "floattensor": 5, "pass": [5, 23, 28], "second": [5, 21], "get": [5, 26, 27, 28], "learn": [5, 8, 28], "pretrain": 5, "6": 5, "1000": 5, "3000": 5, "constraint": [6, 8, 9, 10, 11, 12, 13, 18, 20, 21, 24, 25, 28], "callabl": [6, 8, 9, 10, 11, 12, 13, 18, 20, 21, 24, 25, 28], "gmean": [6, 8, 9, 10, 11, 12, 13, 18, 20, 21, 24, 25, 28], "gaussian": [6, 18], "error": [6, 18], "linear": [6, 18, 26, 28], "phi": [6, 18], "cumul": [6, 18], "approxim": [6, 10, 12, 13, 18, 28], "tanh": [6, 18], "estim": [6, 7, 18], "sqrt": [6, 7, 8, 18], "pi": [6, 18], "044715": [6, 18], "algorithm": 6, "binaryconstraint": [6, 8, 10, 11, 18, 20, 24, 25], "whichtak": [6, 8, 10, 11, 18, 20, 24, 25], "output_scal": [6, 8, 10, 11, 18, 20, 21, 24, 25, 28], "grad_input_scal": [6, 8, 10, 11, 18, 20, 24, 25, 28], "constrain": [6, 8, 9, 10, 11, 12, 13, 18, 20, 21, 24, 25, 28], "usual": [6, 8, 10, 11, 18, 20, 24, 25, 28], "necessari": [6, 8, 10, 11, 18, 20, 21, 23, 24, 25, 28], "valid": [6, 8, 10, 11, 18, 20, 21, 24, 25, 28], "normalized_shap": [7, 19], "ep": [7, 19], "1e": [7, 19, 28], "05": [7, 19, 28], "elementwise_affin": 7, "layer": [7, 8, 9, 10, 12, 13, 19, 23, 28], "normal": [7, 19, 28], "mathrm": 7, "var": 7, "epsilon": 7, "gamma": 7, "beta": [7, 20, 21], "deviat": [7, 28], "calcul": 7, "d": [7, 20, 28], "affin": 7, "transform": [7, 8, 12, 13, 20, 24, 27, 28], "via": [7, 28], "bias": 7, "unbias": 7, "unlik": [7, 28], "bia": [7, 8, 19, 20, 28], "entir": [7, 28], "plane": 7, "statist": 7, "data": [7, 8, 20, 25], "both": [7, 21, 28], "mode": 7, "_shape": 7, "ldot": 7, "integ": 7, "treat": [7, 11], "singleton": 7, "specif": 7, "denomin": 7, "numer": [7, 28], "stabil": 7, "boolean": 7, "nlp": 7, "sentence_length": 7, "embed": [7, 12, 26, 27], "layer_norm": [7, 26], "three": [7, 21], "spatial": 7, "shown": [7, 28], "in_featur": 8, "out_featur": 8, "incom": [8, 20], "tensorfloat32": [8, 20, 21], "On": [8, 21], "certain": [8, 19, 21], "rocm": [8, 21], "float16": [8, 21], "addit": [8, 11, 20, 28], "_featur": [8, 20], "h_": 8, "includ": [8, 20], "30": 8, "128": 8, "print": [8, 28], "hidden_s": [9, 10, 12, 13], "head": [9, 12, 13], "dropout_p": [9, 12, 13], "multi": 9, "self": [9, 28], "attent": [9, 12, 13, 27], "here": [9, 12, 13, 27, 28], "like": [9, 12, 13, 28], "give": [9, 12, 13, 28], "incorrect": [9, 12, 13], "hidden": [9, 10, 12, 13], "post": [9, 12, 13], "dropout": [9, 12, 13, 26], "take": [9, 12, 13, 21, 24, 28], "grad": [9, 12, 13, 24, 28], "act_fn": [10, 12, 13], "gelu": [10, 12, 13, 26, 28], "expansion_factor": 10, "": [10, 20, 21, 28], "intermedi": 10, "increas": 10, "rel": [10, 12, 13, 22, 23], "so": [11, 25, 28], "lie": [11, 25], "multipli": [11, 21, 28], "li": 11, "therein": 11, "adjust": 11, "accordingli": 11, "defin": [11, 25, 28], "x_i": [11, 25], "sum_j": [11, 25], "x_j": [11, 25], "unspecifi": 11, "inf": 11, "along": [11, 25, 28], "slice": [11, 25], "vocab_s": 12, "tau": [12, 13, 22, 23, 28], "decod": 12, "just": [12, 28], "demonstr": 12, "lack": 12, "kei": [12, 26, 27], "causal": [12, 27], "mask": [12, 27], "usag": 12, "infer": 12, "token": 12, "vocabulari": 12, "residu": [12, 13, 22, 23, 28], "branch": [12, 13, 22, 23, 28], "skip": [12, 13, 22, 23, 28], "connect": [12, 13, 22, 23, 28], "prenorm": 13, "arxiv": 13, "org": 13, "ab": 13, "2002": 13, "04745": 13, "crossentropyloss": [15, 26, 28], "predict": 15, "section": 15, "divid": 15, "randint": 15, "int64": 15, "dictionaryand": 17, "row": 17, "equal": [17, 23, 28], "maximum": 17, "column": 17, "modifi": 17, "point": [17, 28], "v": 17, "embedding_matrix": 17, "rand": 17, "8490": 17, "9625": 17, "6753": 17, "9666": 17, "7761": 17, "6108": 17, "6246": 17, "9751": 17, "3618": 17, "4161": 17, "2419": 17, "7383": 17, "0237": 17, "7794": 17, "0528": 17, "3385": 17, "8612": 17, "1867": 17, "zero_": 17, "5609": 17, "5384": 17, "8720": 17, "6262": 17, "2438": 17, "7471": 17, "wise": [18, 24], "param": 18, "sequenc": 19, "layernorm": [19, 26], "xa": 20, "b": [20, 21], "layout": [20, 21], "autograd": [20, 21], "pleas": [20, 21], "open": [20, 21], "request": [20, 21, 27], "left": [21, 28], "right": 21, "tupl": [21, 23, 28], "product": 21, "behavior": 21, "prepend": 21, "purpos": [21, 28], "after": 21, "remov": [21, 28], "least": 21, "one": [21, 28], "append": [21, 28], "broadcast": 21, "thu": [21, 28], "must": [21, 28], "j": 21, "other": [21, 28], "logic": 21, "determin": [21, 28], "even": [21, 28], "though": [21, 28], "final": 21, "In": [21, 28], "particular": [21, 28], "mm": 21, "union": 21, "left_grad_scal": 21, "right_grad_scal": 21, "order": [21, 23, 28], "atupl": 21, "expectedthat": 21, "isprovid": 21, "add": [22, 28], "togeth": [22, 28], "conjunct": [22, 23, 28], "residual_split": [22, 26, 28], "come": 22, "result": [22, 23], "split": 23, "prior": 23, "residual_add": [23, 26, 28], "delai": [23, 28], "normalis": 23, "typic": [23, 28], "kwarg": 24, "re": [25, 28], "desir": [25, 28], "cast": 25, "befor": [25, 28], "overflow": [25, 28], "_alpha_": [26, 28], "welcom": 26, "design": [26, 28], "facilit": 26, "method": [26, 27, 28], "outlin": [26, 28], "icml": [26, 28], "new": [26, 28], "start": [26, 28], "our": [26, 28], "guid": 26, "high": 26, "level": [26, 28], "overview": [26, 28], "simpl": [26, 28], "fp16": [26, 28], "fp8": [26, 28], "what": 26, "how": 26, "model": [26, 27], "consider": 26, "optimis": 26, "develop": [26, 27, 28], "licens": 26, "limit": 26, "api": [26, 28], "refer": [26, 28], "mhsa": 26, "mlp": [26, 28], "transformerdecod": 26, "transformerlay": 26, "cross_entropi": [26, 28], "matmul": 26, "scale_elementwis": 26, "stage": 27, "mani": [27, 28], "yet": [27, 28], "been": [27, 28], "roadmap": 27, "flash": 27, "interplai": 27, "investig": [27, 28], "op": [27, 28], "onc": 27, "exhaust": 27, "encourag": 27, "touch": 27, "To": 28, "git": 28, "com": 28, "clone": 28, "fork": 28, "repo": 28, "instruct": 28, "paradigm": 28, "deep": 28, "aim": 28, "involv": 28, "term": 28, "unprincipl": 28, "wai": 28, "ensur": 28, "now": 28, "preserv": 28, "As": 28, "scratch": 28, "assumpt": 28, "advantag": 28, "great": 28, "perspect": 28, "roughli": 28, "headroom": 28, "grow": 28, "shrink": 28, "underflow": 28, "occur": 28, "becaus": 28, "although": 28, "drift": 28, "stai": 28, "within": 28, "test": 28, "far": 28, "smaller": 28, "effici": 28, "behaviour": 28, "dynam": 28, "slightli": 28, "experi": 28, "lead": 28, "decreas": 28, "faster": 28, "depth": 28, "treatment": 28, "approach": 28, "similar": 28, "motiv": 28, "keep": 28, "sens": 28, "understand": 28, "might": 28, "go": 28, "fp32": 28, "bf16": 28, "issu": 28, "repres": 28, "veri": 28, "larg": 28, "small": 28, "3e": 28, "38": 28, "45": 28, "e5": 28, "60": 28, "000": 28, "6e": 28, "e4": 28, "try": 28, "put": 28, "speed": 28, "most": 28, "discuss": 28, "scope": 28, "introduct": 28, "analys": 28, "next": 28, "step": 28, "present": 28, "analysi": 28, "tricki": 28, "tool": 28, "easi": 28, "util": 28, "analyse_modul": 28, "fx": 28, "line": 28, "breakdown": 28, "alongsid": 28, "unscaledmlp": 28, "def": 28, "__init__": 28, "super": 28, "linear_1": 28, "linear_2": 28, "deriv": 28, "8": 28, "requires_grad_": 28, "fed": 28, "fwd": 28, "bwd": 28, "annotated_cod": 28, "204": 28, "linear_1_weight": 28, "018": 28, "83": 28, "linear_1_bia": 28, "84": 28, "_c": 28, "_nn": 28, "578": 28, "177": 28, "322": 28, "289": 28, "linear_2_weight": 28, "00902": 28, "48": 28, "linear_2_bia": 28, "00894": 28, "198": 28, "firstli": 28, "decompos": 28, "secondli": 28, "fwd_scale": 28, "bwd_scale": 28, "denot": 28, "sign": 28, "abov": 28, "receiv": 28, "These": 28, "enough": 28, "unscal": 28, "could": 28, "caus": 28, "signific": 28, "show": 28, "address": 28, "wrap": 28, "compil": 28, "correct": 28, "drop": 28, "scaledmlp": 28, "01": 28, "716": 28, "729": 28, "707": 28, "64": 28, "706": 28, "693": 28, "03": 28, "979": 28, "999": 28, "basic": 28, "avail": 28, "repeat": 28, "until": 28, "good": 28, "There": 28, "measur": 28, "someth": 28, "art": 28, "max": 28, "min": 28, "aris": 28, "seen": 28, "clearli": 28, "explod": 28, "clip": 28, "convers": 28, "tend": 28, "degrad": 28, "steadili": 28, "exactli": 28, "meet": 28, "practic": 28, "concern": 28, "significantli": 28, "merit": 28, "attain": 28, "best": 28, "fuse": 28, "divis": 28, "substanti": 28, "mechan": 28, "control": 28, "initialis": 28, "xavier": 28, "glorot": 28, "push": 28, "themselv": 28, "howev": 28, "solv": 28, "outsid": 28, "separ": 28, "altern": 28, "care": 28, "form": 28, "residuallay": 28, "contrast": 28, "down": 28, "through": 28, "domin": 28, "hyperparamet": 28, "abl": 28, "leav": 28, "without": 28, "tune": 28, "emploi": 28, "trick": 28, "comprehens": 28, "introduc": 28, "produc": 28, "arriv": 28, "share": 28, "fan_in": 28, "fan_out": 28, "grad_weight_scal": 28, "grad_bias_scal": 28, "batch_siz": 28, "ideal": 28, "suppli": 28, "exact": 28, "geometr": 28, "compromis": 28, "don": 28, "why": 28, "tl": 28, "dr": 28, "extra": 28, "eager": 28, "trip": 28, "memori": 28, "fortun": 28, "hi": 28, "overhead": 28, "elimin": 28, "kernel": 28, "fusion": 28, "stack": 28, "answer": 28, "old": 28, "jit": 28, "script": 28, "convert": 28, "torchscript": 28, "program": 28, "directli": 28, "had": 28, "mix": 28, "rectifi": 28, "much": 28, "flexibl": 28, "theori": 28, "tutori": 28, "decor": 28, "unit_scaled_funct": 28, "unitscaledmodul": 28, "incur": 28, "naiv": 28, "benchmark": 28, "notebook": 28, "thorough": 28, "automat": 28, "block": 28, "speedup": 28, "bug": 28, "latest": 28, "fail": 28, "recent": 28, "upgrad": 28, "preview": 28, "nightli": 28, "build": 28}, "objects": {"": [[2, 0, 0, "-", "unit_scaling"]], "unit_scaling": [[3, 1, 1, "", "CrossEntropyLoss"], [4, 1, 1, "", "Dropout"], [5, 1, 1, "", "Embedding"], [6, 1, 1, "", "GELU"], [7, 1, 1, "", "LayerNorm"], [8, 1, 1, "", "Linear"], [9, 1, 1, "", "MHSA"], [10, 1, 1, "", "MLP"], [11, 1, 1, "", "Softmax"], [12, 1, 1, "", "TransformerDecoder"], [13, 1, 1, "", "TransformerLayer"], [14, 0, 0, "-", "functional"]], "unit_scaling.Embedding": [[5, 2, 1, "", "from_pretrained"], [5, 3, 1, "", "weight"]], "unit_scaling.LayerNorm": [[7, 3, 1, "", "bias"], [7, 3, 1, "", "weight"]], "unit_scaling.Linear": [[8, 3, 1, "", "bias"], [8, 3, 1, "", "weight"]], "unit_scaling.functional": [[15, 4, 1, "", "cross_entropy"], [16, 4, 1, "", "dropout"], [17, 4, 1, "", "embedding"], [18, 4, 1, "", "gelu"], [19, 4, 1, "", "layer_norm"], [20, 4, 1, "", "linear"], [21, 4, 1, "", "matmul"], [22, 4, 1, "", "residual_add"], [23, 4, 1, "", "residual_split"], [24, 4, 1, "", "scale_elementwise"], [25, 4, 1, "", "softmax"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "function", "Python function"]}, "titleterms": {"api": 0, "refer": 0, "unit": [1, 26, 28], "scale": [1, 26, 28], "develop": 1, "licens": 1, "unit_sc": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25], "crossentropyloss": 3, "dropout": [4, 16], "embed": [5, 17], "gelu": [6, 18], "layernorm": 7, "linear": [8, 20], "mhsa": 9, "mlp": 10, "softmax": [11, 25], "transformerdecod": 12, "transformerlay": 13, "function": [14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25], "cross_entropi": 15, "layer_norm": 19, "matmul": 21, "residual_add": 22, "residual_split": 23, "scale_elementwis": 24, "content": 26, "limit": 27, "user": 28, "guid": 28, "instal": 28, "what": 28, "i": 28, "how": 28, "model": 28, "kei": 28, "consider": 28, "optimis": 28}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"API Reference": [[0, "api-reference"]], "Unit Scaling": [[1, "unit-scaling"], [26, "unit-scaling"]], "Development": [[1, "development"]], "License": [[1, "license"]], "unit_scaling": [[2, "module-unit_scaling"]], "unit_scaling.CrossEntropyLoss": [[3, "unit-scaling-crossentropyloss"]], "unit_scaling.Dropout": [[4, "unit-scaling-dropout"]], "unit_scaling.Embedding": [[5, "unit-scaling-embedding"]], "unit_scaling.GELU": [[6, "unit-scaling-gelu"]], "unit_scaling.LayerNorm": [[7, "unit-scaling-layernorm"]], "unit_scaling.Linear": [[8, "unit-scaling-linear"]], "unit_scaling.MHSA": [[9, "unit-scaling-mhsa"]], "unit_scaling.MLP": [[10, "unit-scaling-mlp"]], "unit_scaling.Softmax": [[11, "unit-scaling-softmax"]], "unit_scaling.TransformerDecoder": [[12, "unit-scaling-transformerdecoder"]], "unit_scaling.TransformerLayer": [[13, "unit-scaling-transformerlayer"]], "unit_scaling.functional": [[14, "module-unit_scaling.functional"]], "unit_scaling.functional.cross_entropy": [[15, "unit-scaling-functional-cross-entropy"]], "unit_scaling.functional.dropout": [[16, "unit-scaling-functional-dropout"]], "unit_scaling.functional.embedding": [[17, "unit-scaling-functional-embedding"]], "unit_scaling.functional.gelu": [[18, "unit-scaling-functional-gelu"]], "unit_scaling.functional.layer_norm": [[19, "unit-scaling-functional-layer-norm"]], "unit_scaling.functional.linear": [[20, "unit-scaling-functional-linear"]], "unit_scaling.functional.matmul": [[21, "unit-scaling-functional-matmul"]], "unit_scaling.functional.residual_add": [[22, "unit-scaling-functional-residual-add"]], "unit_scaling.functional.residual_split": [[23, "unit-scaling-functional-residual-split"]], "unit_scaling.functional.scale_elementwise": [[24, "unit-scaling-functional-scale-elementwise"]], "unit_scaling.functional.softmax": [[25, "unit-scaling-functional-softmax"]], "Contents": [[26, null]], "Limitations": [[27, "limitations"]], "User Guide": [[28, "user-guide"]], "Installation": [[28, "installation"]], "What is unit scaling?": [[28, "what-is-unit-scaling"]], "How to unit-scale a model": [[28, "how-to-unit-scale-a-model"]], "Key considerations for unit scaling": [[28, "key-considerations-for-unit-scaling"]], "Optimising unit-scaled models": [[28, "optimising-unit-scaled-models"]]}, "indexentries": {"module": [[2, "module-unit_scaling"], [14, "module-unit_scaling.functional"]], "unit_scaling": [[2, "module-unit_scaling"]], "crossentropyloss (class in unit_scaling)": [[3, "unit_scaling.CrossEntropyLoss"]], "dropout (class in unit_scaling)": [[4, "unit_scaling.Dropout"]], "embedding (class in unit_scaling)": [[5, "unit_scaling.Embedding"]], "from_pretrained() (unit_scaling.embedding class method)": [[5, "unit_scaling.Embedding.from_pretrained"]], "weight (unit_scaling.embedding attribute)": [[5, "unit_scaling.Embedding.weight"]], "gelu (class in unit_scaling)": [[6, "unit_scaling.GELU"]], "layernorm (class in unit_scaling)": [[7, "unit_scaling.LayerNorm"]], "bias (unit_scaling.layernorm attribute)": [[7, "unit_scaling.LayerNorm.bias"]], "weight (unit_scaling.layernorm attribute)": [[7, "unit_scaling.LayerNorm.weight"]], "linear (class in unit_scaling)": [[8, "unit_scaling.Linear"]], "bias (unit_scaling.linear attribute)": [[8, "unit_scaling.Linear.bias"]], "weight (unit_scaling.linear attribute)": [[8, "unit_scaling.Linear.weight"]], "mhsa (class in unit_scaling)": [[9, "unit_scaling.MHSA"]], "mlp (class in unit_scaling)": [[10, "unit_scaling.MLP"]], "softmax (class in unit_scaling)": [[11, "unit_scaling.Softmax"]], "transformerdecoder (class in unit_scaling)": [[12, "unit_scaling.TransformerDecoder"]], "transformerlayer (class in unit_scaling)": [[13, "unit_scaling.TransformerLayer"]], "unit_scaling.functional": [[14, "module-unit_scaling.functional"]], "cross_entropy() (in module unit_scaling.functional)": [[15, "unit_scaling.functional.cross_entropy"]], "dropout() (in module unit_scaling.functional)": [[16, "unit_scaling.functional.dropout"]], "embedding() (in module unit_scaling.functional)": [[17, "unit_scaling.functional.embedding"]], "gelu() (in module unit_scaling.functional)": [[18, "unit_scaling.functional.gelu"]], "layer_norm() (in module unit_scaling.functional)": [[19, "unit_scaling.functional.layer_norm"]], "linear() (in module unit_scaling.functional)": [[20, "unit_scaling.functional.linear"]], "matmul() (in module unit_scaling.functional)": [[21, "unit_scaling.functional.matmul"]], "residual_add() (in module unit_scaling.functional)": [[22, "unit_scaling.functional.residual_add"]], "residual_split() (in module unit_scaling.functional)": [[23, "unit_scaling.functional.residual_split"]], "scale_elementwise() (in module unit_scaling.functional)": [[24, "unit_scaling.functional.scale_elementwise"]], "softmax() (in module unit_scaling.functional)": [[25, "unit_scaling.functional.softmax"]]}})