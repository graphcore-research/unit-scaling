Search.setIndex({"docnames": ["generated/unit_scaling", "generated/unit_scaling.constraints", "generated/unit_scaling.constraints.amean", "generated/unit_scaling.constraints.gmean", "generated/unit_scaling.constraints.hmean", "generated/unit_scaling.constraints.to_grad_input_scale", "generated/unit_scaling.constraints.to_left_grad_scale", "generated/unit_scaling.constraints.to_output_scale", "generated/unit_scaling.constraints.to_right_grad_scale", "generated/unit_scaling.functional", "generated/unit_scaling.functional.dropout", "generated/unit_scaling.functional.gelu", "generated/unit_scaling.functional.linear", "generated/unit_scaling.functional.matmul", "generated/unit_scaling.functional.scale_elementwise", "generated/unit_scaling.functional.softmax", "generated/unit_scaling.modules", "generated/unit_scaling.modules.Dropout", "generated/unit_scaling.modules.GELU", "generated/unit_scaling.modules.Linear", "generated/unit_scaling.modules.MHSA", "generated/unit_scaling.modules.MLP", "generated/unit_scaling.modules.Softmax", "generated/unit_scaling.scale", "generated/unit_scaling.scale.scale_bwd", "generated/unit_scaling.scale.scale_fwd", "generated/unit_scaling.utils", "generated/unit_scaling.utils.ScalePair", "generated/unit_scaling.utils.ScaleTracker", "generated/unit_scaling.utils.ScaleTrackingInterpreter", "generated/unit_scaling.utils.analyse_module", "index"], "filenames": ["generated/unit_scaling.rst", "generated/unit_scaling.constraints.rst", "generated/unit_scaling.constraints.amean.rst", "generated/unit_scaling.constraints.gmean.rst", "generated/unit_scaling.constraints.hmean.rst", "generated/unit_scaling.constraints.to_grad_input_scale.rst", "generated/unit_scaling.constraints.to_left_grad_scale.rst", "generated/unit_scaling.constraints.to_output_scale.rst", "generated/unit_scaling.constraints.to_right_grad_scale.rst", "generated/unit_scaling.functional.rst", "generated/unit_scaling.functional.dropout.rst", "generated/unit_scaling.functional.gelu.rst", "generated/unit_scaling.functional.linear.rst", "generated/unit_scaling.functional.matmul.rst", "generated/unit_scaling.functional.scale_elementwise.rst", "generated/unit_scaling.functional.softmax.rst", "generated/unit_scaling.modules.rst", "generated/unit_scaling.modules.Dropout.rst", "generated/unit_scaling.modules.GELU.rst", "generated/unit_scaling.modules.Linear.rst", "generated/unit_scaling.modules.MHSA.rst", "generated/unit_scaling.modules.MLP.rst", "generated/unit_scaling.modules.Softmax.rst", "generated/unit_scaling.scale.rst", "generated/unit_scaling.scale.scale_bwd.rst", "generated/unit_scaling.scale.scale_fwd.rst", "generated/unit_scaling.utils.rst", "generated/unit_scaling.utils.ScalePair.rst", "generated/unit_scaling.utils.ScaleTracker.rst", "generated/unit_scaling.utils.ScaleTrackingInterpreter.rst", "generated/unit_scaling.utils.analyse_module.rst", "index.rst"], "titles": ["unit_scaling", "unit_scaling.constraints", "unit_scaling.constraints.amean", "unit_scaling.constraints.gmean", "unit_scaling.constraints.hmean", "unit_scaling.constraints.to_grad_input_scale", "unit_scaling.constraints.to_left_grad_scale", "unit_scaling.constraints.to_output_scale", "unit_scaling.constraints.to_right_grad_scale", "unit_scaling.functional", "unit_scaling.functional.dropout", "unit_scaling.functional.gelu", "unit_scaling.functional.linear", "unit_scaling.functional.matmul", "unit_scaling.functional.scale_elementwise", "unit_scaling.functional.softmax", "unit_scaling.modules", "unit_scaling.modules.Dropout", "unit_scaling.modules.GELU", "unit_scaling.modules.Linear", "unit_scaling.modules.MHSA", "unit_scaling.modules.MLP", "unit_scaling.modules.Softmax", "unit_scaling.scale", "unit_scaling.scale.scale_bwd", "unit_scaling.scale.scale_fwd", "unit_scaling.utils", "unit_scaling.utils.ScalePair", "unit_scaling.utils.ScaleTracker", "unit_scaling.utils.ScaleTrackingInterpreter", "unit_scaling.utils.analyse_module", "Unit Scaling"], "terms": {"modul": [0, 13, 29, 30], "common": [1, 9, 16], "scale": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 26, 30], "us": [1, 4, 10, 13, 15, 17, 18, 19, 28, 29, 30, 31], "unit": [1, 3, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 26, 30], "oper": [1, 10, 12, 13, 15, 17, 23, 28, 30], "function": [1, 17, 18, 19, 20, 21, 22, 23, 26, 28, 29, 30], "float": [2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 24, 25, 27, 29], "sourc": [2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 24, 25, 27, 28, 29, 30, 31], "comput": [2, 3, 4, 15, 17, 22, 28], "arithmet": 2, "mean": [2, 3, 4, 12, 17, 18, 19, 22], "provid": [2, 3, 4, 5, 6, 7, 8, 11, 12, 13, 14, 15, 18, 19, 20, 21, 22], "paramet": [2, 3, 4, 5, 6, 7, 8, 10, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 24, 25, 29, 30], "group": [2, 3, 4], "constrain": [2, 3, 4, 11, 12, 13, 14, 15, 18, 19, 20, 21, 22], "return": [2, 3, 4, 5, 6, 7, 8, 11, 12, 13, 14, 15, 18, 19, 20, 21, 22, 24, 25, 28, 29, 30], "type": [2, 3, 4, 5, 6, 7, 8, 11, 12, 13, 14, 15, 18, 19, 20, 21, 22, 24, 25, 29, 30], "geometr": 3, "recommend": [3, 31], "harmon": 4, "xavier": 4, "glorot": 4, "output_scal": [5, 6, 7, 8, 11, 12, 13, 14, 15, 18, 19, 21, 22], "grad_input_scal": [5, 7, 11, 12, 14, 15, 18, 19, 21, 22], "assum": [5, 6, 7, 8], "two": [5, 13], "select": [5, 6, 7, 8], "onli": [5, 6, 7, 8, 13, 24, 25, 28, 29], "chosen": [5, 6, 7, 8], "factor": [5, 6, 7, 8, 17, 21, 23, 24, 25], "op": [5, 6, 7, 8, 28, 29], "": [5, 6, 7, 8, 12, 13, 21, 28, 29, 30], "output": [5, 6, 7, 8, 12, 14, 17, 18, 19, 20, 22, 28, 29, 30], "input": [5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 24, 25, 28, 29, 30], "gradient": [5, 6, 7, 8, 11, 12, 13, 14, 15, 18, 19, 21, 22, 28], "equal": [5, 6, 7, 8], "left_grad_scal": [6, 8, 13], "right_grad_scal": [6, 8, 13], "three": [6, 8], "left": [6, 8, 13], "right": [6, 8, 13], "an": [7, 10, 13, 14, 17, 19, 21, 22, 27, 28, 29], "i": [7, 10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 28, 29, 31], "ani": [7, 12, 17, 18, 19, 20, 22, 28, 29, 30], "number": [7, 12, 18, 19, 20, 22], "grad": [7, 14, 20, 24, 25, 28], "version": [9, 13, 14, 16], "torch": [9, 11, 12, 13, 14, 15, 16, 17, 18, 19, 21, 22, 28, 30], "nn": [9, 16, 17, 18, 19, 21, 22, 28, 29, 30], "tensor": [10, 11, 12, 13, 14, 15, 17, 19, 22, 24, 25, 27, 28, 29, 30], "p": [10, 13, 17], "0": [10, 11, 15, 17, 18, 20, 22, 28, 30], "5": [10, 11, 17, 18], "train": [10, 17, 31], "bool": [10, 17, 19, 28, 29, 30], "true": [10, 17, 19, 28, 29, 30], "inplac": [10, 17, 28, 30], "fals": [10, 17, 19, 28, 30], "appli": [10, 11, 12, 13, 14, 15, 18, 19, 20, 21, 22, 24, 25, 28], "probabl": [10, 17, 20], "sampl": [10, 17, 19], "from": [10, 17, 19, 22, 28, 29, 30], "bernoulli": [10, 17], "distribut": [10, 11, 17, 18], "see": [10, 11, 15, 28, 29, 31], "detail": [10, 15, 28, 29, 31], "element": [10, 11, 14, 15, 17, 22], "zero": [10, 17, 28], "default": [10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 28, 30], "If": [10, 11, 12, 13, 14, 15, 17, 18, 19, 20, 21, 22, 28, 29, 31], "set": [10, 17, 19, 28, 31], "do": [10, 17, 28, 29], "thi": [10, 12, 13, 15, 17, 19, 28, 29, 31], "place": [10, 17, 28], "constraint": [11, 12, 13, 14, 15, 18, 19, 20, 21, 22, 29], "option": [11, 12, 13, 14, 15, 18, 19, 20, 21, 22, 27, 29, 30], "callabl": [11, 12, 13, 14, 15, 18, 19, 20, 21, 22, 29, 30], "gmean": [11, 12, 13, 14, 15, 18, 19, 20, 21, 22], "when": [11, 13, 18, 19, 22, 29], "approxim": [11, 18, 21], "argument": [11, 13, 18, 28, 29], "none": [11, 12, 13, 14, 15, 18, 19, 20, 21, 22, 27, 28, 29], "wise": [11, 14], "text": [11, 15, 18, 19, 22], "x": [11, 18, 28, 30], "phi": [11, 18], "where": [11, 12, 13, 18, 19, 22], "cumul": [11, 18], "gaussian": [11, 18], "tanh": [11, 18], "estim": [11, 18], "math": [11, 30], "1": [11, 13, 15, 17, 18, 19, 20, 22, 28, 30], "sqrt": [11, 18, 19], "2": [11, 12, 13, 17, 18, 22, 28, 30], "pi": [11, 18], "044715": [11, 18], "3": [11, 18, 22], "error": [11, 18, 28, 29], "linear": [11, 18, 30], "param": 11, "whichtak": [11, 12, 14, 15, 18, 19, 21, 22], "singl": [11, 12, 13, 14, 15, 18, 19, 20, 21, 22], "usual": [11, 12, 13, 14, 15, 18, 19, 21, 22], "necessari": [11, 12, 13, 14, 15, 18, 19, 21, 22, 28], "valid": [11, 12, 13, 14, 15, 18, 19, 21, 22], "binaryconstraint": [11, 12, 14, 15, 18, 19, 21, 22], "weight": [12, 19, 30], "bia": [12, 19, 30], "transform": [12, 14, 19], "incom": [12, 19], "data": [12, 15, 19, 29], "y": [12, 28], "xa": 12, "t": [12, 28], "b": [12, 28], "opper": 12, "support": [12, 13, 19, 28, 31], "d": [12, 28, 30], "spars": [12, 13, 22], "layout": [12, 13, 29], "beta": [12, 13], "featur": [12, 13, 17], "some": [12, 13], "dtype": [12, 13, 15, 19, 28, 29], "devic": [12, 13, 19, 29], "combin": [12, 13], "mai": [12, 13, 28], "have": [12, 13, 28], "autograd": [12, 13, 28], "you": [12, 13, 28], "notic": [12, 13, 31], "miss": [12, 13], "pleas": [12, 13], "open": [12, 13], "request": [12, 13], "tensorfloat32": [12, 13, 19], "shape": [12, 17, 18, 19, 22, 28], "_featur": [12, 19], "addit": [12, 19, 22], "dimens": [12, 13, 15, 18, 19, 20, 21, 22], "includ": [12, 19], "out": [12, 13, 17, 19, 28, 31], "base": [12, 28, 31], "A": [13, 15, 17, 20, 21, 22, 31], "matrix": 13, "product": 13, "The": [13, 19, 22, 28, 29], "behavior": 13, "depend": [13, 29], "dimension": [13, 22], "follow": [13, 14, 28], "both": [13, 30], "ar": [13, 17, 19, 22, 28], "dot": 13, "scalar": [13, 24, 25, 27], "first": [13, 14, 28, 29, 31], "second": 13, "prepend": 13, "its": [13, 14, 25, 28], "purpos": 13, "multipli": [13, 22], "after": [13, 28], "remov": 13, "vector": 13, "least": 13, "one": [13, 28], "n": [13, 22, 29], "batch": 13, "append": 13, "multipl": [13, 24, 25], "non": [13, 28], "e": [13, 22, 28, 29, 31], "broadcast": 13, "thu": 13, "must": [13, 28], "For": 13, "exampl": [13, 17, 18, 19, 22, 28, 29, 30], "j": 13, "time": [13, 31], "other": 13, "k": [13, 19], "note": [13, 28, 31], "logic": 13, "look": [13, 29], "determin": 13, "m": [13, 17, 18, 19, 22, 31], "even": 13, "though": 13, "final": 13, "differ": [13, 19, 23, 31], "ha": [13, 17, 28], "In": [13, 28], "particular": 13, "same": [13, 17, 18, 19, 22, 28], "restrict": 13, "mm": 13, "On": [13, 19], "certain": [13, 19, 29], "rocm": [13, 19], "float16": [13, 19], "precis": [13, 19, 31], "backward": [13, 19, 23, 24, 27, 28, 29, 30], "doe": 13, "which": [13, 15, 20, 21, 22, 29], "take": [13, 14, 20], "order": [13, 29], "f": 14, "should": [14, 22, 28, 29, 30], "arg": [14, 28, 29], "kwarg": [14, 28, 29], "dim": [15, 22], "int": [15, 19, 20, 21, 22, 28, 29], "defin": [15, 22, 28], "x_": [15, 22], "frac": [15, 17, 19, 22], "exp": [15, 22], "x_i": [15, 22], "sum_j": [15, 22], "x_j": [15, 22], "It": [15, 28], "all": [15, 19, 28], "slice": [15, 22, 29], "along": [15, 22], "re": 15, "them": [15, 22, 28, 29], "so": [15, 22, 28, 29], "lie": [15, 22], "rang": [15, 22], "sum": [15, 22], "more": [15, 28], "class": [15, 16, 17, 18, 19, 20, 21, 22, 26, 27, 28, 29, 30], "desir": 15, "specifi": 15, "cast": 15, "befor": [15, 28, 29], "perform": [15, 28], "prevent": [15, 17, 28], "overflow": 15, "implement": [17, 20, 21, 22, 30], "each": [17, 19, 28, 29, 30], "channel": 17, "independ": 17, "everi": [17, 22, 28, 29], "forward": [17, 23, 24, 25, 27, 28, 29, 30], "call": [17, 28, 29], "proven": 17, "effect": 17, "techniqu": 17, "regular": 17, "co": 17, "adapt": 17, "neuron": 17, "describ": 17, "paper": [17, 31], "improv": 17, "neural": 17, "network": 17, "detector": 17, "_": [17, 28], "furthermor": 17, "dure": [17, 28], "evalu": [17, 29], "simpli": 17, "ident": 17, "can": [17, 28, 29], "randn": [17, 18, 19, 22, 30], "20": [17, 19], "16": 17, "str": [18, 29, 30], "algorithm": 18, "in_featur": 19, "out_featur": 19, "size": [19, 20, 21], "layer": [19, 20, 21], "learn": 19, "learnabl": 19, "valu": [19, 22, 28, 29], "initi": 19, "mathcal": 19, "u": [19, 30], "h_": 19, "last": 19, "30": 19, "128": 19, "print": [19, 30], "hidden_s": [20, 21, 30], "head": 20, "dropout_p": 20, "multi": 20, "self": [20, 29, 30], "attent": 20, "hidden": [20, 21], "post": 20, "softmax": 20, "dropout": 20, "act_fn": 21, "gelu": 21, "expansion_factor": 21, "4": [21, 28, 30], "activ": [21, 31], "intermedi": [21, 29], "increas": [21, 28], "rel": 21, "standard": [22, 27, 28, 29, 30], "rescal": 22, "li": 22, "doc": [22, 31], "below": 22, "therein": 22, "g": [22, 28, 29, 31], "adjust": 22, "accordingli": 22, "unspecif": 22, "treat": 22, "inf": 22, "enabl": [23, 28, 31], "pass": [23, 24, 25, 27, 28, 29, 30], "unchang": 24, "origin": [25, 29], "develop": 26, "model": 26, "dataclass": 27, "contain": 27, "pair": 27, "intend": [27, 28], "repres": [27, 28, 29, 30], "deviat": [27, 28, 29, 30], "arbitrari": 27, "given": [28, 30], "record": [28, 29], "suppli": 28, "dict": [28, 29], "static": 28, "ctx": 28, "functionctx": 28, "tupl": [28, 29, 30], "formula": 28, "differenti": 28, "mode": 28, "automat": [28, 30], "alia": 28, "vjp": 28, "overridden": 28, "subclass": 28, "accept": 28, "context": 28, "mani": 28, "were": 28, "w": 28, "r": [28, 31], "correspond": 28, "requir": [28, 31], "just": [28, 29], "retriev": [28, 29], "save": [28, 31], "also": 28, "attribut": [28, 29], "needs_input_grad": 28, "boolean": 28, "whether": 28, "need": [28, 30], "jvp": 28, "grad_input": 28, "got": 28, "respect": 28, "object": 28, "mark_dirti": 28, "mark": 28, "modifi": 28, "most": 28, "onc": 28, "insid": 28, "method": [28, 29, 30], "been": 28, "ensur": 28, "correct": 28, "our": 28, "check": [28, 31], "doesn": 28, "matter": 28, "modif": 28, "staticmethod": 28, "def": [28, 30], "x_npy": 28, "numpi": 28, "share": 28, "storag": 28, "once_differenti": 28, "grad_output": 28, "requires_grad": 28, "doubl": 28, "clone": 28, "would": 28, "lead": 28, "wrong": 28, "engin": 28, "know": 28, "unless": 28, "we": [28, 29], "xdoctest": 28, "skip": 28, "runtimeerror": 28, "variabl": 28, "mark_non_differenti": 28, "effici": 28, "still": 28, "alwai": 28, "go": 28, "indic": 28, "sort": 28, "func": 28, "idx": 28, "save_for_backward": 28, "g1": 28, "g2": 28, "saved_tensor": 28, "zeros_lik": 28, "index_add_": 28, "futur": 28, "oppos": 28, "directli": 28, "incorrect": 28, "memori": 28, "leak": 28, "applic": 28, "hook": 28, "graph": [28, 29], "saved_tensors_hook": 28, "intermediari": 28, "neither": 28, "nor": 28, "your": [28, 31], "custom": 28, "decor": 28, "rais": 28, "like": 28, "either": 28, "recomput": 28, "tutori": 28, "access": 28, "through": [28, 29], "user": 28, "made": 28, "thei": 28, "weren": 28, "content": 28, "extend": 28, "how": 28, "z": 28, "grad_out": 28, "gx": 28, "gy": 28, "gz": 28, "c": [28, 31], "save_for_forward": 28, "x_t": 28, "y_t": 28, "fwad": 28, "dual_level": 28, "a_dual": 28, "make_du": 28, "set_materialize_grad": 28, "materi": 28, "undefin": 28, "expand": 28, "full": 28, "prior": 28, "simplefunc": 28, "No": 28, "handl": [28, 29], "now": 28, "induc": 28, "graphmodul": 29, "wrap": [29, 30], "fx": [29, 30], "than": 29, "execut": 29, "instrument": 29, "call_funct": 29, "target": 29, "union": 29, "node": 29, "result": 29, "semant": 29, "posit": 29, "invoc": 29, "keyword": 29, "compat": 29, "api": 29, "guarante": 29, "call_method": 29, "list": 29, "complex": 29, "memory_format": 29, "call_modul": 29, "fetch_args_kwargs_from_env": 29, "fetch": 29, "concret": 29, "current": 29, "environ": 29, "fetch_attr": 29, "hierarchi": 29, "fulli": 29, "qualfii": 29, "name": 29, "get_attr": 29, "Will": 29, "wa": 29, "map_nodes_to_valu": 29, "recurs": [29, 30], "descend": 29, "up": 29, "structur": 29, "within": 29, "belong": 29, "report": 29, "realli": 29, "referenc": 29, "placehold": 29, "To": 29, "being": 29, "tracer": 29, "extract": 29, "store": 29, "target_to_funct": 29, "run": [29, 31], "initial_env": 29, "enable_io_process": 29, "via": 29, "interpret": 29, "start": 29, "map": 29, "pre": [29, 31], "popul": 29, "partial": 29, "process": 29, "process_input": 29, "process_output": 29, "run_nod": 29, "specif": 29, "recurse_modul": 30, "syntax_highlight": 30, "autowrap_modul": 30, "built": 30, "einop": 30, "usr": 30, "local": 30, "lib": 30, "python3": [30, 31], "8": 30, "dist": 30, "packag": 30, "__init__": 30, "py": 30, "__w": 30, "autowrap_funct": 30, "dummi": 30, "gener": 30, "code": 30, "annot": 30, "analys": 30, "fed": 30, "analysi": 30, "toggl": 30, "behavour": 30, "moduletyp": 30, "python": [30, 31], "whose": 30, "without": 30, "string": 30, "reflect": 30, "mlp": 30, "super": 30, "fc1": 30, "relu": 30, "fc2": 30, "10": 30, "requires_grad_": 30, "bwd": 30, "236": 30, "fc1_weight": 30, "018": 30, "6": 30, "54": 30, "fc1_bia": 30, "0182": 30, "51": 30, "_c": 30, "_nn": 30, "578": 30, "204": 30, "337": 30, "288": 30, "fc2_weight": 30, "00902": 30, "13": 30, "fc2_bia": 30, "00904": 30, "31": 30, "linear_1": 30, "235": 30, "999": 30, "librari": 31, "pytorch": 31, "box": 31, "low": 31, "setup": 31, "venv": 31, "add": 31, "bin": 31, "path_to_poplar_sdk": 31, "ipu": 31, "pip": 31, "instal": 31, "wheel": 31, "poplar_sdk_en": 31, "poptorch": 31, "whl": 31, "dev": 31, "txt": 31, "subsequ": 31, "flight": 31, "help": 31, "command": 31, "id": 31, "intepret": 31, "format": 31, "consid": 31, "env": 31, "file": 31, "pythonpath": 31, "echo": 31, "pwd": 31, "path": 31, "devcontain": 31, "cd": 31, "make": 31, "html": 31, "view": 31, "_build": 31, "index": 31, "browser": 31, "copyright": 31, "2023": 31, "graphcor": 31, "ltd": 31, "under": 31, "mit": 31, "md": 31, "further": 31}, "objects": {"": [[0, 0, 0, "-", "unit_scaling"]], "unit_scaling": [[1, 0, 0, "-", "constraints"], [9, 0, 0, "-", "functional"], [16, 0, 0, "-", "modules"], [23, 0, 0, "-", "scale"], [26, 0, 0, "-", "utils"]], "unit_scaling.constraints": [[2, 1, 1, "", "amean"], [3, 1, 1, "", "gmean"], [4, 1, 1, "", "hmean"], [5, 1, 1, "", "to_grad_input_scale"], [6, 1, 1, "", "to_left_grad_scale"], [7, 1, 1, "", "to_output_scale"], [8, 1, 1, "", "to_right_grad_scale"]], "unit_scaling.functional": [[10, 1, 1, "", "dropout"], [11, 1, 1, "", "gelu"], [12, 1, 1, "", "linear"], [13, 1, 1, "", "matmul"], [14, 1, 1, "", "scale_elementwise"], [15, 1, 1, "", "softmax"]], "unit_scaling.modules": [[17, 2, 1, "", "Dropout"], [18, 2, 1, "", "GELU"], [19, 2, 1, "", "Linear"], [20, 2, 1, "", "MHSA"], [21, 2, 1, "", "MLP"], [22, 2, 1, "", "Softmax"]], "unit_scaling.modules.Linear": [[19, 3, 1, "", "bias"], [19, 3, 1, "", "weight"]], "unit_scaling.scale": [[24, 1, 1, "", "scale_bwd"], [25, 1, 1, "", "scale_fwd"]], "unit_scaling.utils": [[27, 2, 1, "", "ScalePair"], [28, 2, 1, "", "ScaleTracker"], [29, 2, 1, "", "ScaleTrackingInterpreter"], [30, 1, 1, "", "analyse_module"]], "unit_scaling.utils.ScaleTracker": [[28, 4, 1, "", "backward"], [28, 4, 1, "", "jvp"], [28, 4, 1, "", "mark_dirty"], [28, 4, 1, "", "mark_non_differentiable"], [28, 4, 1, "", "save_for_backward"], [28, 4, 1, "", "save_for_forward"], [28, 4, 1, "", "set_materialize_grads"], [28, 4, 1, "", "vjp"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[29, 4, 1, "", "call_function"], [29, 4, 1, "", "call_method"], [29, 4, 1, "", "call_module"], [29, 4, 1, "", "fetch_args_kwargs_from_env"], [29, 4, 1, "", "fetch_attr"], [29, 4, 1, "", "get_attr"], [29, 4, 1, "", "map_nodes_to_values"], [29, 4, 1, "", "output"], [29, 4, 1, "", "placeholder"], [29, 4, 1, "", "run"], [29, 4, 1, "", "run_node"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:attribute", "4": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "method", "Python method"]}, "titleterms": {"unit_sc": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30], "constraint": [1, 2, 3, 4, 5, 6, 7, 8], "amean": 2, "gmean": 3, "hmean": 4, "to_grad_input_scal": 5, "to_left_grad_scal": 6, "to_output_scal": 7, "to_right_grad_scal": 8, "function": [9, 10, 11, 12, 13, 14, 15], "dropout": [10, 17], "gelu": [11, 18], "linear": [12, 19], "matmul": 13, "scale_elementwis": 14, "softmax": [15, 22], "modul": [16, 17, 18, 19, 20, 21, 22], "mhsa": 20, "mlp": 21, "scale": [23, 24, 25, 31], "scale_bwd": 24, "scale_fwd": 25, "util": [26, 27, 28, 29, 30], "scalepair": 27, "scaletrack": 28, "scaletrackinginterpret": 29, "analyse_modul": 30, "unit": 31, "develop": 31, "licens": 31, "api": 31}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"unit_scaling": [[0, "module-unit_scaling"]], "unit_scaling.constraints": [[1, "module-unit_scaling.constraints"]], "unit_scaling.constraints.amean": [[2, "unit-scaling-constraints-amean"]], "unit_scaling.constraints.gmean": [[3, "unit-scaling-constraints-gmean"]], "unit_scaling.constraints.hmean": [[4, "unit-scaling-constraints-hmean"]], "unit_scaling.constraints.to_grad_input_scale": [[5, "unit-scaling-constraints-to-grad-input-scale"]], "unit_scaling.constraints.to_left_grad_scale": [[6, "unit-scaling-constraints-to-left-grad-scale"]], "unit_scaling.constraints.to_output_scale": [[7, "unit-scaling-constraints-to-output-scale"]], "unit_scaling.constraints.to_right_grad_scale": [[8, "unit-scaling-constraints-to-right-grad-scale"]], "unit_scaling.functional": [[9, "module-unit_scaling.functional"]], "unit_scaling.functional.dropout": [[10, "unit-scaling-functional-dropout"]], "unit_scaling.functional.gelu": [[11, "unit-scaling-functional-gelu"]], "unit_scaling.functional.linear": [[12, "unit-scaling-functional-linear"]], "unit_scaling.functional.matmul": [[13, "unit-scaling-functional-matmul"]], "unit_scaling.functional.scale_elementwise": [[14, "unit-scaling-functional-scale-elementwise"]], "unit_scaling.functional.softmax": [[15, "unit-scaling-functional-softmax"]], "unit_scaling.modules": [[16, "module-unit_scaling.modules"]], "unit_scaling.modules.Dropout": [[17, "unit-scaling-modules-dropout"]], "unit_scaling.modules.GELU": [[18, "unit-scaling-modules-gelu"]], "unit_scaling.modules.Linear": [[19, "unit-scaling-modules-linear"]], "unit_scaling.modules.MHSA": [[20, "unit-scaling-modules-mhsa"]], "unit_scaling.modules.MLP": [[21, "unit-scaling-modules-mlp"]], "unit_scaling.modules.Softmax": [[22, "unit-scaling-modules-softmax"]], "unit_scaling.scale": [[23, "module-unit_scaling.scale"]], "unit_scaling.scale.scale_bwd": [[24, "unit-scaling-scale-scale-bwd"]], "unit_scaling.scale.scale_fwd": [[25, "unit-scaling-scale-scale-fwd"]], "unit_scaling.utils": [[26, "module-unit_scaling.utils"]], "unit_scaling.utils.ScalePair": [[27, "unit-scaling-utils-scalepair"]], "unit_scaling.utils.ScaleTracker": [[28, "unit-scaling-utils-scaletracker"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[29, "unit-scaling-utils-scaletrackinginterpreter"]], "unit_scaling.utils.analyse_module": [[30, "unit-scaling-utils-analyse-module"]], "Unit Scaling": [[31, "unit-scaling"]], "Development": [[31, "development"]], "License": [[31, "license"]], "API": [[31, "api"]]}, "indexentries": {"module": [[0, "module-unit_scaling"], [1, "module-unit_scaling.constraints"], [9, "module-unit_scaling.functional"], [16, "module-unit_scaling.modules"], [23, "module-unit_scaling.scale"], [26, "module-unit_scaling.utils"]], "unit_scaling": [[0, "module-unit_scaling"]], "unit_scaling.constraints": [[1, "module-unit_scaling.constraints"]], "amean() (in module unit_scaling.constraints)": [[2, "unit_scaling.constraints.amean"]], "gmean() (in module unit_scaling.constraints)": [[3, "unit_scaling.constraints.gmean"]], "hmean() (in module unit_scaling.constraints)": [[4, "unit_scaling.constraints.hmean"]], "to_grad_input_scale() (in module unit_scaling.constraints)": [[5, "unit_scaling.constraints.to_grad_input_scale"]], "to_left_grad_scale() (in module unit_scaling.constraints)": [[6, "unit_scaling.constraints.to_left_grad_scale"]], "to_output_scale() (in module unit_scaling.constraints)": [[7, "unit_scaling.constraints.to_output_scale"]], "to_right_grad_scale() (in module unit_scaling.constraints)": [[8, "unit_scaling.constraints.to_right_grad_scale"]], "unit_scaling.functional": [[9, "module-unit_scaling.functional"]], "dropout() (in module unit_scaling.functional)": [[10, "unit_scaling.functional.dropout"]], "gelu() (in module unit_scaling.functional)": [[11, "unit_scaling.functional.gelu"]], "linear() (in module unit_scaling.functional)": [[12, "unit_scaling.functional.linear"]], "matmul() (in module unit_scaling.functional)": [[13, "unit_scaling.functional.matmul"]], "scale_elementwise() (in module unit_scaling.functional)": [[14, "unit_scaling.functional.scale_elementwise"]], "softmax() (in module unit_scaling.functional)": [[15, "unit_scaling.functional.softmax"]], "unit_scaling.modules": [[16, "module-unit_scaling.modules"]], "dropout (class in unit_scaling.modules)": [[17, "unit_scaling.modules.Dropout"]], "gelu (class in unit_scaling.modules)": [[18, "unit_scaling.modules.GELU"]], "linear (class in unit_scaling.modules)": [[19, "unit_scaling.modules.Linear"]], "bias (unit_scaling.modules.linear attribute)": [[19, "unit_scaling.modules.Linear.bias"]], "weight (unit_scaling.modules.linear attribute)": [[19, "unit_scaling.modules.Linear.weight"]], "mhsa (class in unit_scaling.modules)": [[20, "unit_scaling.modules.MHSA"]], "mlp (class in unit_scaling.modules)": [[21, "unit_scaling.modules.MLP"]], "softmax (class in unit_scaling.modules)": [[22, "unit_scaling.modules.Softmax"]], "unit_scaling.scale": [[23, "module-unit_scaling.scale"]], "scale_bwd() (in module unit_scaling.scale)": [[24, "unit_scaling.scale.scale_bwd"]], "scale_fwd() (in module unit_scaling.scale)": [[25, "unit_scaling.scale.scale_fwd"]], "unit_scaling.utils": [[26, "module-unit_scaling.utils"]], "scalepair (class in unit_scaling.utils)": [[27, "unit_scaling.utils.ScalePair"]], "scaletracker (class in unit_scaling.utils)": [[28, "unit_scaling.utils.ScaleTracker"]], "backward() (unit_scaling.utils.scaletracker static method)": [[28, "unit_scaling.utils.ScaleTracker.backward"]], "jvp() (unit_scaling.utils.scaletracker static method)": [[28, "unit_scaling.utils.ScaleTracker.jvp"]], "mark_dirty() (unit_scaling.utils.scaletracker method)": [[28, "unit_scaling.utils.ScaleTracker.mark_dirty"]], "mark_non_differentiable() (unit_scaling.utils.scaletracker method)": [[28, "unit_scaling.utils.ScaleTracker.mark_non_differentiable"]], "save_for_backward() (unit_scaling.utils.scaletracker method)": [[28, "unit_scaling.utils.ScaleTracker.save_for_backward"]], "save_for_forward() (unit_scaling.utils.scaletracker method)": [[28, "unit_scaling.utils.ScaleTracker.save_for_forward"]], "set_materialize_grads() (unit_scaling.utils.scaletracker method)": [[28, "unit_scaling.utils.ScaleTracker.set_materialize_grads"]], "vjp() (unit_scaling.utils.scaletracker static method)": [[28, "unit_scaling.utils.ScaleTracker.vjp"]], "scaletrackinginterpreter (class in unit_scaling.utils)": [[29, "unit_scaling.utils.ScaleTrackingInterpreter"]], "call_function() (unit_scaling.utils.scaletrackinginterpreter method)": [[29, "unit_scaling.utils.ScaleTrackingInterpreter.call_function"]], "call_method() (unit_scaling.utils.scaletrackinginterpreter method)": [[29, "unit_scaling.utils.ScaleTrackingInterpreter.call_method"]], "call_module() (unit_scaling.utils.scaletrackinginterpreter method)": [[29, "unit_scaling.utils.ScaleTrackingInterpreter.call_module"]], "fetch_args_kwargs_from_env() (unit_scaling.utils.scaletrackinginterpreter method)": [[29, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_args_kwargs_from_env"]], "fetch_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[29, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_attr"]], "get_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[29, "unit_scaling.utils.ScaleTrackingInterpreter.get_attr"]], "map_nodes_to_values() (unit_scaling.utils.scaletrackinginterpreter method)": [[29, "unit_scaling.utils.ScaleTrackingInterpreter.map_nodes_to_values"]], "output() (unit_scaling.utils.scaletrackinginterpreter method)": [[29, "unit_scaling.utils.ScaleTrackingInterpreter.output"]], "placeholder() (unit_scaling.utils.scaletrackinginterpreter method)": [[29, "unit_scaling.utils.ScaleTrackingInterpreter.placeholder"]], "run() (unit_scaling.utils.scaletrackinginterpreter method)": [[29, "unit_scaling.utils.ScaleTrackingInterpreter.run"]], "run_node() (unit_scaling.utils.scaletrackinginterpreter method)": [[29, "unit_scaling.utils.ScaleTrackingInterpreter.run_node"]], "analyse_module() (in module unit_scaling.utils)": [[30, "unit_scaling.utils.analyse_module"]]}})