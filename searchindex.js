Search.setIndex({"docnames": ["generated/unit_scaling", "generated/unit_scaling.constraints", "generated/unit_scaling.constraints.amean", "generated/unit_scaling.constraints.gmean", "generated/unit_scaling.constraints.hmean", "generated/unit_scaling.constraints.to_grad_input_scale", "generated/unit_scaling.constraints.to_left_grad_scale", "generated/unit_scaling.constraints.to_output_scale", "generated/unit_scaling.constraints.to_right_grad_scale", "generated/unit_scaling.functional", "generated/unit_scaling.functional.dropout", "generated/unit_scaling.functional.gelu", "generated/unit_scaling.functional.layer_norm", "generated/unit_scaling.functional.linear", "generated/unit_scaling.functional.matmul", "generated/unit_scaling.functional.residual_add", "generated/unit_scaling.functional.residual_split", "generated/unit_scaling.functional.scale_elementwise", "generated/unit_scaling.functional.softmax", "generated/unit_scaling.modules", "generated/unit_scaling.modules.Dropout", "generated/unit_scaling.modules.GELU", "generated/unit_scaling.modules.LayerNorm", "generated/unit_scaling.modules.Linear", "generated/unit_scaling.modules.MHSA", "generated/unit_scaling.modules.MLP", "generated/unit_scaling.modules.Softmax", "generated/unit_scaling.modules.TransformerLayer", "generated/unit_scaling.scale", "generated/unit_scaling.scale.scale_bwd", "generated/unit_scaling.scale.scale_fwd", "generated/unit_scaling.utils", "generated/unit_scaling.utils.ScalePair", "generated/unit_scaling.utils.ScaleTracker", "generated/unit_scaling.utils.ScaleTrackingInterpreter", "generated/unit_scaling.utils.analyse_module", "index"], "filenames": ["generated/unit_scaling.rst", "generated/unit_scaling.constraints.rst", "generated/unit_scaling.constraints.amean.rst", "generated/unit_scaling.constraints.gmean.rst", "generated/unit_scaling.constraints.hmean.rst", "generated/unit_scaling.constraints.to_grad_input_scale.rst", "generated/unit_scaling.constraints.to_left_grad_scale.rst", "generated/unit_scaling.constraints.to_output_scale.rst", "generated/unit_scaling.constraints.to_right_grad_scale.rst", "generated/unit_scaling.functional.rst", "generated/unit_scaling.functional.dropout.rst", "generated/unit_scaling.functional.gelu.rst", "generated/unit_scaling.functional.layer_norm.rst", "generated/unit_scaling.functional.linear.rst", "generated/unit_scaling.functional.matmul.rst", "generated/unit_scaling.functional.residual_add.rst", "generated/unit_scaling.functional.residual_split.rst", "generated/unit_scaling.functional.scale_elementwise.rst", "generated/unit_scaling.functional.softmax.rst", "generated/unit_scaling.modules.rst", "generated/unit_scaling.modules.Dropout.rst", "generated/unit_scaling.modules.GELU.rst", "generated/unit_scaling.modules.LayerNorm.rst", "generated/unit_scaling.modules.Linear.rst", "generated/unit_scaling.modules.MHSA.rst", "generated/unit_scaling.modules.MLP.rst", "generated/unit_scaling.modules.Softmax.rst", "generated/unit_scaling.modules.TransformerLayer.rst", "generated/unit_scaling.scale.rst", "generated/unit_scaling.scale.scale_bwd.rst", "generated/unit_scaling.scale.scale_fwd.rst", "generated/unit_scaling.utils.rst", "generated/unit_scaling.utils.ScalePair.rst", "generated/unit_scaling.utils.ScaleTracker.rst", "generated/unit_scaling.utils.ScaleTrackingInterpreter.rst", "generated/unit_scaling.utils.analyse_module.rst", "index.rst"], "titles": ["unit_scaling", "unit_scaling.constraints", "unit_scaling.constraints.amean", "unit_scaling.constraints.gmean", "unit_scaling.constraints.hmean", "unit_scaling.constraints.to_grad_input_scale", "unit_scaling.constraints.to_left_grad_scale", "unit_scaling.constraints.to_output_scale", "unit_scaling.constraints.to_right_grad_scale", "unit_scaling.functional", "unit_scaling.functional.dropout", "unit_scaling.functional.gelu", "unit_scaling.functional.layer_norm", "unit_scaling.functional.linear", "unit_scaling.functional.matmul", "unit_scaling.functional.residual_add", "unit_scaling.functional.residual_split", "unit_scaling.functional.scale_elementwise", "unit_scaling.functional.softmax", "unit_scaling.modules", "unit_scaling.modules.Dropout", "unit_scaling.modules.GELU", "unit_scaling.modules.LayerNorm", "unit_scaling.modules.Linear", "unit_scaling.modules.MHSA", "unit_scaling.modules.MLP", "unit_scaling.modules.Softmax", "unit_scaling.modules.TransformerLayer", "unit_scaling.scale", "unit_scaling.scale.scale_bwd", "unit_scaling.scale.scale_fwd", "unit_scaling.utils", "unit_scaling.utils.ScalePair", "unit_scaling.utils.ScaleTracker", "unit_scaling.utils.ScaleTrackingInterpreter", "unit_scaling.utils.analyse_module", "Unit Scaling"], "terms": {"modul": [0, 14, 34, 35], "common": [1, 9, 19], "scale": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 31, 35], "us": [1, 4, 10, 14, 15, 16, 18, 20, 21, 22, 23, 33, 34, 35, 36], "unit": [1, 3, 9, 10, 11, 12, 13, 14, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 31, 35], "oper": [1, 10, 13, 14, 18, 20, 28, 33, 35], "function": [1, 20, 21, 23, 24, 25, 26, 27, 28, 31, 33, 34, 35], "float": [2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 32, 34], "sourc": [2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 32, 33, 34, 35, 36], "comput": [2, 3, 4, 18, 20, 22, 26, 33], "arithmet": 2, "mean": [2, 3, 4, 13, 20, 21, 22, 23, 26], "provid": [2, 3, 4, 5, 6, 7, 8, 11, 13, 14, 17, 18, 21, 23, 24, 25, 26], "paramet": [2, 3, 4, 5, 6, 7, 8, 10, 13, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 34, 35], "group": [2, 3, 4], "constrain": [2, 3, 4, 11, 13, 14, 17, 18, 21, 23, 24, 25, 26], "return": [2, 3, 4, 5, 6, 7, 8, 11, 13, 14, 15, 16, 17, 18, 21, 23, 24, 25, 26, 29, 30, 33, 34, 35], "type": [2, 3, 4, 5, 6, 7, 8, 11, 13, 14, 15, 16, 17, 18, 21, 23, 24, 25, 26, 27, 29, 30, 34, 35], "geometr": 3, "recommend": [3, 36], "harmon": 4, "xavier": 4, "glorot": 4, "output_scal": [5, 6, 7, 8, 11, 13, 14, 17, 18, 21, 23, 25, 26], "grad_input_scal": [5, 7, 11, 13, 17, 18, 21, 23, 25, 26], "assum": [5, 6, 7, 8], "two": [5, 14, 16], "select": [5, 6, 7, 8], "onli": [5, 6, 7, 8, 14, 29, 30, 33, 34], "chosen": [5, 6, 7, 8], "factor": [5, 6, 7, 8, 20, 25, 28, 29, 30], "op": [5, 6, 7, 8, 33, 34], "": [5, 6, 7, 8, 13, 14, 25, 33, 34, 35], "output": [5, 6, 7, 8, 13, 17, 20, 21, 22, 23, 24, 26, 33, 34, 35], "input": [5, 6, 7, 8, 10, 11, 12, 13, 14, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 27, 29, 30, 33, 34, 35], "gradient": [5, 6, 7, 8, 11, 13, 14, 16, 17, 18, 21, 23, 25, 26, 33], "equal": [5, 6, 7, 8, 16], "left_grad_scal": [6, 8, 14], "right_grad_scal": [6, 8, 14], "three": [6, 8, 22], "left": [6, 8, 14], "right": [6, 8, 14], "an": [7, 10, 14, 16, 17, 20, 22, 23, 25, 26, 32, 33, 34], "i": [7, 10, 11, 13, 14, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 33, 34, 36], "ani": [7, 13, 20, 21, 23, 24, 26, 33, 34, 35], "number": [7, 12, 13, 21, 23, 24, 26, 27], "grad": [7, 17, 24, 29, 30, 33], "version": [9, 14, 17, 19], "torch": [9, 11, 13, 14, 17, 18, 19, 20, 21, 22, 23, 25, 26, 27, 33, 35], "nn": [9, 19, 20, 21, 22, 23, 25, 26, 27, 33, 34, 35], "tensor": [10, 11, 12, 13, 14, 15, 16, 17, 18, 20, 23, 26, 29, 30, 32, 33, 34, 35], "p": [10, 14, 20], "0": [10, 11, 15, 16, 18, 20, 21, 22, 24, 26, 27, 33, 35], "5": [10, 11, 20, 21, 22], "train": [10, 20, 22, 36], "bool": [10, 20, 22, 23, 33, 34, 35], "true": [10, 20, 22, 23, 33, 34, 35], "inplac": [10, 20, 33, 35], "fals": [10, 20, 22, 23, 33, 35], "appli": [10, 11, 12, 13, 14, 15, 16, 17, 18, 21, 22, 23, 24, 25, 26, 29, 30, 33], "probabl": [10, 20, 24, 27], "sampl": [10, 20, 23], "from": [10, 20, 22, 23, 26, 33, 34, 35], "bernoulli": [10, 20], "distribut": [10, 11, 20, 21], "see": [10, 11, 12, 18, 27, 33, 34, 36], "detail": [10, 12, 18, 33, 34, 36], "element": [10, 11, 17, 18, 20, 22, 26], "zero": [10, 20, 22, 33], "default": [10, 11, 13, 14, 15, 16, 17, 18, 20, 21, 22, 23, 24, 25, 26, 27, 33, 35], "If": [10, 11, 13, 14, 17, 18, 20, 21, 22, 23, 24, 25, 26, 33, 34, 36], "set": [10, 20, 22, 23, 33, 36], "do": [10, 20, 33, 34], "thi": [10, 13, 14, 16, 18, 20, 22, 23, 33, 34, 36], "place": [10, 20, 33], "constraint": [11, 13, 14, 17, 18, 21, 23, 24, 25, 26, 27, 34], "option": [11, 12, 13, 14, 15, 16, 17, 18, 21, 22, 23, 24, 25, 26, 27, 32, 34, 35], "callabl": [11, 13, 14, 17, 18, 21, 23, 24, 25, 26, 27, 34, 35], "gmean": [11, 13, 14, 17, 18, 21, 23, 24, 25, 26, 27], "when": [11, 14, 21, 22, 23, 26, 34], "approxim": [11, 21, 25, 27], "argument": [11, 14, 21, 33, 34], "none": [11, 12, 13, 14, 17, 18, 21, 22, 23, 24, 25, 26, 27, 32, 33, 34], "wise": [11, 17], "text": [11, 18, 21, 22, 23, 26], "x": [11, 21, 22, 33, 35], "phi": [11, 21], "where": [11, 13, 14, 21, 22, 23, 26], "cumul": [11, 21], "gaussian": [11, 21], "tanh": [11, 21], "estim": [11, 21, 22], "math": [11, 35], "1": [11, 14, 18, 20, 21, 22, 23, 24, 26, 27, 33, 35], "sqrt": [11, 21, 22, 23], "2": [11, 13, 14, 15, 16, 20, 21, 22, 26, 27, 33, 35], "pi": [11, 21], "044715": [11, 21], "3": [11, 21, 22, 26], "error": [11, 21, 33, 34], "linear": [11, 21, 35], "param": 11, "whichtak": [11, 13, 17, 18, 21, 23, 25, 26], "singl": [11, 13, 14, 17, 18, 21, 22, 23, 24, 25, 26], "usual": [11, 13, 14, 17, 18, 21, 23, 25, 26], "necessari": [11, 13, 14, 16, 17, 18, 21, 23, 25, 26, 33], "valid": [11, 13, 14, 17, 18, 21, 23, 25, 26], "binaryconstraint": [11, 13, 17, 18, 21, 23, 25, 26], "normalized_shap": [12, 22], "sequenc": 12, "int": [12, 18, 22, 23, 24, 25, 26, 27, 33, 34], "weight": [12, 13, 15, 16, 22, 23, 27, 35], "bia": [12, 13, 22, 23, 35], "ep": [12, 22], "1e": [12, 22], "05": [12, 22], "layer": [12, 16, 22, 23, 24, 25, 27], "normal": [12, 22], "last": [12, 22, 23], "certain": [12, 14, 23, 34], "dimens": [12, 13, 14, 18, 21, 22, 23, 24, 25, 26, 27], "layernorm": 12, "transform": [13, 17, 22, 23, 27], "incom": [13, 23], "data": [13, 18, 22, 23, 34], "y": [13, 22, 33], "xa": 13, "t": [13, 33], "b": [13, 33], "opper": 13, "support": [13, 14, 23, 33, 36], "d": [13, 22, 33, 35], "spars": [13, 14, 26], "layout": [13, 14, 34], "beta": [13, 14, 22], "featur": [13, 14, 20], "some": [13, 14], "dtype": [13, 14, 18, 22, 23, 33, 34], "devic": [13, 14, 22, 23, 34], "combin": [13, 14, 15], "mai": [13, 14, 33], "have": [13, 14, 33], "autograd": [13, 14, 33], "you": [13, 14, 33], "notic": [13, 14, 36], "miss": [13, 14], "pleas": [13, 14], "open": [13, 14], "request": [13, 14], "tensorfloat32": [13, 14, 23], "shape": [13, 20, 21, 22, 23, 26, 33], "_featur": [13, 23], "addit": [13, 23, 26], "includ": [13, 23], "out": [13, 14, 15, 20, 23, 33, 36], "base": [13, 33, 36], "A": [14, 18, 20, 24, 25, 26, 27, 36], "matrix": 14, "product": 14, "The": [14, 16, 22, 23, 26, 33, 34], "behavior": 14, "depend": [14, 34], "dimension": [14, 22, 26], "follow": [14, 17, 33], "both": [14, 22, 35], "ar": [14, 16, 20, 22, 23, 26, 33], "dot": 14, "scalar": [14, 22, 29, 30, 32], "first": [14, 17, 33, 34, 36], "second": 14, "prepend": 14, "its": [14, 17, 30, 33], "purpos": 14, "multipli": [14, 26], "after": [14, 33], "remov": 14, "vector": 14, "least": 14, "one": [14, 33], "n": [14, 22, 26, 34], "batch": [14, 22], "append": 14, "multipl": [14, 29, 30], "non": [14, 33], "e": [14, 22, 26, 33, 34, 36], "broadcast": 14, "thu": 14, "must": [14, 33], "For": [14, 22], "exampl": [14, 20, 21, 22, 23, 26, 33, 34, 35], "j": 14, "time": [14, 22, 36], "other": 14, "k": [14, 23], "note": [14, 33, 36], "logic": 14, "look": [14, 34], "determin": 14, "m": [14, 20, 21, 23, 26, 36], "even": 14, "though": 14, "final": 14, "differ": [14, 23, 28, 36], "ha": [14, 20, 22, 33], "In": [14, 33], "particular": 14, "same": [14, 20, 21, 22, 23, 26, 33], "restrict": 14, "mm": 14, "On": [14, 23], "rocm": [14, 23], "float16": [14, 23], "precis": [14, 23, 36], "backward": [14, 16, 23, 28, 29, 32, 33, 34, 35], "doe": 14, "which": [14, 16, 18, 22, 24, 25, 26, 34], "take": [14, 17, 24], "order": [14, 16, 34], "residu": [15, 16, 27], "skip": [15, 16, 27, 33], "tau": [15, 16, 27], "add": [15, 36], "connect": [15, 16, 27], "togeth": 15, "rel": [15, 16, 25, 27], "branch": [15, 16, 27], "should": [15, 16, 17, 26, 33, 34, 35], "conjunct": [15, 16], "residual_split": 15, "come": 15, "result": [15, 16, 34], "tupl": [16, 33, 34, 35], "split": 16, "prior": [16, 33], "being": [16, 34], "residual_add": 16, "delai": 16, "pass": [16, 28, 29, 30, 32, 33, 34, 35], "still": [16, 33], "need": [16, 33, 35], "between": 16, "normalis": 16, "standard": [16, 22, 26, 32, 33, 34, 35], "network": [16, 20], "typic": 16, "f": 17, "arg": [17, 33, 34], "kwarg": [17, 33, 34], "dim": [18, 26], "defin": [18, 26, 33], "x_": [18, 26], "frac": [18, 20, 22, 23, 26], "exp": [18, 26], "x_i": [18, 26], "sum_j": [18, 26], "x_j": [18, 26], "It": [18, 33], "all": [18, 23, 33], "slice": [18, 26, 34], "along": [18, 26], "re": 18, "them": [18, 26, 33, 34], "so": [18, 26, 33, 34], "lie": [18, 26], "rang": [18, 26], "sum": [18, 26], "more": [18, 33], "class": [18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 31, 32, 33, 34, 35], "desir": 18, "specifi": 18, "cast": 18, "befor": [18, 33, 34], "perform": [18, 33], "prevent": [18, 20, 33], "overflow": 18, "implement": [20, 24, 25, 26, 27, 35], "each": [20, 22, 23, 33, 34, 35], "channel": [20, 22], "independ": 20, "everi": [20, 26, 33, 34], "forward": [20, 28, 29, 30, 32, 33, 34, 35], "call": [20, 33, 34], "proven": 20, "effect": 20, "techniqu": 20, "regular": 20, "co": 20, "adapt": 20, "neuron": 20, "describ": 20, "paper": [20, 22, 36], "improv": 20, "neural": 20, "detector": 20, "_": [20, 33], "furthermor": 20, "dure": [20, 33], "evalu": [20, 22, 34], "simpli": 20, "ident": 20, "can": [20, 33, 34], "randn": [20, 21, 22, 23, 26, 35], "20": [20, 22, 23], "16": 20, "str": [21, 34, 35], "algorithm": 21, "union": [22, 34], "list": [22, 34], "size": [22, 23, 24, 25, 27], "elementwise_affin": 22, "over": 22, "mini": 22, "mathrm": 22, "var": 22, "epsilon": 22, "gamma": 22, "deviat": [22, 32, 33, 34, 35], "calcul": 22, "learnabl": [22, 23], "affin": 22, "via": [22, 34], "bias": 22, "equival": 22, "unbias": 22, "unlik": 22, "instanc": 22, "entir": 22, "plane": 22, "per": 22, "statist": 22, "mode": [22, 33], "expect": 22, "_shape": 22, "ldot": 22, "integ": 22, "treat": [22, 26], "singleton": 22, "specif": [22, 34], "valu": [22, 23, 26, 33, 34], "ad": 22, "denomin": 22, "numer": 22, "stabil": 22, "boolean": [22, 33], "initi": [22, 23], "ones": 22, "nlp": 22, "sentence_length": 22, "embedding_dim": 22, "10": [22, 35], "embed": 22, "layer_norm": 22, "activ": [22, 25, 27, 36], "imag": 22, "c": [22, 33, 36], "h": 22, "w": [22, 33], "spatial": 22, "shown": 22, "below": [22, 26], "in_featur": 23, "out_featur": 23, "learn": 23, "mathcal": 23, "u": [23, 35], "h_": 23, "30": 23, "128": 23, "print": [23, 35], "hidden_s": [24, 25, 27, 35], "head": [24, 27], "dropout_p": [24, 27], "multi": 24, "self": [24, 34, 35], "attent": [24, 27], "hidden": [24, 25, 27], "post": [24, 27], "softmax": [24, 27], "dropout": [24, 27], "act_fn": [25, 27], "gelu": [25, 27], "expansion_factor": 25, "4": [25, 33, 35], "intermedi": [25, 34], "increas": [25, 33], "rescal": 26, "li": 26, "doc": [26, 36], "therein": 26, "g": [26, 33, 34, 36], "adjust": 26, "accordingli": 26, "unspecif": 26, "inf": 26, "prenorm": 27, "http": 27, "arxiv": 27, "org": 27, "ab": 27, "2002": 27, "04745": 27, "enabl": [28, 33, 36], "unchang": 29, "origin": [30, 34], "develop": 31, "model": 31, "dataclass": 32, "contain": 32, "pair": 32, "intend": [32, 33], "repres": [32, 33, 34, 35], "arbitrari": 32, "given": [33, 35], "record": [33, 34], "suppli": 33, "dict": [33, 34], "static": 33, "ctx": 33, "functionctx": 33, "formula": 33, "differenti": 33, "automat": [33, 35], "alia": 33, "vjp": 33, "overridden": 33, "subclass": 33, "accept": 33, "context": 33, "mani": 33, "were": 33, "r": [33, 36], "correspond": 33, "requir": [33, 36], "just": [33, 34], "retriev": [33, 34], "save": [33, 36], "also": 33, "attribut": [33, 34], "needs_input_grad": 33, "whether": 33, "jvp": 33, "grad_input": 33, "got": 33, "respect": 33, "object": 33, "mark_dirti": 33, "mark": 33, "modifi": 33, "most": 33, "onc": 33, "insid": 33, "method": [33, 34, 35], "been": 33, "ensur": 33, "correct": 33, "our": 33, "check": [33, 36], "doesn": 33, "matter": 33, "modif": 33, "staticmethod": 33, "def": [33, 35], "x_npy": 33, "numpi": 33, "share": 33, "storag": 33, "once_differenti": 33, "grad_output": 33, "requires_grad": 33, "doubl": 33, "clone": 33, "would": 33, "lead": 33, "wrong": 33, "engin": 33, "know": 33, "unless": 33, "we": [33, 34], "xdoctest": 33, "runtimeerror": 33, "variabl": 33, "mark_non_differenti": 33, "effici": 33, "alwai": 33, "go": 33, "indic": 33, "sort": 33, "func": 33, "idx": 33, "save_for_backward": 33, "g1": 33, "g2": 33, "saved_tensor": 33, "zeros_lik": 33, "index_add_": 33, "futur": 33, "oppos": 33, "directli": 33, "incorrect": 33, "memori": 33, "leak": 33, "applic": 33, "hook": 33, "graph": [33, 34], "saved_tensors_hook": 33, "intermediari": 33, "neither": 33, "nor": 33, "your": [33, 36], "custom": 33, "decor": 33, "rais": 33, "like": 33, "either": 33, "recomput": 33, "tutori": 33, "access": 33, "through": [33, 34], "user": 33, "made": 33, "thei": 33, "weren": 33, "content": 33, "extend": 33, "how": 33, "z": 33, "grad_out": 33, "gx": 33, "gy": 33, "gz": 33, "save_for_forward": 33, "x_t": 33, "y_t": 33, "fwad": 33, "dual_level": 33, "a_dual": 33, "make_du": 33, "set_materialize_grad": 33, "materi": 33, "undefin": 33, "expand": 33, "full": 33, "simplefunc": 33, "No": 33, "handl": [33, 34], "now": 33, "induc": 33, "graphmodul": 34, "wrap": [34, 35], "fx": [34, 35], "than": 34, "execut": 34, "instrument": 34, "call_funct": 34, "target": 34, "node": 34, "semant": 34, "posit": 34, "invoc": 34, "keyword": 34, "compat": 34, "api": 34, "guarante": 34, "call_method": 34, "complex": 34, "memory_format": 34, "call_modul": 34, "fetch_args_kwargs_from_env": 34, "fetch": 34, "concret": 34, "current": 34, "environ": 34, "fetch_attr": 34, "hierarchi": 34, "fulli": 34, "qualfii": 34, "name": 34, "get_attr": 34, "Will": 34, "wa": 34, "map_nodes_to_valu": 34, "recurs": [34, 35], "descend": 34, "up": 34, "structur": 34, "within": 34, "belong": 34, "report": 34, "realli": 34, "referenc": 34, "placehold": 34, "To": 34, "tracer": 34, "extract": 34, "store": 34, "target_to_funct": 34, "run": [34, 36], "initial_env": 34, "enable_io_process": 34, "interpret": 34, "start": 34, "map": 34, "pre": [34, 36], "popul": 34, "partial": 34, "process": 34, "process_input": 34, "process_output": 34, "run_nod": 34, "recurse_modul": 35, "syntax_highlight": 35, "autowrap_modul": 35, "built": 35, "einop": 35, "usr": 35, "local": 35, "lib": 35, "python3": [35, 36], "8": 35, "dist": 35, "packag": 35, "__init__": 35, "py": 35, "__w": 35, "autowrap_funct": 35, "dummi": 35, "gener": 35, "code": 35, "annot": 35, "analys": 35, "fed": 35, "analysi": 35, "toggl": 35, "behavour": 35, "moduletyp": 35, "python": [35, 36], "whose": 35, "without": 35, "string": 35, "reflect": 35, "mlp": 35, "super": 35, "fc1": 35, "relu": 35, "fc2": 35, "requires_grad_": 35, "bwd": 35, "236": 35, "fc1_weight": 35, "018": 35, "6": 35, "54": 35, "fc1_bia": 35, "0182": 35, "51": 35, "_c": 35, "_nn": 35, "578": 35, "204": 35, "337": 35, "288": 35, "fc2_weight": 35, "00902": 35, "13": 35, "fc2_bia": 35, "00904": 35, "31": 35, "linear_1": 35, "235": 35, "999": 35, "librari": 36, "pytorch": 36, "box": 36, "low": 36, "setup": 36, "venv": 36, "bin": 36, "path_to_poplar_sdk": 36, "ipu": 36, "pip": 36, "instal": 36, "wheel": 36, "poplar_sdk_en": 36, "poptorch": 36, "whl": 36, "dev": 36, "txt": 36, "subsequ": 36, "flight": 36, "help": 36, "command": 36, "id": 36, "intepret": 36, "format": 36, "consid": 36, "env": 36, "file": 36, "pythonpath": 36, "echo": 36, "pwd": 36, "path": 36, "devcontain": 36, "cd": 36, "make": 36, "html": 36, "view": 36, "_build": 36, "index": 36, "browser": 36, "copyright": 36, "2023": 36, "graphcor": 36, "ltd": 36, "under": 36, "mit": 36, "md": 36, "further": 36}, "objects": {"": [[0, 0, 0, "-", "unit_scaling"]], "unit_scaling": [[1, 0, 0, "-", "constraints"], [9, 0, 0, "-", "functional"], [19, 0, 0, "-", "modules"], [28, 0, 0, "-", "scale"], [31, 0, 0, "-", "utils"]], "unit_scaling.constraints": [[2, 1, 1, "", "amean"], [3, 1, 1, "", "gmean"], [4, 1, 1, "", "hmean"], [5, 1, 1, "", "to_grad_input_scale"], [6, 1, 1, "", "to_left_grad_scale"], [7, 1, 1, "", "to_output_scale"], [8, 1, 1, "", "to_right_grad_scale"]], "unit_scaling.functional": [[10, 1, 1, "", "dropout"], [11, 1, 1, "", "gelu"], [12, 1, 1, "", "layer_norm"], [13, 1, 1, "", "linear"], [14, 1, 1, "", "matmul"], [15, 1, 1, "", "residual_add"], [16, 1, 1, "", "residual_split"], [17, 1, 1, "", "scale_elementwise"], [18, 1, 1, "", "softmax"]], "unit_scaling.modules": [[20, 2, 1, "", "Dropout"], [21, 2, 1, "", "GELU"], [22, 2, 1, "", "LayerNorm"], [23, 2, 1, "", "Linear"], [24, 2, 1, "", "MHSA"], [25, 2, 1, "", "MLP"], [26, 2, 1, "", "Softmax"], [27, 2, 1, "", "TransformerLayer"]], "unit_scaling.modules.LayerNorm": [[22, 3, 1, "", "bias"], [22, 3, 1, "", "weight"]], "unit_scaling.modules.Linear": [[23, 3, 1, "", "bias"], [23, 3, 1, "", "weight"]], "unit_scaling.scale": [[29, 1, 1, "", "scale_bwd"], [30, 1, 1, "", "scale_fwd"]], "unit_scaling.utils": [[32, 2, 1, "", "ScalePair"], [33, 2, 1, "", "ScaleTracker"], [34, 2, 1, "", "ScaleTrackingInterpreter"], [35, 1, 1, "", "analyse_module"]], "unit_scaling.utils.ScaleTracker": [[33, 4, 1, "", "backward"], [33, 4, 1, "", "jvp"], [33, 4, 1, "", "mark_dirty"], [33, 4, 1, "", "mark_non_differentiable"], [33, 4, 1, "", "save_for_backward"], [33, 4, 1, "", "save_for_forward"], [33, 4, 1, "", "set_materialize_grads"], [33, 4, 1, "", "vjp"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[34, 4, 1, "", "call_function"], [34, 4, 1, "", "call_method"], [34, 4, 1, "", "call_module"], [34, 4, 1, "", "fetch_args_kwargs_from_env"], [34, 4, 1, "", "fetch_attr"], [34, 4, 1, "", "get_attr"], [34, 4, 1, "", "map_nodes_to_values"], [34, 4, 1, "", "output"], [34, 4, 1, "", "placeholder"], [34, 4, 1, "", "run"], [34, 4, 1, "", "run_node"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:attribute", "4": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "method", "Python method"]}, "titleterms": {"unit_sc": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35], "constraint": [1, 2, 3, 4, 5, 6, 7, 8], "amean": 2, "gmean": 3, "hmean": 4, "to_grad_input_scal": 5, "to_left_grad_scal": 6, "to_output_scal": 7, "to_right_grad_scal": 8, "function": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18], "dropout": [10, 20], "gelu": [11, 21], "layer_norm": 12, "linear": [13, 23], "matmul": 14, "residual_add": 15, "residual_split": 16, "scale_elementwis": 17, "softmax": [18, 26], "modul": [19, 20, 21, 22, 23, 24, 25, 26, 27], "layernorm": 22, "mhsa": 24, "mlp": 25, "transformerlay": 27, "scale": [28, 29, 30, 36], "scale_bwd": 29, "scale_fwd": 30, "util": [31, 32, 33, 34, 35], "scalepair": 32, "scaletrack": 33, "scaletrackinginterpret": 34, "analyse_modul": 35, "unit": 36, "develop": 36, "licens": 36, "api": 36}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"unit_scaling": [[0, "module-unit_scaling"]], "unit_scaling.constraints": [[1, "module-unit_scaling.constraints"]], "unit_scaling.constraints.amean": [[2, "unit-scaling-constraints-amean"]], "unit_scaling.constraints.gmean": [[3, "unit-scaling-constraints-gmean"]], "unit_scaling.constraints.hmean": [[4, "unit-scaling-constraints-hmean"]], "unit_scaling.constraints.to_grad_input_scale": [[5, "unit-scaling-constraints-to-grad-input-scale"]], "unit_scaling.constraints.to_left_grad_scale": [[6, "unit-scaling-constraints-to-left-grad-scale"]], "unit_scaling.constraints.to_output_scale": [[7, "unit-scaling-constraints-to-output-scale"]], "unit_scaling.constraints.to_right_grad_scale": [[8, "unit-scaling-constraints-to-right-grad-scale"]], "unit_scaling.functional": [[9, "module-unit_scaling.functional"]], "unit_scaling.functional.dropout": [[10, "unit-scaling-functional-dropout"]], "unit_scaling.functional.gelu": [[11, "unit-scaling-functional-gelu"]], "unit_scaling.functional.layer_norm": [[12, "unit-scaling-functional-layer-norm"]], "unit_scaling.functional.linear": [[13, "unit-scaling-functional-linear"]], "unit_scaling.functional.matmul": [[14, "unit-scaling-functional-matmul"]], "unit_scaling.functional.residual_add": [[15, "unit-scaling-functional-residual-add"]], "unit_scaling.functional.residual_split": [[16, "unit-scaling-functional-residual-split"]], "unit_scaling.functional.scale_elementwise": [[17, "unit-scaling-functional-scale-elementwise"]], "unit_scaling.functional.softmax": [[18, "unit-scaling-functional-softmax"]], "unit_scaling.modules": [[19, "module-unit_scaling.modules"]], "unit_scaling.modules.Dropout": [[20, "unit-scaling-modules-dropout"]], "unit_scaling.modules.GELU": [[21, "unit-scaling-modules-gelu"]], "unit_scaling.modules.LayerNorm": [[22, "unit-scaling-modules-layernorm"]], "unit_scaling.modules.Linear": [[23, "unit-scaling-modules-linear"]], "unit_scaling.modules.MHSA": [[24, "unit-scaling-modules-mhsa"]], "unit_scaling.modules.MLP": [[25, "unit-scaling-modules-mlp"]], "unit_scaling.modules.Softmax": [[26, "unit-scaling-modules-softmax"]], "unit_scaling.modules.TransformerLayer": [[27, "unit-scaling-modules-transformerlayer"]], "unit_scaling.scale": [[28, "module-unit_scaling.scale"]], "unit_scaling.scale.scale_bwd": [[29, "unit-scaling-scale-scale-bwd"]], "unit_scaling.scale.scale_fwd": [[30, "unit-scaling-scale-scale-fwd"]], "unit_scaling.utils": [[31, "module-unit_scaling.utils"]], "unit_scaling.utils.ScalePair": [[32, "unit-scaling-utils-scalepair"]], "unit_scaling.utils.ScaleTracker": [[33, "unit-scaling-utils-scaletracker"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[34, "unit-scaling-utils-scaletrackinginterpreter"]], "unit_scaling.utils.analyse_module": [[35, "unit-scaling-utils-analyse-module"]], "Unit Scaling": [[36, "unit-scaling"]], "Development": [[36, "development"]], "License": [[36, "license"]], "API": [[36, "api"]]}, "indexentries": {"module": [[0, "module-unit_scaling"], [1, "module-unit_scaling.constraints"], [9, "module-unit_scaling.functional"], [19, "module-unit_scaling.modules"], [28, "module-unit_scaling.scale"], [31, "module-unit_scaling.utils"]], "unit_scaling": [[0, "module-unit_scaling"]], "unit_scaling.constraints": [[1, "module-unit_scaling.constraints"]], "amean() (in module unit_scaling.constraints)": [[2, "unit_scaling.constraints.amean"]], "gmean() (in module unit_scaling.constraints)": [[3, "unit_scaling.constraints.gmean"]], "hmean() (in module unit_scaling.constraints)": [[4, "unit_scaling.constraints.hmean"]], "to_grad_input_scale() (in module unit_scaling.constraints)": [[5, "unit_scaling.constraints.to_grad_input_scale"]], "to_left_grad_scale() (in module unit_scaling.constraints)": [[6, "unit_scaling.constraints.to_left_grad_scale"]], "to_output_scale() (in module unit_scaling.constraints)": [[7, "unit_scaling.constraints.to_output_scale"]], "to_right_grad_scale() (in module unit_scaling.constraints)": [[8, "unit_scaling.constraints.to_right_grad_scale"]], "unit_scaling.functional": [[9, "module-unit_scaling.functional"]], "dropout() (in module unit_scaling.functional)": [[10, "unit_scaling.functional.dropout"]], "gelu() (in module unit_scaling.functional)": [[11, "unit_scaling.functional.gelu"]], "layer_norm() (in module unit_scaling.functional)": [[12, "unit_scaling.functional.layer_norm"]], "linear() (in module unit_scaling.functional)": [[13, "unit_scaling.functional.linear"]], "matmul() (in module unit_scaling.functional)": [[14, "unit_scaling.functional.matmul"]], "residual_add() (in module unit_scaling.functional)": [[15, "unit_scaling.functional.residual_add"]], "residual_split() (in module unit_scaling.functional)": [[16, "unit_scaling.functional.residual_split"]], "scale_elementwise() (in module unit_scaling.functional)": [[17, "unit_scaling.functional.scale_elementwise"]], "softmax() (in module unit_scaling.functional)": [[18, "unit_scaling.functional.softmax"]], "unit_scaling.modules": [[19, "module-unit_scaling.modules"]], "dropout (class in unit_scaling.modules)": [[20, "unit_scaling.modules.Dropout"]], "gelu (class in unit_scaling.modules)": [[21, "unit_scaling.modules.GELU"]], "layernorm (class in unit_scaling.modules)": [[22, "unit_scaling.modules.LayerNorm"]], "bias (unit_scaling.modules.layernorm attribute)": [[22, "unit_scaling.modules.LayerNorm.bias"]], "weight (unit_scaling.modules.layernorm attribute)": [[22, "unit_scaling.modules.LayerNorm.weight"]], "linear (class in unit_scaling.modules)": [[23, "unit_scaling.modules.Linear"]], "bias (unit_scaling.modules.linear attribute)": [[23, "unit_scaling.modules.Linear.bias"]], "weight (unit_scaling.modules.linear attribute)": [[23, "unit_scaling.modules.Linear.weight"]], "mhsa (class in unit_scaling.modules)": [[24, "unit_scaling.modules.MHSA"]], "mlp (class in unit_scaling.modules)": [[25, "unit_scaling.modules.MLP"]], "softmax (class in unit_scaling.modules)": [[26, "unit_scaling.modules.Softmax"]], "transformerlayer (class in unit_scaling.modules)": [[27, "unit_scaling.modules.TransformerLayer"]], "unit_scaling.scale": [[28, "module-unit_scaling.scale"]], "scale_bwd() (in module unit_scaling.scale)": [[29, "unit_scaling.scale.scale_bwd"]], "scale_fwd() (in module unit_scaling.scale)": [[30, "unit_scaling.scale.scale_fwd"]], "unit_scaling.utils": [[31, "module-unit_scaling.utils"]], "scalepair (class in unit_scaling.utils)": [[32, "unit_scaling.utils.ScalePair"]], "scaletracker (class in unit_scaling.utils)": [[33, "unit_scaling.utils.ScaleTracker"]], "backward() (unit_scaling.utils.scaletracker static method)": [[33, "unit_scaling.utils.ScaleTracker.backward"]], "jvp() (unit_scaling.utils.scaletracker static method)": [[33, "unit_scaling.utils.ScaleTracker.jvp"]], "mark_dirty() (unit_scaling.utils.scaletracker method)": [[33, "unit_scaling.utils.ScaleTracker.mark_dirty"]], "mark_non_differentiable() (unit_scaling.utils.scaletracker method)": [[33, "unit_scaling.utils.ScaleTracker.mark_non_differentiable"]], "save_for_backward() (unit_scaling.utils.scaletracker method)": [[33, "unit_scaling.utils.ScaleTracker.save_for_backward"]], "save_for_forward() (unit_scaling.utils.scaletracker method)": [[33, "unit_scaling.utils.ScaleTracker.save_for_forward"]], "set_materialize_grads() (unit_scaling.utils.scaletracker method)": [[33, "unit_scaling.utils.ScaleTracker.set_materialize_grads"]], "vjp() (unit_scaling.utils.scaletracker static method)": [[33, "unit_scaling.utils.ScaleTracker.vjp"]], "scaletrackinginterpreter (class in unit_scaling.utils)": [[34, "unit_scaling.utils.ScaleTrackingInterpreter"]], "call_function() (unit_scaling.utils.scaletrackinginterpreter method)": [[34, "unit_scaling.utils.ScaleTrackingInterpreter.call_function"]], "call_method() (unit_scaling.utils.scaletrackinginterpreter method)": [[34, "unit_scaling.utils.ScaleTrackingInterpreter.call_method"]], "call_module() (unit_scaling.utils.scaletrackinginterpreter method)": [[34, "unit_scaling.utils.ScaleTrackingInterpreter.call_module"]], "fetch_args_kwargs_from_env() (unit_scaling.utils.scaletrackinginterpreter method)": [[34, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_args_kwargs_from_env"]], "fetch_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[34, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_attr"]], "get_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[34, "unit_scaling.utils.ScaleTrackingInterpreter.get_attr"]], "map_nodes_to_values() (unit_scaling.utils.scaletrackinginterpreter method)": [[34, "unit_scaling.utils.ScaleTrackingInterpreter.map_nodes_to_values"]], "output() (unit_scaling.utils.scaletrackinginterpreter method)": [[34, "unit_scaling.utils.ScaleTrackingInterpreter.output"]], "placeholder() (unit_scaling.utils.scaletrackinginterpreter method)": [[34, "unit_scaling.utils.ScaleTrackingInterpreter.placeholder"]], "run() (unit_scaling.utils.scaletrackinginterpreter method)": [[34, "unit_scaling.utils.ScaleTrackingInterpreter.run"]], "run_node() (unit_scaling.utils.scaletrackinginterpreter method)": [[34, "unit_scaling.utils.ScaleTrackingInterpreter.run_node"]], "analyse_module() (in module unit_scaling.utils)": [[35, "unit_scaling.utils.analyse_module"]]}})