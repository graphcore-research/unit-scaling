Search.setIndex({"docnames": ["api_reference", "development", "generated/unit_scaling", "generated/unit_scaling.CrossEntropyLoss", "generated/unit_scaling.Dropout", "generated/unit_scaling.Embedding", "generated/unit_scaling.GELU", "generated/unit_scaling.LayerNorm", "generated/unit_scaling.Linear", "generated/unit_scaling.MHSA", "generated/unit_scaling.MLP", "generated/unit_scaling.Softmax", "generated/unit_scaling.TransformerDecoder", "generated/unit_scaling.TransformerLayer", "generated/unit_scaling.constraints", "generated/unit_scaling.constraints.amean", "generated/unit_scaling.constraints.apply_constraint", "generated/unit_scaling.constraints.gmean", "generated/unit_scaling.constraints.hmean", "generated/unit_scaling.constraints.to_grad_input_scale", "generated/unit_scaling.constraints.to_left_grad_scale", "generated/unit_scaling.constraints.to_output_scale", "generated/unit_scaling.constraints.to_right_grad_scale", "generated/unit_scaling.formats", "generated/unit_scaling.formats.FPFormat", "generated/unit_scaling.formats.format_to_tuple", "generated/unit_scaling.formats.tuple_to_format", "generated/unit_scaling.functional", "generated/unit_scaling.functional.add", "generated/unit_scaling.functional.cross_entropy", "generated/unit_scaling.functional.dropout", "generated/unit_scaling.functional.embedding", "generated/unit_scaling.functional.gelu", "generated/unit_scaling.functional.layer_norm", "generated/unit_scaling.functional.linear", "generated/unit_scaling.functional.matmul", "generated/unit_scaling.functional.residual_add", "generated/unit_scaling.functional.residual_split", "generated/unit_scaling.functional.scale_elementwise", "generated/unit_scaling.functional.scaled_dot_product_attention", "generated/unit_scaling.functional.softmax", "generated/unit_scaling.scale", "generated/unit_scaling.scale.scale_bwd", "generated/unit_scaling.scale.scale_fwd", "generated/unit_scaling.transforms", "generated/unit_scaling.transforms.simulate_format", "generated/unit_scaling.transforms.simulate_fp8", "generated/unit_scaling.transforms.unit_scale", "generated/unit_scaling.transforms.utils", "generated/unit_scaling.transforms.utils.apply_transform", "generated/unit_scaling.transforms.utils.patch_to_expand_modules", "generated/unit_scaling.transforms.utils.replace_node_with_function", "generated/unit_scaling.utils", "generated/unit_scaling.utils.ScalePair", "generated/unit_scaling.utils.ScaleTracker", "generated/unit_scaling.utils.ScaleTrackingInterpreter", "generated/unit_scaling.utils.analyse_module", "index", "limitations", "user_guide"], "filenames": ["api_reference.rst", "development.rst", "generated/unit_scaling.rst", "generated/unit_scaling.CrossEntropyLoss.rst", "generated/unit_scaling.Dropout.rst", "generated/unit_scaling.Embedding.rst", "generated/unit_scaling.GELU.rst", "generated/unit_scaling.LayerNorm.rst", "generated/unit_scaling.Linear.rst", "generated/unit_scaling.MHSA.rst", "generated/unit_scaling.MLP.rst", "generated/unit_scaling.Softmax.rst", "generated/unit_scaling.TransformerDecoder.rst", "generated/unit_scaling.TransformerLayer.rst", "generated/unit_scaling.constraints.rst", "generated/unit_scaling.constraints.amean.rst", "generated/unit_scaling.constraints.apply_constraint.rst", "generated/unit_scaling.constraints.gmean.rst", "generated/unit_scaling.constraints.hmean.rst", "generated/unit_scaling.constraints.to_grad_input_scale.rst", "generated/unit_scaling.constraints.to_left_grad_scale.rst", "generated/unit_scaling.constraints.to_output_scale.rst", "generated/unit_scaling.constraints.to_right_grad_scale.rst", "generated/unit_scaling.formats.rst", "generated/unit_scaling.formats.FPFormat.rst", "generated/unit_scaling.formats.format_to_tuple.rst", "generated/unit_scaling.formats.tuple_to_format.rst", "generated/unit_scaling.functional.rst", "generated/unit_scaling.functional.add.rst", "generated/unit_scaling.functional.cross_entropy.rst", "generated/unit_scaling.functional.dropout.rst", "generated/unit_scaling.functional.embedding.rst", "generated/unit_scaling.functional.gelu.rst", "generated/unit_scaling.functional.layer_norm.rst", "generated/unit_scaling.functional.linear.rst", "generated/unit_scaling.functional.matmul.rst", "generated/unit_scaling.functional.residual_add.rst", "generated/unit_scaling.functional.residual_split.rst", "generated/unit_scaling.functional.scale_elementwise.rst", "generated/unit_scaling.functional.scaled_dot_product_attention.rst", "generated/unit_scaling.functional.softmax.rst", "generated/unit_scaling.scale.rst", "generated/unit_scaling.scale.scale_bwd.rst", "generated/unit_scaling.scale.scale_fwd.rst", "generated/unit_scaling.transforms.rst", "generated/unit_scaling.transforms.simulate_format.rst", "generated/unit_scaling.transforms.simulate_fp8.rst", "generated/unit_scaling.transforms.unit_scale.rst", "generated/unit_scaling.transforms.utils.rst", "generated/unit_scaling.transforms.utils.apply_transform.rst", "generated/unit_scaling.transforms.utils.patch_to_expand_modules.rst", "generated/unit_scaling.transforms.utils.replace_node_with_function.rst", "generated/unit_scaling.utils.rst", "generated/unit_scaling.utils.ScalePair.rst", "generated/unit_scaling.utils.ScaleTracker.rst", "generated/unit_scaling.utils.ScaleTrackingInterpreter.rst", "generated/unit_scaling.utils.analyse_module.rst", "index.rst", "limitations.rst", "user_guide.rst"], "titles": ["<span class=\"section-number\">4. </span>API reference", "<span class=\"section-number\">2. </span>Unit Scaling", "<span class=\"section-number\">4.1. </span>unit_scaling", "<span class=\"section-number\">4.1.4. </span>unit_scaling.CrossEntropyLoss", "<span class=\"section-number\">4.1.5. </span>unit_scaling.Dropout", "<span class=\"section-number\">4.1.6. </span>unit_scaling.Embedding", "<span class=\"section-number\">4.1.1. </span>unit_scaling.GELU", "<span class=\"section-number\">4.1.7. </span>unit_scaling.LayerNorm", "<span class=\"section-number\">4.1.8. </span>unit_scaling.Linear", "<span class=\"section-number\">4.1.2. </span>unit_scaling.MHSA", "<span class=\"section-number\">4.1.3. </span>unit_scaling.MLP", "<span class=\"section-number\">4.1.9. </span>unit_scaling.Softmax", "<span class=\"section-number\">4.1.10. </span>unit_scaling.TransformerDecoder", "<span class=\"section-number\">4.1.11. </span>unit_scaling.TransformerLayer", "<span class=\"section-number\">4.2. </span>unit_scaling.constraints", "<span class=\"section-number\">4.2.1. </span>unit_scaling.constraints.amean", "<span class=\"section-number\">4.2.2. </span>unit_scaling.constraints.apply_constraint", "<span class=\"section-number\">4.2.3. </span>unit_scaling.constraints.gmean", "<span class=\"section-number\">4.2.4. </span>unit_scaling.constraints.hmean", "<span class=\"section-number\">4.2.5. </span>unit_scaling.constraints.to_grad_input_scale", "<span class=\"section-number\">4.2.6. </span>unit_scaling.constraints.to_left_grad_scale", "<span class=\"section-number\">4.2.7. </span>unit_scaling.constraints.to_output_scale", "<span class=\"section-number\">4.2.8. </span>unit_scaling.constraints.to_right_grad_scale", "<span class=\"section-number\">4.3. </span>unit_scaling.formats", "<span class=\"section-number\">4.3.3. </span>unit_scaling.formats.FPFormat", "<span class=\"section-number\">4.3.1. </span>unit_scaling.formats.format_to_tuple", "<span class=\"section-number\">4.3.2. </span>unit_scaling.formats.tuple_to_format", "<span class=\"section-number\">4.4. </span>unit_scaling.functional", "<span class=\"section-number\">4.4.1. </span>unit_scaling.functional.add", "<span class=\"section-number\">4.4.2. </span>unit_scaling.functional.cross_entropy", "<span class=\"section-number\">4.4.3. </span>unit_scaling.functional.dropout", "<span class=\"section-number\">4.4.4. </span>unit_scaling.functional.embedding", "<span class=\"section-number\">4.4.5. </span>unit_scaling.functional.gelu", "<span class=\"section-number\">4.4.6. </span>unit_scaling.functional.layer_norm", "<span class=\"section-number\">4.4.7. </span>unit_scaling.functional.linear", "<span class=\"section-number\">4.4.8. </span>unit_scaling.functional.matmul", "<span class=\"section-number\">4.4.9. </span>unit_scaling.functional.residual_add", "<span class=\"section-number\">4.4.10. </span>unit_scaling.functional.residual_split", "<span class=\"section-number\">4.4.11. </span>unit_scaling.functional.scale_elementwise", "<span class=\"section-number\">4.4.12. </span>unit_scaling.functional.scaled_dot_product_attention", "<span class=\"section-number\">4.4.13. </span>unit_scaling.functional.softmax", "<span class=\"section-number\">4.5. </span>unit_scaling.scale", "<span class=\"section-number\">4.5.1. </span>unit_scaling.scale.scale_bwd", "<span class=\"section-number\">4.5.2. </span>unit_scaling.scale.scale_fwd", "<span class=\"section-number\">4.6. </span>unit_scaling.transforms", "<span class=\"section-number\">4.6.1. </span>unit_scaling.transforms.simulate_format", "<span class=\"section-number\">4.6.2. </span>unit_scaling.transforms.simulate_fp8", "<span class=\"section-number\">4.6.3. </span>unit_scaling.transforms.unit_scale", "<span class=\"section-number\">4.7. </span>unit_scaling.transforms.utils", "<span class=\"section-number\">4.7.1. </span>unit_scaling.transforms.utils.apply_transform", "<span class=\"section-number\">4.7.2. </span>unit_scaling.transforms.utils.patch_to_expand_modules", "<span class=\"section-number\">4.7.3. </span>unit_scaling.transforms.utils.replace_node_with_function", "<span class=\"section-number\">4.8. </span>unit_scaling.utils", "<span class=\"section-number\">4.8.2. </span>unit_scaling.utils.ScalePair", "<span class=\"section-number\">4.8.3. </span>unit_scaling.utils.ScaleTracker", "<span class=\"section-number\">4.8.4. </span>unit_scaling.utils.ScaleTrackingInterpreter", "<span class=\"section-number\">4.8.1. </span>unit_scaling.utils.analyse_module", "Unit Scaling", "<span class=\"section-number\">3. </span>Limitations", "<span class=\"section-number\">1. </span>User guide"], "terms": {"unit": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 17, 28, 29, 30, 31, 32, 33, 34, 35, 37, 39, 40, 44, 45, 46, 47, 52, 56, 58], "scale": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 44, 45, 46, 47, 52, 56, 58], "i": [0, 3, 4, 5, 6, 7, 8, 11, 12, 16, 21, 29, 30, 31, 32, 34, 35, 36, 37, 39, 40, 45, 46, 47, 49, 50, 51, 54, 55, 57, 58], "implement": [0, 1, 4, 9, 10, 11, 12, 13, 39, 47, 49, 56, 57, 58, 59], "us": [0, 1, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16, 18, 24, 30, 31, 35, 36, 37, 39, 40, 44, 45, 46, 47, 49, 50, 54, 55, 56, 57, 59], "thin": 0, "wrapper": [0, 47, 49], "around": [0, 47, 49], "exist": [0, 47, 54, 59], "torch": [0, 2, 3, 4, 5, 6, 7, 8, 11, 28, 29, 31, 35, 39, 40, 44, 45, 46, 47, 49, 50, 54, 56, 59], "nn": [0, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 31, 45, 46, 47, 49, 50, 54, 55, 56, 59], "class": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 23, 24, 29, 40, 47, 52, 53, 54, 55, 56, 59], "function": [0, 2, 4, 6, 8, 9, 10, 11, 12, 13, 14, 16, 23, 41, 44, 45, 46, 47, 48, 49, 50, 51, 52, 54, 55, 56, 57, 58, 59], "document": [0, 1, 5, 11, 59], "also": [0, 3, 47, 54, 59], "inherit": 0, "from": [0, 4, 5, 7, 8, 11, 30, 45, 46, 47, 49, 54, 55, 56, 59], "standard": [0, 7, 11, 36, 37, 46, 47, 49, 53, 54, 55, 56, 59], "pytorch": [0, 1, 39, 47, 54, 59], "doc": [0, 1], "modif": [0, 54], "note": [0, 1, 3, 5, 12, 29, 31, 35, 39, 47, 49, 54, 59], "some": [0, 1, 3, 29, 34, 35, 39, 47, 57, 58, 59], "mai": [0, 1, 3, 34, 35, 37, 39, 47, 54, 57, 59], "longer": 0, "relev": 0, "ar": [0, 3, 4, 7, 8, 11, 29, 35, 37, 39, 45, 46, 47, 49, 54, 59], "nevertheless": 0, "The": [0, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 16, 24, 28, 29, 31, 32, 34, 35, 37, 38, 39, 40, 45, 46, 47, 49, 54, 55, 57, 58, 59], "built": [0, 56], "mirror": 0, "close": 0, "possibl": [0, 31, 59], "can": [0, 1, 3, 4, 5, 37, 39, 47, 50, 54, 55, 57, 59], "easili": 0, "swap": [0, 59], "out": [0, 1, 4, 8, 28, 34, 35, 36, 54, 57, 59], "equival": [0, 3, 5, 7, 39, 45, 46, 47, 56, 59], "For": [0, 1, 5, 7, 35, 36, 37, 39, 54, 57, 59], "code": [0, 56, 59], "which": [0, 3, 7, 10, 11, 37, 40, 45, 46, 47, 49, 50, 51, 54, 55, 59], "follow": [0, 1, 35, 38, 39, 50, 54, 57, 58, 59], "import": [0, 47, 58, 59], "f": [0, 29, 31, 38, 39, 59], "appli": [0, 3, 6, 7, 8, 9, 10, 11, 12, 13, 16, 28, 29, 30, 32, 33, 34, 35, 36, 37, 38, 39, 40, 42, 43, 47, 49, 50, 54, 59], "first": [0, 1, 5, 35, 38, 49, 54, 55, 59], "ad": [0, 7, 39, 59], "unit_sc": [0, 57, 59], "uu": [0, 59], "u": [0, 8, 47, 56, 59], "replac": [0, 47, 51, 59], "letter": 0, "those": [0, 3, 29, 45, 46, 57, 58, 59], "assum": [0, 19, 20, 21, 22, 39, 59], "thei": [0, 1, 47, 54, 57, 59], "support": [0, 1, 3, 4, 5, 6, 8, 28, 29, 30, 31, 34, 35, 39, 47, 49, 54, 58], "click": 0, "below": [0, 7, 11, 29, 59], "full": [0, 54, 59], "A": [1, 3, 4, 5, 9, 10, 11, 12, 13, 29, 31, 35, 39, 40, 57, 59], "librari": [1, 47, 57, 58, 59], "base": [1, 34, 39, 54, 59], "paper": [1, 4, 7, 47, 57, 59], "box": [1, 57, 59], "low": [1, 57, 59], "precis": [1, 8, 35, 39, 57, 59], "train": [1, 3, 4, 5, 7, 30, 31, 37, 57, 58, 59], "found": [1, 57, 59], "http": [1, 13, 57, 59], "graphcor": [1, 57, 59], "research": [1, 57, 59], "github": [1, 57, 59], "io": [1, 39], "thi": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 16, 24, 28, 30, 31, 32, 34, 35, 37, 38, 39, 40, 45, 46, 47, 49, 50, 54, 55, 57, 58, 59], "current": [1, 12, 39, 47, 49, 55, 57, 58, 59], "its": [1, 35, 38, 43, 51, 54, 57, 59], "beta": [1, 7, 34, 35, 39, 57, 59], "releas": [1, 57, 59], "featur": [1, 4, 34, 35, 57, 58, 59], "have": [1, 3, 5, 31, 34, 35, 37, 45, 46, 47, 54, 57, 58, 59], "yet": [1, 47, 57, 58, 59], "occasion": [1, 57, 59], "bug": [1, 57, 59], "present": [1, 51, 57, 59], "we": [1, 46, 47, 49, 54, 55, 57, 58, 59], "re": [1, 40, 57, 59], "keen": [1, 57, 59], "help": [1, 57, 59], "user": [1, 39, 45, 46, 47, 49, 50, 54, 57], "ani": [1, 4, 6, 8, 11, 21, 34, 39, 47, 49, 50, 51, 54, 55, 56, 57, 59], "problem": [1, 3, 57, 59], "encount": [1, 57, 59], "To": [1, 55, 57, 59], "run": [1, 39, 45, 46, 55, 57, 59], "pip": [1, 57, 59], "git": [1, 57, 59], "com": [1, 57, 59], "high": [1, 57], "level": [1, 57, 59], "introduct": [1, 59], "see": [1, 3, 5, 6, 8, 9, 10, 11, 12, 13, 28, 29, 30, 31, 32, 33, 34, 35, 38, 39, 40, 47, 54, 55, 57, 59], "our": [1, 47, 49, 54, 57, 59], "blog": [1, 57], "post": [1, 9, 12, 13, 57], "simpl": [1, 57], "fp16": [1, 57, 59], "fp8": [1, 46, 57, 59], "more": [1, 5, 31, 39, 40, 54, 58, 59], "depth": [1, 59], "explan": 1, "consult": 1, "And": 1, "practic": [1, 50, 59], "guid": [1, 47, 57], "who": [1, 57, 59], "wish": [1, 49, 50, 57, 59], "codebas": [1, 57, 59], "setup": 1, "requir": [1, 3, 39, 47, 54, 58, 59], "time": [1, 7, 28, 35, 59], "python3": [1, 56], "m": [1, 4, 6, 8, 11, 35, 45, 46, 47, 49], "venv": 1, "sourc": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 24, 25, 26, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 42, 43, 45, 46, 47, 49, 50, 51, 53, 54, 55, 56], "bin": 1, "activ": [1, 7, 10, 12, 13, 45, 59], "r": [1, 5, 31, 54], "dev": 1, "txt": 1, "Or": 1, "ipu": 1, "subsequ": 1, "pre": [1, 55, 59], "flight": 1, "check": [1, 54, 59], "command": 1, "id": 1, "recommend": [1, 17, 36, 37, 57, 59], "python": [1, 56], "intepret": 1, "set": [1, 3, 4, 7, 8, 29, 30, 39, 47, 54, 58, 59], "format": [1, 45, 46, 57, 59], "save": [1, 54], "enabl": [1, 39, 41, 47, 49, 54, 59], "consid": [1, 3, 59], "env": [1, 54], "file": 1, "pythonpath": 1, "exampl": [1, 3, 4, 5, 6, 7, 8, 11, 12, 28, 29, 31, 35, 39, 54, 55, 56, 59], "echo": 1, "pwd": 1, "differ": [1, 8, 35, 37, 39, 41, 49, 59], "path": 1, "devcontain": 1, "cd": 1, "make": [1, 39, 47, 49, 59], "html": 1, "view": 1, "_build": 1, "index": [1, 3, 5, 31, 54], "your": [1, 54, 59], "browser": 1, "copyright": 1, "c": [1, 3, 7, 28, 29, 39, 54], "2023": [1, 57, 59], "ltd": 1, "under": [1, 31], "mit": 1, "notic": [1, 34, 35], "md": 1, "further": [1, 59], "detail": [1, 5, 6, 8, 9, 10, 11, 12, 13, 28, 29, 30, 31, 32, 33, 34, 35, 38, 40, 47, 54, 55, 59], "version": [2, 35, 38, 47, 49, 50, 59], "common": [2, 14, 28, 59], "modul": [2, 4, 5, 7, 8, 10, 12, 13, 16, 31, 35, 44, 45, 46, 47, 49, 50, 55, 56, 59], "weight": [3, 5, 7, 8, 12, 13, 29, 31, 33, 34, 36, 37, 45, 47, 56, 59], "tensor": [3, 4, 5, 8, 11, 24, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 42, 43, 49, 53, 54, 55, 56, 59], "none": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 16, 28, 29, 31, 32, 33, 34, 35, 38, 39, 40, 51, 53, 54, 55, 56, 59], "size_averag": [3, 29], "ignore_index": [3, 29], "int": [3, 5, 7, 8, 9, 10, 11, 12, 13, 24, 25, 26, 28, 29, 31, 33, 40, 54, 55, 59], "100": [3, 29], "reduc": [3, 29, 45, 46], "reduct": [3, 29], "str": [3, 6, 8, 9, 10, 11, 12, 13, 16, 24, 28, 29, 32, 34, 35, 38, 40, 55, 56], "mean": [3, 4, 6, 7, 8, 11, 15, 17, 18, 29, 34, 59], "label_smooth": [3, 29], "float": [3, 4, 5, 7, 9, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 24, 28, 29, 30, 31, 33, 36, 37, 38, 39, 42, 43, 53, 55, 59], "0": [3, 4, 5, 6, 7, 11, 12, 13, 28, 29, 30, 31, 32, 36, 37, 39, 40, 54, 56, 59], "comput": [3, 4, 5, 7, 11, 15, 17, 18, 29, 31, 39, 40, 54, 59], "cross": [3, 29, 59], "entropi": [3, 29, 59], "loss": [3, 29, 59], "between": [3, 29, 37, 58, 59], "input": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 19, 20, 21, 22, 28, 29, 30, 31, 32, 33, 34, 35, 37, 38, 39, 40, 42, 43, 46, 47, 54, 55, 56, 59], "logit": [3, 29], "target": [3, 29, 51, 55, 59], "It": [3, 40, 54, 59], "when": [3, 6, 7, 8, 11, 29, 32, 35, 39, 45, 46, 50, 55, 59], "classif": 3, "If": [3, 4, 5, 7, 8, 29, 30, 31, 34, 35, 39, 40, 45, 46, 54, 55], "provid": [3, 15, 17, 18, 19, 20, 21, 22, 39, 47, 59], "option": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 16, 28, 31, 32, 34, 35, 36, 37, 38, 39, 40, 47, 49, 50, 51, 54, 55, 56], "argument": [3, 6, 32, 35, 54, 55, 59], "should": [3, 11, 29, 36, 37, 38, 39, 45, 46, 47, 49, 54, 55, 56, 59], "1d": 3, "assign": 3, "each": [3, 4, 5, 7, 8, 29, 31, 39, 45, 46, 54, 55, 56, 59], "particularli": [3, 59], "you": [3, 34, 35, 39, 54, 58, 59], "an": [3, 4, 5, 7, 8, 10, 11, 21, 30, 31, 35, 37, 38, 39, 45, 47, 53, 54, 55, 59], "unbalanc": 3, "expect": [3, 7, 45, 46, 59], "contain": [3, 5, 29, 31, 45, 46, 51, 53, 54, 59], "unnorm": [3, 29], "do": [3, 4, 5, 30, 31, 54, 55, 59], "need": [3, 37, 54, 56, 59], "posit": [3, 12, 55, 58], "sum": [3, 11, 29, 40], "1": [3, 4, 5, 6, 7, 8, 11, 28, 29, 31, 32, 35, 36, 37, 39, 40, 54, 56, 57, 59], "gener": [3, 24, 47, 56, 58, 59], "ha": [3, 4, 7, 16, 29, 35, 39, 47, 54, 58, 59], "size": [3, 5, 7, 8, 9, 10, 12, 13, 29, 31, 39, 54], "unbatch": 3, "minibatch": [3, 29], "d_1": [3, 29], "d_2": [3, 29], "d_k": [3, 29], "k": [3, 8, 29, 35, 39], "geq": [3, 29], "dimension": [3, 5, 7, 11, 29, 35], "case": [3, 6, 8, 9, 10, 11, 12, 13, 28, 29, 32, 34, 35, 38, 40, 47, 50, 59], "last": [3, 7, 8, 33], "being": [3, 5, 29, 37, 49, 54, 55], "higher": [3, 39], "dimens": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 33, 34, 35, 40, 54], "per": [3, 7, 29, 54], "pixel": 3, "2d": 3, "imag": [3, 7], "criterion": 3, "either": [3, 29, 54], "indic": [3, 5, 29, 31, 39, 54], "rang": [3, 11, 40, 45, 46, 47, 55, 59], "where": [3, 5, 6, 7, 8, 11, 29, 31, 32, 34, 35, 39, 45, 47, 59], "number": [3, 6, 8, 9, 11, 12, 13, 21, 24, 28, 29, 31, 33, 34, 59], "specifi": [3, 5, 29, 31, 39, 40, 54, 59], "accept": [3, 54], "necessarili": 3, "unreduc": 3, "e": [3, 5, 7, 31, 35, 36, 37, 39, 54], "describ": [3, 4, 29], "ell": 3, "x": [3, 6, 7, 24, 32, 47, 54, 56, 59], "y": [3, 7, 34, 54], "l": [3, 39], "l_1": 3, "dot": [3, 35, 39], "l_n": 3, "top": [3, 47], "quad": 3, "w_": 3, "y_n": 3, "log": [3, 59], "frac": [3, 4, 7, 8, 11, 40], "exp": [3, 11, 40], "x_": [3, 11, 40], "n": [3, 5, 7, 11, 29, 35, 39, 55], "sum_": 3, "cdot": 3, "mathbb": 3, "text": [3, 5, 6, 7, 8, 11, 28, 29, 32, 40], "ignor": [3, 29, 59], "_index": 3, "w": [3, 5, 7, 31, 54], "span": 3, "well": [3, 36, 37, 59], "default": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 28, 29, 30, 31, 32, 34, 35, 36, 37, 38, 39, 40, 47, 49, 50, 51, 54, 56, 59], "begin": [3, 29, 59], "end": [3, 29, 59], "combin": [3, 34, 35, 36, 59], "logsoftmax": 3, "nllloss": 3, "probabl": [3, 4, 9, 12, 13, 29, 30, 39], "label": 3, "beyond": [3, 59], "singl": [3, 7], "item": 3, "blend": 3, "smooth": [3, 29], "etc": 3, "w_c": 3, "y_": 3, "perform": [3, 39, 40, 54, 59], "better": [3, 47], "allow": [3, 37, 59], "optim": [3, 39, 49, 50], "onli": [3, 19, 20, 21, 22, 24, 29, 35, 42, 43, 45, 46, 49, 54, 55, 59], "too": [3, 39, 45, 46], "restrict": [3, 35], "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 28, 29, 30, 31, 34, 35, 36, 37, 38, 39, 40, 42, 43, 45, 46, 47, 49, 50, 51, 55, 56], "manual": [3, 29, 47, 59], "rescal": [3, 11, 29], "given": [3, 5, 24, 26, 29, 31, 39, 45, 46, 51, 54, 56, 59], "bool": [3, 4, 5, 7, 8, 29, 30, 31, 39, 51, 54, 55, 56], "deprec": [3, 29], "By": [3, 29, 47, 50, 59], "averag": [3, 29], "over": [3, 7, 29, 39, 47, 54, 59], "element": [3, 4, 7, 11, 29, 30, 32, 38, 39, 40], "batch": [3, 5, 7, 29, 31, 35], "multipl": [3, 29, 35, 42, 43, 59], "sampl": [3, 4, 5, 8, 29, 30, 31], "field": [3, 29], "fals": [3, 4, 5, 7, 8, 29, 30, 31, 39, 54, 56], "instead": [3, 29], "true": [3, 4, 5, 7, 8, 29, 30, 31, 39, 45, 46, 51, 54, 55, 56], "valu": [3, 5, 7, 8, 11, 24, 29, 36, 37, 39, 45, 46, 47, 54, 55, 59], "doe": [3, 5, 29, 35, 49, 50, 59], "contribut": [3, 5, 29, 31], "gradient": [3, 5, 6, 8, 9, 10, 11, 12, 13, 19, 20, 21, 22, 28, 29, 31, 32, 34, 35, 37, 38, 40, 45, 47, 54, 59], "non": [3, 5, 24, 29, 31, 35, 37, 54, 59], "applic": [3, 29, 54], "observ": [3, 29], "depend": [3, 29, 35, 39, 47, 55, 59], "return": [3, 11, 15, 16, 17, 18, 19, 20, 21, 22, 26, 29, 35, 36, 37, 38, 39, 40, 42, 43, 45, 46, 47, 49, 50, 54, 55, 56, 59], "output": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 19, 20, 21, 22, 28, 29, 31, 32, 34, 35, 38, 39, 40, 54, 55, 56, 59], "taken": [3, 59], "process": [3, 5, 29, 47, 55], "meantim": [3, 29], "two": [3, 19, 29, 35, 37, 39, 54, 59], "arg": [3, 29, 38, 51, 54, 55], "overrid": [3, 29, 54], "amount": [3, 29], "becom": [3, 29], "mixtur": [3, 29], "origin": [3, 29, 43, 55], "ground": [3, 29], "truth": [3, 29], "uniform": [3, 29], "distribut": [3, 4, 6, 29, 30, 32, 58, 59], "rethink": [3, 29], "incept": [3, 29], "architectur": [3, 29], "vision": [3, 29], "shape": [3, 4, 5, 6, 7, 8, 11, 28, 29, 31, 34, 39, 54], "same": [3, 4, 6, 7, 8, 11, 29, 35, 39, 45, 46, 54, 59], "otherwis": [3, 54], "scalar": [3, 7, 35, 42, 43, 53, 59], "align": [3, 29], "randn": [3, 4, 6, 7, 8, 11, 28, 29, 56, 59], "3": [3, 5, 6, 7, 11, 28, 29, 31, 32, 59], "5": [3, 4, 5, 6, 7, 12, 13, 28, 29, 30, 31, 32, 36, 37, 59], "requires_grad": [3, 5, 29, 54], "empti": 3, "dtype": [3, 5, 7, 8, 29, 34, 35, 39, 40, 54, 55], "long": 3, "random_": 3, "backward": [3, 8, 24, 29, 35, 37, 41, 42, 45, 46, 47, 53, 54, 55, 56, 59], "softmax": [3, 9, 12, 13, 29, 39, 57, 59], "dim": [3, 11, 29, 39, 40], "p": [4, 5, 30, 31, 35], "inplac": [4, 30, 54, 56], "bernoulli": [4, 30], "channel": [4, 7], "zero": [4, 5, 7, 30, 47, 54], "independ": [4, 47], "everi": [4, 11, 54, 55], "forward": [4, 24, 41, 42, 43, 45, 46, 47, 49, 50, 53, 54, 55, 56, 59], "call": [4, 39, 45, 46, 47, 49, 50, 51, 54, 55, 56], "proven": 4, "effect": [4, 45, 46, 59], "techniqu": [4, 57, 59], "regular": [4, 47], "prevent": [4, 40, 54], "co": 4, "adapt": [4, 59], "neuron": 4, "improv": [4, 39], "neural": 4, "network": 4, "detector": 4, "_": [4, 39, 54], "furthermor": 4, "factor": [4, 10, 19, 20, 21, 22, 37, 41, 42, 43, 47, 59], "dure": [4, 5, 31, 54, 59], "evalu": [4, 7, 55, 59], "simpli": [4, 59], "ident": [4, 59], "oper": [4, 14, 30, 34, 35, 39, 40, 41, 47, 54, 56, 59], "place": [4, 30, 31, 54, 59], "2": [4, 5, 6, 7, 11, 28, 31, 32, 34, 35, 39, 54, 56, 59], "20": [4, 7, 8, 28], "16": [4, 59], "num_embed": 5, "embedding_dim": [5, 7, 31], "padding_idx": [5, 31], "max_norm": [5, 31], "norm_typ": [5, 31], "scale_grad_by_freq": [5, 31], "spars": [5, 11, 31, 34, 35], "_weight": 5, "_freez": 5, "devic": [5, 7, 8, 34, 35, 39, 55], "lookup": [5, 31], "tabl": [5, 31], "look": [5, 31, 35, 55, 59], "up": [5, 31, 54, 55, 59], "fix": [5, 31, 59], "dictionari": [5, 47], "often": [5, 31, 59], "store": [5, 55], "word": [5, 31], "retriev": [5, 16, 31, 54, 55], "them": [5, 11, 40, 47, 54, 55], "list": [5, 7, 31, 49, 55, 58], "correspond": [5, 16, 26, 31, 47, 54], "vector": [5, 31, 35], "entri": [5, 31], "therefor": [5, 31], "updat": [5, 31, 59], "remain": [5, 31], "pad": [5, 31], "newli": 5, "construct": 5, "all": [5, 8, 39, 40, 47, 54, 59], "anoth": 5, "norm": [5, 31], "larger": [5, 31, 47, 59], "than": [5, 31, 39, 47, 55], "renorm": [5, 31], "invers": [5, 31], "frequenc": [5, 31], "mini": [5, 7, 31], "t": [5, 26, 31, 34, 47, 49, 50, 54, 59], "matrix": [5, 31, 35], "regard": [5, 31, 59], "learnabl": [5, 7, 8], "initi": [5, 7, 8, 59], "mathcal": [5, 8], "type": [5, 8, 12, 14, 15, 16, 17, 18, 19, 20, 21, 22, 28, 31, 32, 36, 37, 38, 39, 40, 42, 43, 45, 46, 47, 49, 50, 51, 55, 56], "inttensor": 5, "longtensor": [5, 31], "arbitrari": [5, 31, 47, 53, 58, 59], "extract": [5, 31, 55], "h": [5, 7], "_dim": 5, "10": [5, 7, 28, 31, 56, 59], "4": [5, 10, 28, 31, 54, 56, 57, 59], "9": [5, 31], "xdoctest": [5, 31, 54], "ignore_w": [5, 31], "determinist": [5, 31, 39], "0251": 5, "6902": 5, "7172": 5, "6431": 5, "0748": 5, "6969": 5, "4970": 5, "3448": 5, "9685": 5, "3677": 5, "7265": 5, "1685": 5, "4362": 5, "4004": 5, "9400": 5, "9124": 5, "3616": 5, "1151": 5, "0000": [5, 31], "1535": 5, "0309": 5, "9315": 5, "1655": 5, "9897": 5, "0635": 5, "chang": [5, 39, 59], "7895": 5, "7089": 5, "0364": 5, "6778": 5, "5803": 5, "2678": 5, "no_grad": 5, "ones": [5, 7, 39], "classmethod": 5, "from_pretrain": 5, "freez": 5, "creat": 5, "instanc": [5, 7], "floattensor": 5, "pass": [5, 24, 37, 39, 41, 42, 43, 45, 46, 47, 50, 53, 54, 55, 56, 59], "second": [5, 35, 54], "get": [5, 58, 59], "learn": [5, 8, 59], "pretrain": 5, "6": [5, 28, 56], "1000": 5, "3000": 5, "approxim": [6, 10, 12, 13, 32, 59], "constraint": [6, 8, 9, 10, 11, 12, 13, 28, 32, 34, 35, 38, 40, 55, 57, 59], "gmean": [6, 8, 9, 10, 11, 12, 13, 28, 32, 34, 35, 38, 40, 57, 59], "gaussian": [6, 32], "error": [6, 32, 39, 54, 55], "linear": [6, 32, 45, 46, 56, 57, 59], "phi": [6, 32], "cumul": [6, 32], "tanh": [6, 32], "estim": [6, 7, 32], "sqrt": [6, 7, 8, 32, 39], "pi": [6, 32], "044715": [6, 32], "algorithm": [6, 39], "name": [6, 8, 9, 10, 11, 12, 13, 16, 28, 32, 34, 35, 38, 40, 55], "In": [6, 8, 9, 10, 11, 12, 13, 28, 32, 34, 35, 37, 38, 39, 40, 47, 50, 54, 59], "must": [6, 8, 9, 10, 11, 12, 13, 16, 28, 32, 34, 35, 38, 40, 54, 59], "one": [6, 8, 9, 10, 11, 12, 13, 16, 28, 32, 34, 35, 38, 39, 40, 54, 59], "hmean": [6, 8, 9, 10, 11, 12, 13, 28, 32, 34, 35, 38, 40, 57], "amean": [6, 8, 9, 10, 11, 12, 13, 28, 32, 34, 35, 38, 40, 57], "to_output_scal": [6, 8, 9, 10, 11, 12, 13, 28, 32, 34, 35, 38, 40, 57], "to_grad_input_scal": [6, 8, 10, 11, 32, 34, 38, 40, 57], "normalized_shap": [7, 33], "ep": [7, 33], "1e": [7, 33, 59], "05": [7, 33, 59], "elementwise_affin": 7, "layer": [7, 8, 9, 10, 12, 13, 33, 36, 37, 47, 59], "normal": [7, 24, 33, 59], "mathrm": 7, "var": 7, "epsilon": 7, "gamma": 7, "deviat": [7, 53, 54, 55, 56, 59], "calcul": 7, "d": [7, 34, 54, 56, 59], "affin": 7, "transform": [7, 8, 12, 13, 34, 36, 37, 38, 57, 58, 59], "via": [7, 47, 55, 59], "bias": [7, 47], "unbias": 7, "unlik": [7, 59], "bia": [7, 8, 33, 34, 56, 59], "entir": [7, 59], "plane": 7, "statist": 7, "data": [7, 8, 34, 40, 55], "both": [7, 35, 39, 54, 56, 59], "mode": [7, 54], "_shape": 7, "ldot": 7, "integ": [7, 28, 54], "treat": [7, 11], "singleton": 7, "specif": [7, 39, 45, 46, 55], "denomin": 7, "numer": [7, 44, 45, 46, 59], "stabil": 7, "boolean": [7, 39, 54], "nlp": 7, "sentence_length": 7, "embed": [7, 12, 57, 58], "layer_norm": [7, 57], "three": [7, 20, 22, 39], "spatial": 7, "shown": [7, 59], "in_featur": 8, "out_featur": 8, "incom": [8, 34], "tensorfloat32": [8, 34, 35], "On": [8, 35], "certain": [8, 33, 35, 55], "rocm": [8, 35], "float16": [8, 35, 39], "addit": [8, 11, 28, 34, 50, 59], "_featur": [8, 34], "h_": 8, "includ": [8, 34], "30": 8, "128": [8, 39], "print": [8, 56, 59], "hidden_s": [9, 10, 12, 13, 56], "head": [9, 12, 13], "dropout_p": [9, 12, 13, 39], "multi": [9, 12, 13], "self": [9, 12, 13, 36, 37, 55, 56, 59], "attent": [9, 12, 13, 36, 37, 39, 58, 59], "warn": [9, 12, 13], "here": [9, 12, 13, 39, 47, 49, 58, 59], "like": [9, 12, 13, 54, 59], "give": [9, 12, 13, 47, 59], "incorrect": [9, 12, 13, 54], "hidden": [9, 10, 12, 13], "dropout": [9, 12, 13, 39, 57], "act_fn": [10, 12, 13], "gelu": [10, 12, 13, 47, 57, 59], "expansion_factor": 10, "": [10, 19, 20, 21, 22, 34, 35, 39, 54, 55, 56, 59], "intermedi": [10, 55], "increas": [10, 39, 54], "rel": [10, 12, 13, 36, 37], "so": [11, 39, 40, 47, 49, 54, 55, 59], "lie": [11, 40], "multipli": [11, 35, 59], "li": 11, "adjust": 11, "accordingli": 11, "defin": [11, 16, 39, 40, 47, 54, 59], "x_i": [11, 40], "sum_j": [11, 40], "x_j": [11, 40], "unspecifi": 11, "inf": [11, 39], "along": [11, 40, 59], "slice": [11, 40, 55], "vocab_s": 12, "mhsa_tau": [12, 13], "01": [12, 13, 36, 37, 59], "mlp_tau": [12, 13], "decod": 12, "just": [12, 54, 55, 59], "demonstr": 12, "lack": 12, "kei": [12, 39, 47, 57, 58], "causal": [12, 39, 58], "mask": [12, 39, 58], "usag": 12, "infer": 12, "token": 12, "vocabulari": 12, "branch": [12, 13, 36, 37, 59], "skip": [12, 13, 36, 37, 54, 59], "connect": [12, 13, 36, 37, 47, 59], "mlp": [12, 13, 36, 37, 56, 57, 59], "prenorm": 13, "arxiv": 13, "org": 13, "ab": 13, "2002": 13, "04745": 13, "alias": 14, "arithmet": 15, "group": [15, 16, 17, 18], "constrain": [15, 17, 18, 47, 59], "constraint_nam": 16, "tupl": [16, 25, 26, 37, 51, 54, 55, 56, 59], "rais": [16, 39, 54], "valueerror": 16, "after": [16, 35, 47, 54], "been": [16, 47, 54, 58, 59], "geometr": [17, 59], "harmon": 18, "xavier": [18, 59], "glorot": [18, 59], "output_scal": [19, 20, 21, 22, 38, 59], "grad_input_scal": [19, 21, 38, 59], "select": [19, 20, 21, 22, 39], "chosen": [19, 20, 21, 22, 39], "op": [19, 20, 21, 22, 45, 46, 54, 55, 58, 59], "equal": [19, 20, 21, 22, 31, 59], "left_grad_scal": [20, 22], "right_grad_scal": [20, 22], "left": [20, 22, 35, 59], "right": [20, 22, 35], "grad": [21, 38, 42, 43, 54, 59], "exponent_bit": [24, 25, 26], "mantissa_bit": [24, 25, 26], "round": [24, 45, 46], "stochast": [24, 45, 46], "represent": [24, 45, 46], "point": [24, 31, 39, 59], "properti": 24, "bit": 24, "max_absolute_valu": 24, "maximum": [24, 31], "absolut": 24, "min_absolute_norm": 24, "minimum": 24, "min_absolute_subnorm": 24, "subnorm": 24, "quantis": [24, 45, 46], "differenti": [24, 54], "quantise_bwd": 24, "quantise_fwd": 24, "fpformat": [25, 26, 45, 57], "convert": [25, 59], "other": [28, 35, 39, 59], "alpha": 28, "_i": 28, "broadcast": [28, 35], "promot": 28, "complex": [28, 55], "to_left_grad_scal": [28, 35, 57], "to_right_grad_scal": [28, 35, 57], "0202": 28, "0985": 28, "3506": 28, "6056": 28, "21": 28, "19": 28, "3944": 28, "b": [28, 34, 54], "9732": 28, "3497": 28, "6245": 28, "4022": 28, "3743": 28, "7724": 28, "5811": 28, "8017": 28, "7695": 28, "3930": 28, "3672": 28, "1450": 28, "18": 28, "6971": 28, "0736": 28, "17": 28, "0994": 28, "3216": 28, "7845": 28, "1610": 28, "1868": 28, "4090": 28, "8": [28, 39, 59], "9902": 28, "3667": 28, "7": 28, "3925": 28, "6147": 28, "crossentropyloss": [29, 57, 59], "predict": 29, "section": [29, 57, 59], "divid": 29, "randint": 29, "int64": 29, "dictionaryand": 31, "row": 31, "column": 31, "modifi": [31, 54], "v": [31, 36, 37, 39], "embedding_matrix": 31, "rand": [31, 39], "8490": 31, "9625": 31, "6753": 31, "9666": 31, "7761": 31, "6108": 31, "6246": 31, "9751": 31, "3618": 31, "4161": 31, "2419": 31, "7383": 31, "0237": 31, "7794": 31, "0528": 31, "3385": 31, "8612": 31, "1867": 31, "zero_": 31, "5609": 31, "5384": 31, "8720": 31, "6262": 31, "2438": 31, "7471": 31, "wise": [32, 38], "param": 32, "sequenc": 33, "layernorm": [33, 57], "xa": 34, "layout": [34, 35, 55], "autograd": [34, 35, 54], "miss": [34, 35, 58], "pleas": [34, 35, 39, 54, 59], "open": [34, 35], "request": [34, 35, 58], "product": [35, 39], "behavior": [35, 54], "prepend": 35, "purpos": [35, 45, 46, 59], "remov": [35, 51, 59], "least": 35, "append": [35, 59], "thu": [35, 59], "j": 35, "logic": 35, "determin": [35, 59], "valid": [35, 47, 59], "even": [35, 59], "though": [35, 37, 49, 59], "final": [35, 47], "particular": [35, 47, 59], "mm": 35, "residu": [36, 37, 47, 59], "tau": [36, 37, 59], "add": [36, 47, 54, 57, 59], "togeth": [36, 59], "conjunct": [36, 37, 59], "residual_split": [36, 57, 59], "These": [36, 37, 59], "reflect": [36, 37, 56, 59], "empir": [36, 37], "fairli": [36, 37], "insensit": [36, 37], "001": [36, 37], "work": [36, 37, 56, 57, 58, 59], "caus": [36, 37, 59], "signific": [36, 37, 59], "degrad": [36, 37, 59], "come": 36, "result": [36, 37, 55], "split": 37, "prior": [37, 54], "residual_add": [37, 57, 59], "necessari": [37, 54, 59], "delai": [37, 59], "still": [37, 47, 54, 58], "normalis": 37, "model": [37, 45, 46, 47, 52, 57, 58], "benefici": 37, "behav": 37, "order": [37, 39, 55, 59], "callabl": [38, 47, 49, 50, 51, 55, 56, 59], "take": [38, 39, 47, 59], "kwarg": [38, 51, 54, 55], "queri": 39, "attn_mask": 39, "is_caus": 39, "usewhatev": 39, "underli": 39, "implementationi": 39, "avail": [39, 59], "flash": [39, 58], "aprob": 39, "greater": 39, "effici": [39, 54, 59], "tril": 39, "diagon": 39, "els": 39, "masked_fil": 39, "attn_weight": 39, "q": 39, "transpos": 39, "math": [39, 56], "subject": 39, "There": [39, 54, 59], "flashattent": 39, "fast": 39, "memori": [39, 54, 59], "exact": [39, 59], "awar": 39, "match": 39, "abov": [39, 59], "formul": 39, "kernel": [39, 59], "cuda": 39, "backend": [39, 49, 50], "attempt": [39, 54], "automat": [39, 47, 50, 54, 56, 59], "most": [39, 54, 59], "fine": 39, "grain": 39, "control": [39, 59], "what": [39, 54, 57], "disabl": 39, "context": [39, 54], "manag": 39, "prefer": 39, "mechan": [39, 59], "sdp_kernel": 39, "enable_flash_sdp": 39, "enable_mem_efficient_sdp": 39, "enable_math_sdp": 39, "fuse": [39, 59], "limit": [39, 57], "event": 39, "reason": 39, "why": [39, 59], "cannot": 39, "due": 39, "natur": 39, "float64": 39, "inform": 39, "numerical_accuraci": 39, "circumst": 39, "cudnn": 39, "nondeterminist": 39, "undesir": 39, "try": [39, 59], "potenti": 39, "cost": 39, "random": [39, 54], "ev": 39, "part": 39, "score": 39, "ensur": [39, 54, 59], "kerenel": 39, "32": 39, "64": [39, 59], "enable_math": 39, "desir": [40, 59], "cast": 40, "befor": [40, 45, 46, 54, 55, 59], "overflow": [40, 59], "unchang": 42, "dynamo": 44, "sake": 44, "fwd_format": 45, "bwd_format": 45, "experiment": [45, 46, 47], "torchdynamo": [45, 46, 47, 49, 50], "new": [45, 46, 49, 50, 51, 57, 59], "simul": [45, 46], "suppli": [45, 47, 49, 54, 59], "matmul": [45, 46, 57], "scaled_dot_product_attent": [45, 46, 57], "insert": [45, 46], "intern": [45, 46], "inspect": [45, 46], "correct": [45, 46, 54, 59], "fp32": [45, 46, 59], "speedup": [45, 46, 59], "method": [45, 46, 49, 54, 55, 56, 57, 58, 59], "variou": 45, "As": [46, 59], "literatur": 46, "noun": 46, "et": 46, "al": 46, "2022": 46, "micikeviciu": 46, "e4": [46, 59], "e5": [46, 59], "dict": [47, 51, 55], "trace": 47, "identifi": 47, "procedur": 47, "recurs": [47, 49, 50, 55, 56], "whether": [47, 54], "inner": 47, "build": [47, 59], "graph": [47, 49, 50, 51, 54, 55], "fundament": 47, "proce": 47, "five": 47, "stage": [47, 58], "accord": 47, "identif": 47, "repres": [47, 49, 51, 53, 54, 55, 56, 59], "done": 47, "analysi": [47, 56, 59], "special": 47, "compar": 47, "unconstrain": 47, "proof": 47, "henc": 47, "initialis": [47, 59], "abl": [47, 59], "much": [47, 59], "previou": 47, "approach": [47, 49, 59], "express": [47, 51], "compil": [47, 49, 50, 59], "doesn": [47, 49, 50, 54], "nest": [47, 49], "own": [47, 49], "system": [47, 49], "easi": [47, 49], "simulate_fp8": [47, 57], "howev": [47, 49, 59], "interoper": [47, 49], "interfac": [47, 49], "definit": 47, "custom": [47, 54], "basic": [47, 59], "told": 47, "explicitli": 47, "substitut": 47, "def": [47, 54, 56, 59], "new_gelu": 47, "wide": 47, "test": [47, 59], "said": 47, "suffici": [47, 59], "wai": [47, 54, 59], "anticip": 47, "mani": [47, 54, 58, 59], "ultim": 47, "reli": 47, "alon": 47, "prioriti": 47, "copi": 47, "graphmodul": [49, 55], "non_recurse_funct": [49, 50], "fx": [49, 50, 55, 56, 59], "graph_modul": 49, "_dynamo": [49, 50], "backend_1": 49, "backend_2": 49, "move": 49, "within": [49, 55, 59], "execut": [49, 55], "optimis": [49, 50, 57], "cach": 49, "thereaft": 49, "conveni": 49, "_modul": 49, "iter": [49, 50], "fn": 50, "captur": 50, "wrap": [50, 55, 56, 59], "now": [50, 54, 59], "typic": [50, 59], "expand": [50, 54], "patch": 50, "node": [51, 55], "target_fn": 51, "keep_type_expr": 51, "accompani": 51, "retain": 51, "develop": [52, 57, 58, 59], "dataclass": 53, "pair": 53, "intend": [53, 54], "record": [54, 55], "scalepair": [54, 57], "static": 54, "ctx": 54, "functionctx": 54, "formula": 54, "alia": 54, "vjp": 54, "overridden": 54, "subclass": 54, "were": 54, "attribut": [54, 55], "needs_input_grad": 54, "g": 54, "is_trac": 54, "autogener": 54, "vmap": 54, "jvp": 54, "written": 54, "extend": 54, "func": 54, "grad_input": 54, "got": 54, "respect": 54, "object": 54, "mark_dirti": 54, "mark": 54, "onc": [54, 58], "insid": 54, "matter": 54, "torch_doctest_autograd": 54, "staticmethod": 54, "x_npy": 54, "numpi": 54, "share": [54, 59], "storag": 54, "once_differenti": 54, "grad_output": 54, "doubl": 54, "clone": [54, 57, 59], "would": 54, "lead": [54, 59], "wrong": 54, "engin": 54, "know": 54, "unless": 54, "runtimeerror": 54, "variabl": 54, "mark_non_differenti": 54, "alwai": 54, "go": [54, 59], "sort": 54, "idx": 54, "save_for_backward": 54, "g1": 54, "g2": 54, "saved_tensor": 54, "zeros_lik": 54, "index_add_": 54, "futur": 54, "oppos": 54, "directli": [54, 59], "leak": 54, "hook": 54, "saved_tensors_hook": 54, "intermediari": 54, "neither": 54, "nor": 54, "decor": 54, "recomput": 54, "tutori": [54, 59], "access": 54, "through": [54, 55, 59], "made": 54, "weren": 54, "content": 54, "how": [54, 57], "z": 54, "grad_out": 54, "gx": 54, "gy": 54, "gz": 54, "save_for_forward": 54, "x_t": 54, "y_t": 54, "fwad": 54, "dual_level": 54, "a_dual": 54, "make_du": 54, "set_materialize_grad": 54, "materi": 54, "undefin": 54, "simplefunc": 54, "No": 54, "handl": [54, 55], "induc": 54, "setup_context": 54, "signatur": 54, "happen": 54, "info": 54, "in_dim": 54, "rule": 54, "underneath": 54, "generate_vmap_rul": 54, "choos": 54, "batch_siz": [54, 59], "while": 54, "out_dim": 54, "similar": [54, 59], "structur": [54, 55], "instrument": 55, "call_funct": 55, "semant": 55, "invoc": 55, "keyword": 55, "compat": 55, "api": [55, 57, 59], "guarante": 55, "call_method": 55, "memory_format": 55, "call_modul": 55, "fetch_args_kwargs_from_env": 55, "fetch": 55, "concret": 55, "environ": 55, "fetch_attr": 55, "hierarchi": 55, "fulli": 55, "qualifi": 55, "get_attr": 55, "Will": 55, "wa": 55, "map_nodes_to_valu": 55, "descend": 55, "belong": 55, "report": 55, "realli": 55, "referenc": 55, "placehold": 55, "tracer": 55, "target_to_funct": 55, "initial_env": 55, "enable_io_process": 55, "interpret": 55, "start": [55, 59], "map": 55, "popul": 55, "partial": 55, "process_input": 55, "process_output": 55, "run_nod": 55, "recurse_modul": 56, "syntax_highlight": 56, "autowrap_modul": 56, "einop": 56, "home": 56, "runner": 56, "local": 56, "lib": 56, "site": 56, "packag": 56, "__init__": [56, 59], "py": 56, "autowrap_funct": 56, "dummi": 56, "annot": 56, "analys": [56, 59], "union": 56, "fed": [56, 59], "plain": 56, "toggl": 56, "behavour": 56, "moduletyp": 56, "whose": 56, "without": [56, 59], "string": 56, "super": [56, 59], "fc1": 56, "relu": 56, "fc2": 56, "requires_grad_": [56, 59], "bwd": [56, 59], "236": 56, "fc1_weight": 56, "018": [56, 59], "54": 56, "fc1_bia": 56, "0182": 56, "51": 56, "_c": [56, 59], "_nn": [56, 59], "578": [56, 59], "204": [56, 59], "337": 56, "288": 56, "fc2_weight": 56, "00902": [56, 59], "13": 56, "fc2_bia": 56, "00904": 56, "31": 56, "linear_1": [56, 59], "235": 56, "999": [56, 59], "welcom": 57, "design": [57, 59], "facilit": 57, "outlin": [57, 59], "icml": [57, 59], "fork": [57, 59], "repo": [57, 59], "instruct": [57, 59], "video": 57, "illustr": 57, "refer": [57, 59], "overview": [57, 59], "consider": 57, "licens": 57, "mhsa": 57, "transformerdecod": 57, "transformerlay": 57, "apply_constraint": 57, "format_to_tupl": 57, "tuple_to_format": 57, "cross_entropi": [57, 59], "scale_elementwis": 57, "scale_bwd": 57, "scale_fwd": 57, "simulate_format": 57, "unit_scal": 57, "util": [57, 59], "apply_transform": 57, "patch_to_expand_modul": 57, "replace_node_with_funct": 57, "analyse_modul": [57, 59], "scaletrack": 57, "scaletrackinginterpret": 57, "earli": 58, "roadmap": 58, "interplai": 58, "investig": [58, 59], "exhaust": 58, "encourag": 58, "touch": 58, "paradigm": 59, "deep": 59, "aim": 59, "involv": 59, "term": 59, "preserv": 59, "usual": 59, "scratch": 59, "assumpt": 59, "advantag": 59, "great": 59, "perspect": 59, "roughli": 59, "headroom": 59, "grow": 59, "shrink": 59, "underflow": 59, "occur": 59, "becaus": 59, "although": 59, "drift": 59, "stai": 59, "far": 59, "smaller": 59, "behaviour": 59, "dynam": 59, "slightli": 59, "experi": 59, "decreas": 59, "faster": 59, "treatment": 59, "motiv": 59, "keep": 59, "sens": 59, "understand": 59, "might": 59, "bf16": 59, "issu": 59, "veri": 59, "larg": 59, "small": 59, "3e": 59, "38": 59, "45": 59, "60": 59, "000": 59, "6e": 59, "put": 59, "speed": 59, "discuss": 59, "scope": 59, "next": 59, "step": 59, "tricki": 59, "tool": 59, "easier": 59, "line": 59, "breakdown": 59, "alongsid": 59, "unscaledmlp": 59, "linear_2": 59, "deriv": 59, "fwd": 59, "annotated_cod": 59, "linear_1_weight": 59, "83": 59, "linear_1_bia": 59, "84": 59, "177": 59, "322": 59, "289": 59, "linear_2_weight": 59, "48": 59, "linear_2_bia": 59, "00894": 59, "198": 59, "firstli": 59, "decompos": 59, "secondli": 59, "fwd_scale": 59, "bwd_scale": 59, "denot": 59, "sign": 59, "receiv": 59, "enough": 59, "unscal": 59, "could": 59, "show": 59, "address": 59, "drop": 59, "scaledmlp": 59, "716": 59, "729": 59, "707": 59, "706": 59, "693": 59, "03": 59, "979": 59, "repeat": 59, "until": 59, "good": 59, "measur": 59, "someth": 59, "art": 59, "max": 59, "min": 59, "aris": 59, "seen": 59, "clearli": 59, "explod": 59, "clip": 59, "convers": 59, "tend": 59, "steadili": 59, "exactli": 59, "meet": 59, "concern": 59, "significantli": 59, "merit": 59, "attain": 59, "best": 59, "divis": 59, "substanti": 59, "push": 59, "themselv": 59, "solv": 59, "outsid": 59, "separ": 59, "altern": 59, "care": 59, "form": 59, "residuallay": 59, "contrast": 59, "ratio": 59, "50": 59, "hyperparamet": 59, "leav": 59, "tune": 59, "find": 59, "fact": 59, "down": 59, "emploi": 59, "trick": 59, "comprehens": 59, "introduc": 59, "scenario": 59, "produc": 59, "arriv": 59, "fan_in": 59, "fan_out": 59, "grad_weight_scal": 59, "grad_bias_scal": 59, "ideal": 59, "compromis": 59, "don": 59, "extra": 59, "eager": 59, "trip": 59, "fortun": 59, "hi": 59, "overhead": 59, "elimin": 59, "fusion": 59, "stack": 59, "answer": 59, "old": 59, "jit": 59, "script": 59, "torchscript": 59, "program": 59, "rectifi": 59, "flexibl": 59, "theori": 59, "unit_scaled_funct": 59, "unitscaledmodul": 59, "incur": 59, "naiv": 59, "benchmark": 59, "notebook": 59, "thorough": 59, "strongli": 59, "block": 59, "latest": 59, "fail": 59, "recent": 59, "upgrad": 59, "preview": 59, "nightli": 59}, "objects": {"": [[2, 0, 0, "-", "unit_scaling"]], "unit_scaling": [[3, 1, 1, "", "CrossEntropyLoss"], [4, 1, 1, "", "Dropout"], [5, 1, 1, "", "Embedding"], [6, 1, 1, "", "GELU"], [7, 1, 1, "", "LayerNorm"], [8, 1, 1, "", "Linear"], [9, 1, 1, "", "MHSA"], [10, 1, 1, "", "MLP"], [11, 1, 1, "", "Softmax"], [12, 1, 1, "", "TransformerDecoder"], [13, 1, 1, "", "TransformerLayer"], [14, 0, 0, "-", "constraints"], [23, 0, 0, "-", "formats"], [27, 0, 0, "-", "functional"], [41, 0, 0, "-", "scale"], [44, 0, 0, "-", "transforms"], [52, 0, 0, "-", "utils"]], "unit_scaling.Embedding": [[5, 2, 1, "", "from_pretrained"], [5, 3, 1, "", "weight"]], "unit_scaling.LayerNorm": [[7, 3, 1, "", "bias"], [7, 3, 1, "", "weight"]], "unit_scaling.Linear": [[8, 3, 1, "", "bias"], [8, 3, 1, "", "weight"]], "unit_scaling.constraints": [[15, 4, 1, "", "amean"], [16, 4, 1, "", "apply_constraint"], [17, 4, 1, "", "gmean"], [18, 4, 1, "", "hmean"], [19, 4, 1, "", "to_grad_input_scale"], [20, 4, 1, "", "to_left_grad_scale"], [21, 4, 1, "", "to_output_scale"], [22, 4, 1, "", "to_right_grad_scale"]], "unit_scaling.formats": [[24, 1, 1, "", "FPFormat"], [25, 4, 1, "", "format_to_tuple"], [26, 4, 1, "", "tuple_to_format"]], "unit_scaling.formats.FPFormat": [[24, 5, 1, "", "bits"], [24, 5, 1, "", "max_absolute_value"], [24, 5, 1, "", "min_absolute_normal"], [24, 5, 1, "", "min_absolute_subnormal"], [24, 2, 1, "", "quantise"], [24, 2, 1, "", "quantise_bwd"], [24, 2, 1, "", "quantise_fwd"]], "unit_scaling.functional": [[28, 4, 1, "", "add"], [29, 4, 1, "", "cross_entropy"], [30, 4, 1, "", "dropout"], [31, 4, 1, "", "embedding"], [32, 4, 1, "", "gelu"], [33, 4, 1, "", "layer_norm"], [34, 4, 1, "", "linear"], [35, 4, 1, "", "matmul"], [36, 4, 1, "", "residual_add"], [37, 4, 1, "", "residual_split"], [38, 4, 1, "", "scale_elementwise"], [39, 4, 1, "", "scaled_dot_product_attention"], [40, 4, 1, "", "softmax"]], "unit_scaling.scale": [[42, 4, 1, "", "scale_bwd"], [43, 4, 1, "", "scale_fwd"]], "unit_scaling.transforms": [[45, 4, 1, "", "simulate_format"], [46, 4, 1, "", "simulate_fp8"], [47, 4, 1, "", "unit_scale"], [48, 0, 0, "-", "utils"]], "unit_scaling.transforms.utils": [[49, 4, 1, "", "apply_transform"], [50, 4, 1, "", "patch_to_expand_modules"], [51, 4, 1, "", "replace_node_with_function"]], "unit_scaling.utils": [[53, 1, 1, "", "ScalePair"], [54, 1, 1, "", "ScaleTracker"], [55, 1, 1, "", "ScaleTrackingInterpreter"], [56, 4, 1, "", "analyse_module"]], "unit_scaling.utils.ScaleTracker": [[54, 2, 1, "", "backward"], [54, 3, 1, "", "is_traceable"], [54, 2, 1, "", "jvp"], [54, 2, 1, "", "mark_dirty"], [54, 2, 1, "", "mark_non_differentiable"], [54, 2, 1, "", "save_for_backward"], [54, 2, 1, "", "save_for_forward"], [54, 2, 1, "", "set_materialize_grads"], [54, 2, 1, "", "setup_context"], [54, 2, 1, "", "vjp"], [54, 2, 1, "", "vmap"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[55, 2, 1, "", "call_function"], [55, 2, 1, "", "call_method"], [55, 2, 1, "", "call_module"], [55, 2, 1, "", "fetch_args_kwargs_from_env"], [55, 2, 1, "", "fetch_attr"], [55, 2, 1, "", "get_attr"], [55, 2, 1, "", "map_nodes_to_values"], [55, 2, 1, "", "output"], [55, 2, 1, "", "placeholder"], [55, 2, 1, "", "run"], [55, 2, 1, "", "run_node"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:function", "5": "py:property"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "function", "Python function"], "5": ["py", "property", "Python property"]}, "titleterms": {"api": 0, "refer": 0, "unit": [1, 57, 59], "scale": [1, 41, 42, 43, 57, 59], "instal": [1, 57, 59], "what": [1, 59], "i": [1, 59], "develop": 1, "licens": 1, "unit_sc": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56], "crossentropyloss": 3, "dropout": [4, 30], "embed": [5, 31], "gelu": [6, 32], "layernorm": 7, "linear": [8, 34], "mhsa": 9, "mlp": 10, "softmax": [11, 40], "transformerdecod": 12, "transformerlay": 13, "constraint": [14, 15, 16, 17, 18, 19, 20, 21, 22], "amean": 15, "apply_constraint": 16, "gmean": 17, "hmean": 18, "to_grad_input_scal": 19, "to_left_grad_scal": 20, "to_output_scal": 21, "to_right_grad_scal": 22, "format": [23, 24, 25, 26], "fpformat": 24, "format_to_tupl": 25, "tuple_to_format": 26, "function": [27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40], "add": 28, "cross_entropi": 29, "layer_norm": 33, "matmul": 35, "residual_add": 36, "residual_split": 37, "scale_elementwis": 38, "scaled_dot_product_attent": 39, "scale_bwd": 42, "scale_fwd": 43, "transform": [44, 45, 46, 47, 48, 49, 50, 51], "simulate_format": 45, "simulate_fp8": 46, "unit_scal": 47, "util": [48, 49, 50, 51, 52, 53, 54, 55, 56], "apply_transform": 49, "patch_to_expand_modul": 50, "replace_node_with_funct": 51, "scalepair": 53, "scaletrack": 54, "scaletrackinginterpret": 55, "analyse_modul": 56, "get": 57, "start": 57, "content": 57, "limit": 58, "user": 59, "guid": 59, "how": 59, "model": 59, "kei": 59, "consider": 59, "optimis": 59}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"API reference": [[0, "api-reference"]], "Unit Scaling": [[1, "unit-scaling"], [57, "unit-scaling"]], "Installation": [[1, "installation"], [57, "installation"], [59, "installation"]], "What is unit scaling?": [[1, "what-is-unit-scaling"], [59, "what-is-unit-scaling"]], "Development": [[1, "development"]], "License": [[1, "license"]], "unit_scaling": [[2, "module-unit_scaling"]], "unit_scaling.CrossEntropyLoss": [[3, "unit-scaling-crossentropyloss"]], "unit_scaling.Dropout": [[4, "unit-scaling-dropout"]], "unit_scaling.Embedding": [[5, "unit-scaling-embedding"]], "unit_scaling.GELU": [[6, "unit-scaling-gelu"]], "unit_scaling.LayerNorm": [[7, "unit-scaling-layernorm"]], "unit_scaling.Linear": [[8, "unit-scaling-linear"]], "unit_scaling.MHSA": [[9, "unit-scaling-mhsa"]], "unit_scaling.MLP": [[10, "unit-scaling-mlp"]], "unit_scaling.Softmax": [[11, "unit-scaling-softmax"]], "unit_scaling.TransformerDecoder": [[12, "unit-scaling-transformerdecoder"]], "unit_scaling.TransformerLayer": [[13, "unit-scaling-transformerlayer"]], "unit_scaling.constraints": [[14, "module-unit_scaling.constraints"]], "unit_scaling.constraints.amean": [[15, "unit-scaling-constraints-amean"]], "unit_scaling.constraints.apply_constraint": [[16, "unit-scaling-constraints-apply-constraint"]], "unit_scaling.constraints.gmean": [[17, "unit-scaling-constraints-gmean"]], "unit_scaling.constraints.hmean": [[18, "unit-scaling-constraints-hmean"]], "unit_scaling.constraints.to_grad_input_scale": [[19, "unit-scaling-constraints-to-grad-input-scale"]], "unit_scaling.constraints.to_left_grad_scale": [[20, "unit-scaling-constraints-to-left-grad-scale"]], "unit_scaling.constraints.to_output_scale": [[21, "unit-scaling-constraints-to-output-scale"]], "unit_scaling.constraints.to_right_grad_scale": [[22, "unit-scaling-constraints-to-right-grad-scale"]], "unit_scaling.formats": [[23, "module-unit_scaling.formats"]], "unit_scaling.formats.FPFormat": [[24, "unit-scaling-formats-fpformat"]], "unit_scaling.formats.format_to_tuple": [[25, "unit-scaling-formats-format-to-tuple"]], "unit_scaling.formats.tuple_to_format": [[26, "unit-scaling-formats-tuple-to-format"]], "unit_scaling.functional": [[27, "module-unit_scaling.functional"]], "unit_scaling.functional.add": [[28, "unit-scaling-functional-add"]], "unit_scaling.functional.cross_entropy": [[29, "unit-scaling-functional-cross-entropy"]], "unit_scaling.functional.dropout": [[30, "unit-scaling-functional-dropout"]], "unit_scaling.functional.embedding": [[31, "unit-scaling-functional-embedding"]], "unit_scaling.functional.gelu": [[32, "unit-scaling-functional-gelu"]], "unit_scaling.functional.layer_norm": [[33, "unit-scaling-functional-layer-norm"]], "unit_scaling.functional.linear": [[34, "unit-scaling-functional-linear"]], "unit_scaling.functional.matmul": [[35, "unit-scaling-functional-matmul"]], "unit_scaling.functional.residual_add": [[36, "unit-scaling-functional-residual-add"]], "unit_scaling.functional.residual_split": [[37, "unit-scaling-functional-residual-split"]], "unit_scaling.functional.scale_elementwise": [[38, "unit-scaling-functional-scale-elementwise"]], "unit_scaling.functional.scaled_dot_product_attention": [[39, "unit-scaling-functional-scaled-dot-product-attention"]], "unit_scaling.functional.softmax": [[40, "unit-scaling-functional-softmax"]], "unit_scaling.scale": [[41, "module-unit_scaling.scale"]], "unit_scaling.scale.scale_bwd": [[42, "unit-scaling-scale-scale-bwd"]], "unit_scaling.scale.scale_fwd": [[43, "unit-scaling-scale-scale-fwd"]], "unit_scaling.transforms": [[44, "module-unit_scaling.transforms"]], "unit_scaling.transforms.simulate_format": [[45, "unit-scaling-transforms-simulate-format"]], "unit_scaling.transforms.simulate_fp8": [[46, "unit-scaling-transforms-simulate-fp8"]], "unit_scaling.transforms.unit_scale": [[47, "unit-scaling-transforms-unit-scale"]], "unit_scaling.transforms.utils": [[48, "module-unit_scaling.transforms.utils"]], "unit_scaling.transforms.utils.apply_transform": [[49, "unit-scaling-transforms-utils-apply-transform"]], "unit_scaling.transforms.utils.patch_to_expand_modules": [[50, "unit-scaling-transforms-utils-patch-to-expand-modules"]], "unit_scaling.transforms.utils.replace_node_with_function": [[51, "unit-scaling-transforms-utils-replace-node-with-function"]], "unit_scaling.utils": [[52, "module-unit_scaling.utils"]], "unit_scaling.utils.ScalePair": [[53, "unit-scaling-utils-scalepair"]], "unit_scaling.utils.ScaleTracker": [[54, "unit-scaling-utils-scaletracker"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[55, "unit-scaling-utils-scaletrackinginterpreter"]], "unit_scaling.utils.analyse_module": [[56, "unit-scaling-utils-analyse-module"]], "Getting Started": [[57, "getting-started"]], "Contents": [[57, null]], "Limitations": [[58, "limitations"]], "User guide": [[59, "user-guide"]], "How to unit-scale a model": [[59, "how-to-unit-scale-a-model"]], "Key considerations for unit scaling": [[59, "key-considerations-for-unit-scaling"]], "Optimising unit-scaled models": [[59, "optimising-unit-scaled-models"]]}, "indexentries": {"module": [[2, "module-unit_scaling"], [14, "module-unit_scaling.constraints"], [23, "module-unit_scaling.formats"], [27, "module-unit_scaling.functional"], [41, "module-unit_scaling.scale"], [44, "module-unit_scaling.transforms"], [48, "module-unit_scaling.transforms.utils"], [52, "module-unit_scaling.utils"]], "unit_scaling": [[2, "module-unit_scaling"]], "crossentropyloss (class in unit_scaling)": [[3, "unit_scaling.CrossEntropyLoss"]], "dropout (class in unit_scaling)": [[4, "unit_scaling.Dropout"]], "embedding (class in unit_scaling)": [[5, "unit_scaling.Embedding"]], "from_pretrained() (unit_scaling.embedding class method)": [[5, "unit_scaling.Embedding.from_pretrained"]], "weight (unit_scaling.embedding attribute)": [[5, "unit_scaling.Embedding.weight"]], "gelu (class in unit_scaling)": [[6, "unit_scaling.GELU"]], "layernorm (class in unit_scaling)": [[7, "unit_scaling.LayerNorm"]], "bias (unit_scaling.layernorm attribute)": [[7, "unit_scaling.LayerNorm.bias"]], "weight (unit_scaling.layernorm attribute)": [[7, "unit_scaling.LayerNorm.weight"]], "linear (class in unit_scaling)": [[8, "unit_scaling.Linear"]], "bias (unit_scaling.linear attribute)": [[8, "unit_scaling.Linear.bias"]], "weight (unit_scaling.linear attribute)": [[8, "unit_scaling.Linear.weight"]], "mhsa (class in unit_scaling)": [[9, "unit_scaling.MHSA"]], "mlp (class in unit_scaling)": [[10, "unit_scaling.MLP"]], "softmax (class in unit_scaling)": [[11, "unit_scaling.Softmax"]], "transformerdecoder (class in unit_scaling)": [[12, "unit_scaling.TransformerDecoder"]], "transformerlayer (class in unit_scaling)": [[13, "unit_scaling.TransformerLayer"]], "unit_scaling.constraints": [[14, "module-unit_scaling.constraints"]], "amean() (in module unit_scaling.constraints)": [[15, "unit_scaling.constraints.amean"]], "apply_constraint() (in module unit_scaling.constraints)": [[16, "unit_scaling.constraints.apply_constraint"]], "gmean() (in module unit_scaling.constraints)": [[17, "unit_scaling.constraints.gmean"]], "hmean() (in module unit_scaling.constraints)": [[18, "unit_scaling.constraints.hmean"]], "to_grad_input_scale() (in module unit_scaling.constraints)": [[19, "unit_scaling.constraints.to_grad_input_scale"]], "to_left_grad_scale() (in module unit_scaling.constraints)": [[20, "unit_scaling.constraints.to_left_grad_scale"]], "to_output_scale() (in module unit_scaling.constraints)": [[21, "unit_scaling.constraints.to_output_scale"]], "to_right_grad_scale() (in module unit_scaling.constraints)": [[22, "unit_scaling.constraints.to_right_grad_scale"]], "unit_scaling.formats": [[23, "module-unit_scaling.formats"]], "fpformat (class in unit_scaling.formats)": [[24, "unit_scaling.formats.FPFormat"]], "bits (unit_scaling.formats.fpformat property)": [[24, "unit_scaling.formats.FPFormat.bits"]], "max_absolute_value (unit_scaling.formats.fpformat property)": [[24, "unit_scaling.formats.FPFormat.max_absolute_value"]], "min_absolute_normal (unit_scaling.formats.fpformat property)": [[24, "unit_scaling.formats.FPFormat.min_absolute_normal"]], "min_absolute_subnormal (unit_scaling.formats.fpformat property)": [[24, "unit_scaling.formats.FPFormat.min_absolute_subnormal"]], "quantise() (unit_scaling.formats.fpformat method)": [[24, "unit_scaling.formats.FPFormat.quantise"]], "quantise_bwd() (unit_scaling.formats.fpformat method)": [[24, "unit_scaling.formats.FPFormat.quantise_bwd"]], "quantise_fwd() (unit_scaling.formats.fpformat method)": [[24, "unit_scaling.formats.FPFormat.quantise_fwd"]], "format_to_tuple() (in module unit_scaling.formats)": [[25, "unit_scaling.formats.format_to_tuple"]], "tuple_to_format() (in module unit_scaling.formats)": [[26, "unit_scaling.formats.tuple_to_format"]], "unit_scaling.functional": [[27, "module-unit_scaling.functional"]], "add() (in module unit_scaling.functional)": [[28, "unit_scaling.functional.add"]], "cross_entropy() (in module unit_scaling.functional)": [[29, "unit_scaling.functional.cross_entropy"]], "dropout() (in module unit_scaling.functional)": [[30, "unit_scaling.functional.dropout"]], "embedding() (in module unit_scaling.functional)": [[31, "unit_scaling.functional.embedding"]], "gelu() (in module unit_scaling.functional)": [[32, "unit_scaling.functional.gelu"]], "layer_norm() (in module unit_scaling.functional)": [[33, "unit_scaling.functional.layer_norm"]], "linear() (in module unit_scaling.functional)": [[34, "unit_scaling.functional.linear"]], "matmul() (in module unit_scaling.functional)": [[35, "unit_scaling.functional.matmul"]], "residual_add() (in module unit_scaling.functional)": [[36, "unit_scaling.functional.residual_add"]], "residual_split() (in module unit_scaling.functional)": [[37, "unit_scaling.functional.residual_split"]], "scale_elementwise() (in module unit_scaling.functional)": [[38, "unit_scaling.functional.scale_elementwise"]], "scaled_dot_product_attention() (in module unit_scaling.functional)": [[39, "unit_scaling.functional.scaled_dot_product_attention"]], "softmax() (in module unit_scaling.functional)": [[40, "unit_scaling.functional.softmax"]], "unit_scaling.scale": [[41, "module-unit_scaling.scale"]], "scale_bwd() (in module unit_scaling.scale)": [[42, "unit_scaling.scale.scale_bwd"]], "scale_fwd() (in module unit_scaling.scale)": [[43, "unit_scaling.scale.scale_fwd"]], "unit_scaling.transforms": [[44, "module-unit_scaling.transforms"]], "simulate_format() (in module unit_scaling.transforms)": [[45, "unit_scaling.transforms.simulate_format"]], "simulate_fp8() (in module unit_scaling.transforms)": [[46, "unit_scaling.transforms.simulate_fp8"]], "unit_scale() (in module unit_scaling.transforms)": [[47, "unit_scaling.transforms.unit_scale"]], "unit_scaling.transforms.utils": [[48, "module-unit_scaling.transforms.utils"]], "apply_transform() (in module unit_scaling.transforms.utils)": [[49, "unit_scaling.transforms.utils.apply_transform"]], "patch_to_expand_modules() (in module unit_scaling.transforms.utils)": [[50, "unit_scaling.transforms.utils.patch_to_expand_modules"]], "replace_node_with_function() (in module unit_scaling.transforms.utils)": [[51, "unit_scaling.transforms.utils.replace_node_with_function"]], "unit_scaling.utils": [[52, "module-unit_scaling.utils"]], "scalepair (class in unit_scaling.utils)": [[53, "unit_scaling.utils.ScalePair"]], "scaletracker (class in unit_scaling.utils)": [[54, "unit_scaling.utils.ScaleTracker"]], "backward() (unit_scaling.utils.scaletracker static method)": [[54, "unit_scaling.utils.ScaleTracker.backward"]], "is_traceable (unit_scaling.utils.scaletracker attribute)": [[54, "unit_scaling.utils.ScaleTracker.is_traceable"]], "jvp() (unit_scaling.utils.scaletracker static method)": [[54, "unit_scaling.utils.ScaleTracker.jvp"]], "mark_dirty() (unit_scaling.utils.scaletracker method)": [[54, "unit_scaling.utils.ScaleTracker.mark_dirty"]], "mark_non_differentiable() (unit_scaling.utils.scaletracker method)": [[54, "unit_scaling.utils.ScaleTracker.mark_non_differentiable"]], "save_for_backward() (unit_scaling.utils.scaletracker method)": [[54, "unit_scaling.utils.ScaleTracker.save_for_backward"]], "save_for_forward() (unit_scaling.utils.scaletracker method)": [[54, "unit_scaling.utils.ScaleTracker.save_for_forward"]], "set_materialize_grads() (unit_scaling.utils.scaletracker method)": [[54, "unit_scaling.utils.ScaleTracker.set_materialize_grads"]], "setup_context() (unit_scaling.utils.scaletracker static method)": [[54, "unit_scaling.utils.ScaleTracker.setup_context"]], "vjp() (unit_scaling.utils.scaletracker static method)": [[54, "unit_scaling.utils.ScaleTracker.vjp"]], "vmap() (unit_scaling.utils.scaletracker static method)": [[54, "unit_scaling.utils.ScaleTracker.vmap"]], "scaletrackinginterpreter (class in unit_scaling.utils)": [[55, "unit_scaling.utils.ScaleTrackingInterpreter"]], "call_function() (unit_scaling.utils.scaletrackinginterpreter method)": [[55, "unit_scaling.utils.ScaleTrackingInterpreter.call_function"]], "call_method() (unit_scaling.utils.scaletrackinginterpreter method)": [[55, "unit_scaling.utils.ScaleTrackingInterpreter.call_method"]], "call_module() (unit_scaling.utils.scaletrackinginterpreter method)": [[55, "unit_scaling.utils.ScaleTrackingInterpreter.call_module"]], "fetch_args_kwargs_from_env() (unit_scaling.utils.scaletrackinginterpreter method)": [[55, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_args_kwargs_from_env"]], "fetch_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[55, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_attr"]], "get_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[55, "unit_scaling.utils.ScaleTrackingInterpreter.get_attr"]], "map_nodes_to_values() (unit_scaling.utils.scaletrackinginterpreter method)": [[55, "unit_scaling.utils.ScaleTrackingInterpreter.map_nodes_to_values"]], "output() (unit_scaling.utils.scaletrackinginterpreter method)": [[55, "unit_scaling.utils.ScaleTrackingInterpreter.output"]], "placeholder() (unit_scaling.utils.scaletrackinginterpreter method)": [[55, "unit_scaling.utils.ScaleTrackingInterpreter.placeholder"]], "run() (unit_scaling.utils.scaletrackinginterpreter method)": [[55, "unit_scaling.utils.ScaleTrackingInterpreter.run"]], "run_node() (unit_scaling.utils.scaletrackinginterpreter method)": [[55, "unit_scaling.utils.ScaleTrackingInterpreter.run_node"]], "analyse_module() (in module unit_scaling.utils)": [[56, "unit_scaling.utils.analyse_module"]]}})