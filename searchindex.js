Search.setIndex({"docnames": ["api_reference", "blog", "development", "generated/unit_scaling", "generated/unit_scaling.CrossEntropyLoss", "generated/unit_scaling.Dropout", "generated/unit_scaling.Embedding", "generated/unit_scaling.GELU", "generated/unit_scaling.LayerNorm", "generated/unit_scaling.Linear", "generated/unit_scaling.MHSA", "generated/unit_scaling.MLP", "generated/unit_scaling.Softmax", "generated/unit_scaling.TransformerDecoder", "generated/unit_scaling.TransformerLayer", "generated/unit_scaling.analysis", "generated/unit_scaling.analysis.example_batch", "generated/unit_scaling.analysis.graph_to_dataframe", "generated/unit_scaling.analysis.plot", "generated/unit_scaling.analysis.visualiser", "generated/unit_scaling.constraints", "generated/unit_scaling.constraints.amean", "generated/unit_scaling.constraints.apply_constraint", "generated/unit_scaling.constraints.gmean", "generated/unit_scaling.constraints.hmean", "generated/unit_scaling.constraints.to_grad_input_scale", "generated/unit_scaling.constraints.to_left_grad_scale", "generated/unit_scaling.constraints.to_output_scale", "generated/unit_scaling.constraints.to_right_grad_scale", "generated/unit_scaling.formats", "generated/unit_scaling.formats.FPFormat", "generated/unit_scaling.formats.format_to_tuple", "generated/unit_scaling.formats.tuple_to_format", "generated/unit_scaling.functional", "generated/unit_scaling.functional.add", "generated/unit_scaling.functional.cross_entropy", "generated/unit_scaling.functional.dropout", "generated/unit_scaling.functional.embedding", "generated/unit_scaling.functional.gelu", "generated/unit_scaling.functional.layer_norm", "generated/unit_scaling.functional.linear", "generated/unit_scaling.functional.matmul", "generated/unit_scaling.functional.residual_add", "generated/unit_scaling.functional.residual_split", "generated/unit_scaling.functional.scale_elementwise", "generated/unit_scaling.functional.scaled_dot_product_attention", "generated/unit_scaling.functional.softmax", "generated/unit_scaling.scale", "generated/unit_scaling.scale.scale_bwd", "generated/unit_scaling.scale.scale_fwd", "generated/unit_scaling.transforms", "generated/unit_scaling.transforms.Metrics", "generated/unit_scaling.transforms.compile", "generated/unit_scaling.transforms.prune_non_float_tensors", "generated/unit_scaling.transforms.prune_same_scale_tensors", "generated/unit_scaling.transforms.prune_selected_nodes", "generated/unit_scaling.transforms.simulate_format", "generated/unit_scaling.transforms.simulate_fp8", "generated/unit_scaling.transforms.track_scales", "generated/unit_scaling.transforms.unit_scale", "generated/unit_scaling.transforms.utils", "generated/unit_scaling.transforms.utils.apply_transform", "generated/unit_scaling.transforms.utils.patch_to_expand_modules", "generated/unit_scaling.transforms.utils.replace_node_with_function", "generated/unit_scaling.transforms.utils.torch_nn_modules_to_user_modules", "generated/unit_scaling.utils", "generated/unit_scaling.utils.ScalePair", "generated/unit_scaling.utils.ScaleTracker", "generated/unit_scaling.utils.ScaleTrackingInterpreter", "generated/unit_scaling.utils.analyse_module", "generated/unit_scaling.visualiser", "index", "limitations", "posts/almost_scaled_dot_product_attention", "user_guide"], "filenames": ["api_reference.rst", "blog.rst", "development.rst", "generated/unit_scaling.rst", "generated/unit_scaling.CrossEntropyLoss.rst", "generated/unit_scaling.Dropout.rst", "generated/unit_scaling.Embedding.rst", "generated/unit_scaling.GELU.rst", "generated/unit_scaling.LayerNorm.rst", "generated/unit_scaling.Linear.rst", "generated/unit_scaling.MHSA.rst", "generated/unit_scaling.MLP.rst", "generated/unit_scaling.Softmax.rst", "generated/unit_scaling.TransformerDecoder.rst", "generated/unit_scaling.TransformerLayer.rst", "generated/unit_scaling.analysis.rst", "generated/unit_scaling.analysis.example_batch.rst", "generated/unit_scaling.analysis.graph_to_dataframe.rst", "generated/unit_scaling.analysis.plot.rst", "generated/unit_scaling.analysis.visualiser.rst", "generated/unit_scaling.constraints.rst", "generated/unit_scaling.constraints.amean.rst", "generated/unit_scaling.constraints.apply_constraint.rst", "generated/unit_scaling.constraints.gmean.rst", "generated/unit_scaling.constraints.hmean.rst", "generated/unit_scaling.constraints.to_grad_input_scale.rst", "generated/unit_scaling.constraints.to_left_grad_scale.rst", "generated/unit_scaling.constraints.to_output_scale.rst", "generated/unit_scaling.constraints.to_right_grad_scale.rst", "generated/unit_scaling.formats.rst", "generated/unit_scaling.formats.FPFormat.rst", "generated/unit_scaling.formats.format_to_tuple.rst", "generated/unit_scaling.formats.tuple_to_format.rst", "generated/unit_scaling.functional.rst", "generated/unit_scaling.functional.add.rst", "generated/unit_scaling.functional.cross_entropy.rst", "generated/unit_scaling.functional.dropout.rst", "generated/unit_scaling.functional.embedding.rst", "generated/unit_scaling.functional.gelu.rst", "generated/unit_scaling.functional.layer_norm.rst", "generated/unit_scaling.functional.linear.rst", "generated/unit_scaling.functional.matmul.rst", "generated/unit_scaling.functional.residual_add.rst", "generated/unit_scaling.functional.residual_split.rst", "generated/unit_scaling.functional.scale_elementwise.rst", "generated/unit_scaling.functional.scaled_dot_product_attention.rst", "generated/unit_scaling.functional.softmax.rst", "generated/unit_scaling.scale.rst", "generated/unit_scaling.scale.scale_bwd.rst", "generated/unit_scaling.scale.scale_fwd.rst", "generated/unit_scaling.transforms.rst", "generated/unit_scaling.transforms.Metrics.rst", "generated/unit_scaling.transforms.compile.rst", "generated/unit_scaling.transforms.prune_non_float_tensors.rst", "generated/unit_scaling.transforms.prune_same_scale_tensors.rst", "generated/unit_scaling.transforms.prune_selected_nodes.rst", "generated/unit_scaling.transforms.simulate_format.rst", "generated/unit_scaling.transforms.simulate_fp8.rst", "generated/unit_scaling.transforms.track_scales.rst", "generated/unit_scaling.transforms.unit_scale.rst", "generated/unit_scaling.transforms.utils.rst", "generated/unit_scaling.transforms.utils.apply_transform.rst", "generated/unit_scaling.transforms.utils.patch_to_expand_modules.rst", "generated/unit_scaling.transforms.utils.replace_node_with_function.rst", "generated/unit_scaling.transforms.utils.torch_nn_modules_to_user_modules.rst", "generated/unit_scaling.utils.rst", "generated/unit_scaling.utils.ScalePair.rst", "generated/unit_scaling.utils.ScaleTracker.rst", "generated/unit_scaling.utils.ScaleTrackingInterpreter.rst", "generated/unit_scaling.utils.analyse_module.rst", "generated/unit_scaling.visualiser.rst", "index.rst", "limitations.rst", "posts/almost_scaled_dot_product_attention.md", "user_guide.rst"], "titles": ["<span class=\"section-number\">5. </span>API reference", "<span class=\"section-number\">4. </span>Unit Scaling blog", "<span class=\"section-number\">2. </span>Unit Scaling", "<span class=\"section-number\">5.1. </span>unit_scaling", "<span class=\"section-number\">5.1.5. </span>unit_scaling.CrossEntropyLoss", "<span class=\"section-number\">5.1.6. </span>unit_scaling.Dropout", "<span class=\"section-number\">5.1.7. </span>unit_scaling.Embedding", "<span class=\"section-number\">5.1.2. </span>unit_scaling.GELU", "<span class=\"section-number\">5.1.8. </span>unit_scaling.LayerNorm", "<span class=\"section-number\">5.1.9. </span>unit_scaling.Linear", "<span class=\"section-number\">5.1.3. </span>unit_scaling.MHSA", "<span class=\"section-number\">5.1.4. </span>unit_scaling.MLP", "<span class=\"section-number\">5.1.10. </span>unit_scaling.Softmax", "<span class=\"section-number\">5.1.11. </span>unit_scaling.TransformerDecoder", "<span class=\"section-number\">5.1.12. </span>unit_scaling.TransformerLayer", "<span class=\"section-number\">5.2. </span>unit_scaling.analysis", "<span class=\"section-number\">5.2.1. </span>unit_scaling.analysis.example_batch", "<span class=\"section-number\">5.2.2. </span>unit_scaling.analysis.graph_to_dataframe", "<span class=\"section-number\">5.2.3. </span>unit_scaling.analysis.plot", "<span class=\"section-number\">5.2.4. </span>unit_scaling.analysis.visualiser", "<span class=\"section-number\">5.3. </span>unit_scaling.constraints", "<span class=\"section-number\">5.3.1. </span>unit_scaling.constraints.amean", "<span class=\"section-number\">5.3.2. </span>unit_scaling.constraints.apply_constraint", "<span class=\"section-number\">5.3.3. </span>unit_scaling.constraints.gmean", "<span class=\"section-number\">5.3.4. </span>unit_scaling.constraints.hmean", "<span class=\"section-number\">5.3.5. </span>unit_scaling.constraints.to_grad_input_scale", "<span class=\"section-number\">5.3.6. </span>unit_scaling.constraints.to_left_grad_scale", "<span class=\"section-number\">5.3.7. </span>unit_scaling.constraints.to_output_scale", "<span class=\"section-number\">5.3.8. </span>unit_scaling.constraints.to_right_grad_scale", "<span class=\"section-number\">5.4. </span>unit_scaling.formats", "<span class=\"section-number\">5.4.3. </span>unit_scaling.formats.FPFormat", "<span class=\"section-number\">5.4.1. </span>unit_scaling.formats.format_to_tuple", "<span class=\"section-number\">5.4.2. </span>unit_scaling.formats.tuple_to_format", "<span class=\"section-number\">5.5. </span>unit_scaling.functional", "<span class=\"section-number\">5.5.1. </span>unit_scaling.functional.add", "<span class=\"section-number\">5.5.2. </span>unit_scaling.functional.cross_entropy", "<span class=\"section-number\">5.5.3. </span>unit_scaling.functional.dropout", "<span class=\"section-number\">5.5.4. </span>unit_scaling.functional.embedding", "<span class=\"section-number\">5.5.5. </span>unit_scaling.functional.gelu", "<span class=\"section-number\">5.5.6. </span>unit_scaling.functional.layer_norm", "<span class=\"section-number\">5.5.7. </span>unit_scaling.functional.linear", "<span class=\"section-number\">5.5.8. </span>unit_scaling.functional.matmul", "<span class=\"section-number\">5.5.9. </span>unit_scaling.functional.residual_add", "<span class=\"section-number\">5.5.10. </span>unit_scaling.functional.residual_split", "<span class=\"section-number\">5.5.11. </span>unit_scaling.functional.scale_elementwise", "<span class=\"section-number\">5.5.12. </span>unit_scaling.functional.scaled_dot_product_attention", "<span class=\"section-number\">5.5.13. </span>unit_scaling.functional.softmax", "<span class=\"section-number\">5.6. </span>unit_scaling.scale", "<span class=\"section-number\">5.6.1. </span>unit_scaling.scale.scale_bwd", "<span class=\"section-number\">5.6.2. </span>unit_scaling.scale.scale_fwd", "<span class=\"section-number\">5.7. </span>unit_scaling.transforms", "<span class=\"section-number\">5.7.9. </span>unit_scaling.transforms.Metrics", "<span class=\"section-number\">5.7.1. </span>unit_scaling.transforms.compile", "<span class=\"section-number\">5.7.2. </span>unit_scaling.transforms.prune_non_float_tensors", "<span class=\"section-number\">5.7.3. </span>unit_scaling.transforms.prune_same_scale_tensors", "<span class=\"section-number\">5.7.4. </span>unit_scaling.transforms.prune_selected_nodes", "<span class=\"section-number\">5.7.5. </span>unit_scaling.transforms.simulate_format", "<span class=\"section-number\">5.7.6. </span>unit_scaling.transforms.simulate_fp8", "<span class=\"section-number\">5.7.7. </span>unit_scaling.transforms.track_scales", "<span class=\"section-number\">5.7.8. </span>unit_scaling.transforms.unit_scale", "<span class=\"section-number\">5.8. </span>unit_scaling.transforms.utils", "<span class=\"section-number\">5.8.1. </span>unit_scaling.transforms.utils.apply_transform", "<span class=\"section-number\">5.8.2. </span>unit_scaling.transforms.utils.patch_to_expand_modules", "<span class=\"section-number\">5.8.3. </span>unit_scaling.transforms.utils.replace_node_with_function", "<span class=\"section-number\">5.8.4. </span>unit_scaling.transforms.utils.torch_nn_modules_to_user_modules", "<span class=\"section-number\">5.9. </span>unit_scaling.utils", "<span class=\"section-number\">5.9.2. </span>unit_scaling.utils.ScalePair", "<span class=\"section-number\">5.9.3. </span>unit_scaling.utils.ScaleTracker", "<span class=\"section-number\">5.9.4. </span>unit_scaling.utils.ScaleTrackingInterpreter", "<span class=\"section-number\">5.9.1. </span>unit_scaling.utils.analyse_module", "<span class=\"section-number\">5.1.1. </span>unit_scaling.visualiser", "Unit Scaling", "<span class=\"section-number\">3. </span>Limitations", "Almost-scaled dot-product attention", "<span class=\"section-number\">1. </span>User guide"], "terms": {"unit": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 20, 23, 33, 34, 35, 36, 37, 38, 39, 40, 41, 43, 45, 46, 50, 52, 56, 57, 58, 59, 65, 69, 72, 73], "scale": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 50, 52, 53, 54, 56, 57, 58, 59, 65, 69, 70, 72], "i": [0, 4, 5, 6, 7, 8, 9, 12, 13, 16, 17, 18, 19, 22, 27, 35, 36, 37, 38, 40, 41, 42, 43, 45, 46, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 63, 64, 67, 68, 70, 71, 72, 73], "implement": [0, 2, 5, 8, 10, 11, 12, 13, 14, 19, 45, 52, 59, 61, 69, 70, 71, 74], "us": [0, 2, 4, 6, 7, 8, 9, 10, 13, 14, 16, 17, 19, 20, 22, 24, 30, 36, 37, 41, 42, 43, 45, 46, 50, 51, 52, 54, 56, 57, 58, 59, 61, 62, 64, 67, 68, 69, 70, 71, 72, 73, 74], "thin": 0, "wrapper": [0, 59, 61], "around": [0, 59, 61, 72], "exist": [0, 59, 67, 74], "torch": [0, 3, 4, 5, 6, 7, 8, 9, 12, 17, 18, 19, 33, 34, 35, 37, 41, 45, 46, 50, 52, 56, 57, 58, 59, 61, 62, 64, 67, 69, 70, 72, 74], "nn": [0, 3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 14, 17, 18, 19, 33, 37, 45, 52, 56, 57, 59, 61, 62, 64, 67, 68, 69, 70, 74], "class": [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 29, 30, 35, 37, 46, 50, 51, 59, 64, 65, 66, 67, 68, 69, 74], "function": [0, 3, 5, 7, 9, 10, 11, 12, 13, 14, 15, 17, 18, 20, 22, 29, 47, 50, 52, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 67, 68, 69, 71, 72, 74], "document": [0, 2, 6, 12, 74], "also": [0, 4, 58, 59, 67, 73, 74], "inherit": 0, "from": [0, 5, 6, 8, 9, 12, 16, 18, 19, 36, 37, 52, 53, 54, 56, 57, 58, 59, 61, 67, 68, 69, 70, 74], "standard": [0, 8, 12, 19, 29, 42, 43, 52, 57, 59, 61, 66, 67, 68, 69, 70, 74], "pytorch": [0, 2, 15, 45, 52, 59, 67, 74], "doc": [0, 2, 72], "modif": [0, 67], "note": [0, 2, 4, 6, 13, 35, 37, 41, 45, 52, 58, 59, 61, 67, 74], "some": [0, 2, 4, 35, 40, 41, 45, 59, 71, 73, 74], "mai": [0, 2, 4, 19, 40, 41, 43, 45, 52, 54, 58, 59, 67, 70, 71, 72, 74], "longer": 0, "relev": [0, 8, 18, 19, 70], "ar": [0, 1, 4, 5, 8, 9, 12, 18, 19, 35, 37, 41, 43, 45, 51, 54, 56, 57, 58, 59, 61, 67, 68, 70, 73, 74], "nevertheless": 0, "The": [0, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 17, 18, 22, 30, 34, 35, 37, 38, 40, 41, 43, 44, 45, 46, 52, 53, 54, 56, 57, 58, 59, 61, 67, 68, 71, 73, 74], "built": [0, 69], "mirror": 0, "close": 0, "possibl": [0, 37, 74], "can": [0, 2, 4, 5, 6, 18, 43, 45, 52, 54, 58, 59, 67, 68, 71, 72, 73, 74], "easili": 0, "swap": [0, 74], "out": [0, 2, 5, 9, 34, 40, 41, 42, 67, 71, 73, 74], "equival": [0, 4, 6, 8, 45, 56, 57, 59, 67, 69, 74], "For": [0, 2, 6, 8, 19, 41, 42, 43, 45, 58, 67, 70, 71, 73, 74], "code": [0, 19, 69, 70, 74], "which": [0, 4, 8, 11, 12, 19, 43, 45, 46, 53, 54, 55, 56, 57, 58, 59, 61, 62, 63, 67, 68, 70, 73, 74], "follow": [0, 2, 4, 19, 41, 44, 45, 52, 58, 62, 67, 70, 71, 73, 74], "import": [0, 18, 52, 53, 54, 58, 59, 73, 74], "f": [0, 35, 37, 44, 45, 74], "appli": [0, 4, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 22, 34, 35, 36, 38, 39, 40, 41, 42, 43, 44, 45, 46, 48, 49, 52, 53, 54, 59, 61, 62, 67, 73, 74], "first": [0, 2, 6, 41, 44, 52, 61, 67, 68, 74], "ad": [0, 8, 45, 58, 72, 73, 74], "unit_sc": [0, 71, 72, 74], "uu": [0, 74], "u": [0, 9, 59, 69, 74], "replac": [0, 59, 63, 74], "letter": 0, "those": [0, 4, 35, 56, 57, 71, 74], "assum": [0, 25, 26, 27, 28, 45, 73, 74], "thei": [0, 1, 2, 18, 19, 59, 67, 70, 71, 73, 74], "support": [0, 2, 4, 5, 6, 7, 9, 19, 34, 35, 36, 37, 40, 41, 45, 52, 59, 61, 67, 70], "click": 0, "below": [0, 8, 12, 35, 74], "full": [0, 16, 58, 67, 73, 74], "transform": [1, 8, 9, 13, 14, 17, 18, 19, 40, 42, 43, 44, 70, 71, 72, 73, 74], "seem": [1, 73], "all": [1, 6, 9, 17, 18, 19, 37, 45, 46, 53, 54, 55, 59, 67, 70, 73, 74], "you": [1, 4, 40, 41, 45, 67, 68, 72, 73, 74], "need": [1, 4, 43, 52, 58, 67, 69, 73, 74], "we": [1, 2, 19, 54, 57, 59, 61, 67, 68, 70, 71, 72, 73, 74], "don": [1, 18, 19, 53, 54, 70, 73, 74], "t": [1, 6, 18, 19, 32, 37, 40, 52, 53, 54, 59, 61, 62, 64, 67, 70, 72, 73, 74], "fulli": [1, 68, 73], "understand": [1, 73, 74], "why": [1, 45, 73, 74], "work": [1, 2, 19, 42, 43, 45, 52, 60, 69, 70, 71, 72, 74], "so": [1, 12, 45, 46, 52, 58, 59, 61, 67, 68, 73, 74], "well": [1, 4, 42, 43, 72, 73, 74], "while": [1, 67, 73], "notic": [1, 2, 40, 41, 73], "someth": [1, 73, 74], "surpris": [1, 73], "about": [1, 51, 73], "heart": [1, 73], "architectur": [1, 4, 35, 73], "how": [1, 2, 67, 71, 73], "output": [1, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 18, 19, 25, 26, 27, 28, 34, 35, 37, 38, 40, 41, 44, 45, 46, 53, 67, 68, 69, 70, 73, 74], "dougla": [1, 73], "orr": [1, 73], "octob": [1, 73], "2023": [1, 2, 71, 73, 74], "A": [2, 4, 5, 6, 10, 11, 12, 13, 14, 35, 37, 41, 45, 46, 51, 52, 71, 73, 74], "librari": [2, 58, 59, 71, 72, 74], "base": [2, 19, 40, 45, 67, 70, 74], "paper": [2, 5, 8, 59, 71, 73, 74], "box": [2, 68, 71, 74], "low": [2, 71, 74], "precis": [2, 9, 41, 45, 71, 74], "train": [2, 4, 5, 6, 8, 36, 37, 43, 45, 71, 72, 73, 74], "found": [2, 71, 73, 74], "http": [2, 14, 71, 74], "graphcor": [2, 71, 73, 74], "research": [2, 71, 74], "github": [2, 71, 74], "io": 2, "current": [2, 13, 19, 45, 52, 59, 61, 68, 70, 71, 72, 74], "its": [2, 41, 44, 49, 51, 52, 63, 67, 71, 74], "beta": [2, 8, 40, 41, 45, 71, 74], "releas": [2, 52, 71, 74], "featur": [2, 5, 40, 41, 71, 72, 74], "have": [2, 4, 6, 17, 18, 37, 40, 41, 43, 53, 54, 56, 57, 58, 59, 67, 71, 72, 73, 74], "yet": [2, 59, 71, 73, 74], "occasion": [2, 71, 74], "bug": [2, 71, 72, 74], "present": [2, 63, 71, 74], "re": [2, 19, 46, 70, 71, 72, 73, 74], "keen": [2, 71, 72, 74], "help": [2, 71, 72, 73, 74], "user": [2, 19, 45, 56, 57, 58, 59, 61, 64, 67, 70, 71], "ani": [2, 5, 7, 9, 12, 18, 19, 27, 40, 45, 55, 58, 59, 61, 62, 63, 67, 68, 69, 70, 71, 72, 74], "problem": [2, 4, 71, 74], "encount": [2, 71, 74], "To": [2, 64, 68, 71, 74], "run": [2, 17, 18, 45, 56, 57, 68, 71, 74], "pip": [2, 71, 74], "git": [2, 71, 74], "com": [2, 71, 74], "demonstr": [2, 13, 71], "an": [2, 4, 5, 6, 8, 9, 11, 12, 16, 17, 18, 19, 27, 36, 37, 41, 43, 44, 45, 53, 54, 55, 56, 58, 59, 66, 67, 68, 70, 73, 74], "overview": [2, 71, 74], "see": [2, 4, 6, 7, 9, 10, 11, 12, 13, 14, 34, 35, 36, 37, 38, 39, 40, 41, 44, 45, 46, 59, 67, 68, 71, 72, 73, 74], "fp8": [2, 57, 71, 74], "notebook": [2, 71, 73, 74], "show": [2, 18, 71, 74], "nanogpt": [2, 71], "model": [2, 15, 18, 19, 43, 53, 54, 56, 57, 58, 59, 65, 70, 71, 73], "more": [2, 6, 37, 45, 46, 58, 67, 72, 73, 74], "depth": [2, 74], "explan": [2, 73], "consult": 2, "our": [2, 59, 61, 67, 71, 72, 73, 74], "And": 2, "practic": [2, 18, 58, 62, 74], "introduct": [2, 74], "guid": [2, 59, 71], "who": [2, 71, 72, 74], "wish": [2, 61, 71, 74], "thi": [2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 22, 30, 34, 36, 37, 38, 40, 41, 43, 44, 45, 46, 52, 53, 54, 56, 57, 58, 59, 61, 62, 64, 67, 68, 70, 71, 72, 73, 74], "codebas": [2, 71, 74], "setup": 2, "requir": [2, 4, 45, 58, 59, 67, 74], "time": [2, 8, 34, 41, 74], "python3": [2, 69], "m": [2, 5, 7, 9, 12, 41, 52, 56, 57, 58, 59, 61], "venv": 2, "sourc": [2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 28, 30, 31, 32, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 48, 49, 51, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 63, 64, 66, 67, 68, 69, 70], "bin": 2, "activ": [2, 8, 11, 13, 14, 56, 73, 74], "r": [2, 6, 37, 67], "dev": 2, "txt": 2, "Or": 2, "ipu": 2, "subsequ": 2, "pre": [2, 68, 74], "flight": 2, "check": [2, 67, 73, 74], "command": 2, "id": [2, 16], "recommend": [2, 19, 23, 42, 43, 70, 71, 74], "python": [2, 69], "intepret": 2, "set": [2, 4, 5, 8, 9, 35, 36, 45, 51, 55, 58, 59, 67, 74], "format": [2, 56, 57, 71, 74], "save": [2, 67], "enabl": [2, 45, 47, 59, 61, 67, 74], "consid": [2, 4, 73, 74], "env": [2, 67], "file": 2, "pythonpath": 2, "exampl": [2, 4, 5, 6, 7, 8, 9, 12, 13, 34, 35, 37, 41, 45, 67, 68, 69, 72, 73, 74], "echo": 2, "pwd": 2, "differ": [2, 9, 19, 37, 41, 43, 45, 47, 52, 61, 70, 73, 74], "path": [2, 16, 19, 70], "devcontain": 2, "cd": 2, "make": [2, 18, 45, 59, 61, 64, 73, 74], "html": 2, "view": [2, 18], "_build": 2, "index": [2, 4, 6, 37, 67], "your": [2, 67, 74], "browser": 2, "copyright": 2, "c": [2, 4, 8, 34, 35, 45, 67], "ltd": 2, "under": [2, 37, 73], "apach": 2, "2": [2, 5, 6, 7, 8, 12, 34, 37, 38, 40, 41, 45, 54, 67, 69, 74], "0": [2, 4, 5, 6, 7, 8, 12, 13, 14, 30, 34, 35, 36, 37, 38, 42, 43, 45, 46, 67, 69, 73, 74], "md": 2, "further": [2, 73, 74], "detail": [2, 6, 7, 9, 10, 11, 12, 13, 14, 34, 35, 36, 37, 38, 39, 40, 41, 44, 46, 59, 67, 68, 72, 74], "version": [3, 19, 33, 41, 44, 52, 58, 59, 61, 62, 64, 70, 74], "common": [3, 20, 33, 34, 72, 74], "modul": [3, 5, 6, 8, 9, 11, 13, 14, 17, 18, 19, 22, 37, 41, 50, 52, 53, 54, 56, 57, 58, 59, 61, 62, 64, 68, 69, 70, 73, 74], "weight": [4, 6, 8, 9, 13, 14, 35, 37, 39, 40, 42, 43, 45, 56, 59, 69, 73, 74], "tensor": [4, 6, 9, 12, 16, 18, 19, 30, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 48, 49, 51, 53, 54, 58, 61, 66, 67, 68, 69, 70, 73, 74], "none": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 18, 22, 34, 35, 37, 38, 39, 40, 41, 44, 45, 46, 63, 64, 66, 67, 68, 69, 74], "size_averag": [4, 35], "ignore_index": [4, 35], "int": [4, 6, 8, 9, 10, 11, 12, 13, 14, 16, 19, 30, 31, 32, 34, 35, 37, 39, 46, 51, 67, 68, 70, 74], "100": [4, 35], "reduc": [4, 35, 56, 57], "reduct": [4, 35], "str": [4, 7, 9, 10, 11, 12, 13, 14, 16, 18, 19, 22, 30, 34, 35, 38, 40, 41, 44, 46, 55, 68, 69, 70], "mean": [4, 5, 7, 8, 9, 12, 18, 21, 23, 24, 35, 40, 52, 74], "label_smooth": [4, 35], "float": [4, 5, 6, 8, 10, 13, 14, 18, 19, 21, 22, 23, 24, 25, 26, 27, 28, 30, 34, 35, 36, 37, 39, 42, 43, 44, 45, 48, 49, 51, 53, 54, 58, 66, 68, 70, 74], "comput": [4, 5, 6, 8, 12, 21, 23, 24, 35, 37, 45, 46, 67, 74], "cross": [4, 35, 74], "entropi": [4, 35, 74], "loss": [4, 18, 19, 35, 53, 54, 58, 70, 74], "between": [4, 18, 35, 43, 74], "input": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 17, 18, 19, 25, 26, 27, 28, 34, 35, 36, 37, 38, 39, 40, 41, 43, 44, 45, 46, 48, 49, 54, 57, 58, 59, 67, 68, 69, 70, 73, 74], "logit": [4, 35], "target": [4, 35, 55, 63, 68, 74], "It": [4, 19, 46, 67, 70, 73, 74], "when": [4, 7, 8, 9, 12, 35, 38, 41, 45, 56, 57, 58, 62, 64, 68, 73, 74], "classif": 4, "If": [4, 5, 6, 8, 9, 35, 36, 37, 40, 41, 45, 46, 56, 57, 67, 68, 73], "provid": [4, 19, 21, 23, 24, 25, 26, 27, 28, 45, 54, 58, 59, 70, 72, 74], "option": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 18, 19, 22, 34, 37, 38, 40, 41, 42, 43, 44, 45, 46, 51, 54, 59, 61, 63, 67, 68, 69, 70], "argument": [4, 7, 38, 41, 45, 67, 68, 74], "should": [4, 12, 35, 42, 43, 44, 45, 56, 57, 58, 59, 61, 62, 67, 68, 69, 74], "1d": 4, "assign": 4, "each": [4, 5, 6, 8, 9, 18, 19, 35, 37, 45, 56, 57, 58, 67, 68, 69, 70, 74], "particularli": [4, 74], "unbalanc": 4, "expect": [4, 8, 37, 56, 57, 74], "contain": [4, 6, 17, 35, 37, 51, 53, 56, 57, 58, 63, 66, 67, 73, 74], "unnorm": [4, 35], "do": [4, 5, 6, 36, 37, 67, 68, 74], "posit": [4, 13, 68], "sum": [4, 12, 35, 46, 73], "1": [4, 5, 6, 7, 8, 9, 12, 34, 35, 37, 38, 41, 42, 43, 45, 46, 54, 67, 69, 71, 74], "gener": [4, 16, 17, 18, 19, 30, 53, 54, 59, 69, 70, 74], "ha": [4, 5, 8, 22, 35, 41, 45, 58, 59, 67, 73, 74], "size": [4, 6, 8, 9, 10, 11, 13, 14, 16, 19, 35, 37, 45, 67, 70], "unbatch": 4, "minibatch": [4, 35], "d_1": [4, 35], "d_2": [4, 35], "d_k": [4, 35], "k": [4, 9, 35, 41, 73], "geq": [4, 35], "dimension": [4, 6, 8, 12, 35, 41], "case": [4, 7, 9, 10, 11, 12, 13, 14, 19, 34, 35, 38, 40, 41, 44, 46, 54, 59, 62, 64, 70, 73, 74], "last": [4, 8, 9, 39, 52], "being": [4, 6, 35, 43, 52, 61, 67, 68], "higher": [4, 45], "dimens": [4, 6, 7, 8, 9, 10, 11, 12, 13, 14, 39, 40, 41, 46, 67], "per": [4, 8, 35, 67], "pixel": 4, "2d": 4, "imag": [4, 8], "criterion": 4, "either": [4, 35, 67], "indic": [4, 6, 18, 19, 35, 37, 45, 67, 70], "rang": [4, 12, 19, 46, 52, 56, 57, 59, 68, 70, 74], "where": [4, 6, 7, 8, 9, 12, 35, 37, 38, 40, 41, 45, 56, 58, 59, 68, 74], "number": [4, 7, 9, 10, 12, 13, 14, 16, 27, 29, 30, 34, 35, 37, 39, 40, 74], "specifi": [4, 6, 35, 37, 45, 46, 54, 58, 67, 74], "accept": [4, 67], "necessarili": 4, "unreduc": 4, "e": [4, 6, 8, 37, 41, 42, 43, 45, 52, 53, 54, 58, 67], "describ": [4, 5, 8, 35], "ell": 4, "x": [4, 7, 8, 18, 30, 38, 59, 67, 69, 74], "y": [4, 8, 40, 67], "l": [4, 45], "l_1": 4, "dot": [4, 41, 45, 71], "l_n": 4, "top": [4, 59], "quad": 4, "w_": 4, "y_n": 4, "log": [4, 73, 74], "frac": [4, 5, 8, 9, 12, 45, 46], "exp": [4, 12, 46], "x_": [4, 12, 46], "n": [4, 6, 8, 12, 35, 41, 45, 68, 73], "sum_": 4, "cdot": [4, 73], "mathbb": 4, "text": [4, 6, 7, 8, 9, 12, 16, 34, 35, 38, 46], "ignor": [4, 35, 74], "_index": 4, "w": [4, 6, 8, 37, 67], "span": 4, "default": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 18, 19, 34, 35, 36, 37, 38, 40, 41, 42, 43, 44, 45, 46, 54, 59, 61, 62, 63, 64, 67, 69, 70, 74], "begin": [4, 35, 74], "end": [4, 35, 74], "logsoftmax": 4, "nllloss": 4, "probabl": [4, 5, 10, 13, 14, 35, 36, 45], "label": [4, 16, 19, 70], "beyond": [4, 74], "singl": [4, 8, 52, 73], "item": 4, "blend": 4, "smooth": [4, 35], "etc": 4, "w_c": 4, "y_": 4, "perform": [4, 45, 46, 67, 74], "better": [4, 45, 59, 73], "allow": [4, 43, 52, 73, 74], "optim": [4, 45, 52, 61, 62], "onli": [4, 8, 19, 25, 26, 27, 28, 30, 35, 41, 45, 48, 49, 52, 53, 56, 57, 58, 61, 67, 68, 70, 72, 74], "too": [4, 45, 56, 57], "restrict": [4, 41], "paramet": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 28, 34, 35, 36, 37, 40, 41, 42, 43, 44, 45, 46, 48, 49, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 63, 68, 69, 70], "manual": [4, 35, 52, 59, 74], "rescal": [4, 12, 35], "given": [4, 6, 16, 30, 32, 35, 37, 45, 53, 54, 55, 56, 57, 63, 67, 69, 74], "point": [4, 18, 19, 30, 37, 45, 53, 54, 58, 70, 74], "dtype": [4, 6, 8, 9, 35, 40, 41, 45, 46, 67, 68], "bool": [4, 5, 6, 8, 9, 18, 19, 35, 36, 37, 45, 63, 67, 68, 69, 70], "deprec": [4, 35], "By": [4, 35, 59, 62, 64, 74], "averag": [4, 35], "over": [4, 8, 35, 45, 59, 67, 73, 74], "element": [4, 5, 8, 12, 35, 36, 38, 44, 45, 46, 73], "batch": [4, 6, 8, 16, 19, 35, 37, 41, 70], "multipl": [4, 35, 41, 48, 49, 54, 74], "sampl": [4, 5, 6, 9, 16, 35, 36, 37], "field": [4, 35], "fals": [4, 5, 6, 8, 9, 18, 35, 36, 37, 45, 67, 69], "instead": [4, 35], "true": [4, 5, 6, 8, 9, 18, 19, 35, 36, 37, 45, 56, 57, 63, 67, 68, 69, 70], "valu": [4, 6, 8, 9, 12, 18, 19, 30, 35, 42, 43, 45, 53, 56, 57, 59, 67, 68, 70, 73, 74], "doe": [4, 6, 35, 41, 52, 61, 74], "contribut": [4, 6, 35, 37], "gradient": [4, 6, 7, 9, 10, 11, 12, 13, 14, 25, 26, 27, 28, 34, 35, 37, 38, 40, 41, 43, 44, 46, 51, 56, 59, 67, 73, 74], "non": [4, 6, 29, 30, 35, 37, 41, 43, 54, 67, 74], "applic": [4, 35, 67], "observ": [4, 35], "depend": [4, 18, 35, 41, 45, 59, 68, 73, 74], "return": [4, 12, 16, 17, 18, 19, 21, 22, 23, 24, 25, 26, 27, 28, 32, 35, 41, 42, 43, 44, 45, 46, 48, 49, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 67, 68, 69, 70, 74], "taken": [4, 74], "process": [4, 6, 35, 53, 59, 68], "meantim": [4, 35], "two": [4, 25, 35, 41, 43, 45, 52, 67, 74], "arg": [4, 19, 35, 44, 63, 67, 68, 70], "overrid": [4, 35, 67], "amount": [4, 35], "becom": [4, 35], "mixtur": [4, 35], "origin": [4, 35, 49, 68, 73], "ground": [4, 35], "truth": [4, 35], "uniform": [4, 35], "distribut": [4, 5, 7, 35, 36, 38, 72, 73, 74], "rethink": [4, 35], "incept": [4, 35], "vision": [4, 35], "shape": [4, 5, 6, 7, 8, 9, 12, 34, 35, 37, 40, 45, 67], "same": [4, 5, 7, 8, 9, 12, 35, 41, 45, 54, 56, 57, 67, 73, 74], "otherwis": [4, 67], "scalar": [4, 8, 41, 48, 49, 66, 74], "align": [4, 35], "randn": [4, 5, 7, 8, 9, 12, 34, 35, 69, 74], "3": [4, 6, 7, 8, 12, 34, 35, 37, 38, 74], "5": [4, 5, 6, 7, 8, 13, 14, 34, 35, 36, 37, 38, 42, 43, 71, 74], "requires_grad": [4, 6, 35, 67], "empti": 4, "long": 4, "random_": 4, "backward": [4, 9, 17, 18, 19, 30, 35, 41, 43, 47, 48, 51, 53, 54, 56, 57, 58, 59, 66, 67, 68, 69, 70, 73, 74], "softmax": [4, 10, 13, 14, 35, 45, 71, 73, 74], "dim": [4, 12, 35, 45, 46], "p": [5, 6, 36, 37, 41], "inplac": [5, 36, 67, 69], "zero": [5, 6, 8, 36, 37, 45, 59, 67], "chosen": [5, 25, 26, 27, 28, 45], "independ": [5, 59], "forward": [5, 17, 18, 19, 30, 47, 48, 49, 51, 52, 56, 57, 58, 59, 61, 62, 66, 67, 68, 69, 70, 73, 74], "call": [5, 17, 18, 19, 45, 52, 53, 54, 56, 57, 58, 59, 61, 62, 63, 64, 67, 68, 69, 70], "bernoulli": [5, 36], "channel": [5, 8], "everi": [5, 12, 67, 68], "proven": 5, "effect": [5, 56, 57, 73, 74], "techniqu": [5, 74], "regular": [5, 59], "prevent": [5, 46, 67], "co": 5, "adapt": [5, 74], "neuron": 5, "improv": [5, 45], "neural": 5, "network": 5, "detector": 5, "_": [5, 45, 67], "furthermor": 5, "factor": [5, 11, 25, 26, 27, 28, 43, 45, 47, 48, 49, 59, 73, 74], "dure": [5, 6, 18, 19, 37, 67, 70, 74], "evalu": [5, 8, 68, 74], "simpli": [5, 74], "ident": [5, 74], "oper": [5, 8, 18, 19, 20, 36, 40, 41, 45, 46, 47, 54, 59, 67, 69, 70, 72, 73, 74], "place": [5, 36, 37, 67, 74], "20": [5, 8, 9, 34], "16": [5, 54, 74], "num_embed": 6, "embedding_dim": [6, 8, 37], "padding_idx": [6, 37], "max_norm": [6, 37], "norm_typ": [6, 37], "scale_grad_by_freq": [6, 37], "spars": [6, 12, 37, 40, 41], "_weight": 6, "_freez": 6, "devic": [6, 8, 9, 40, 41, 45, 68], "lookup": [6, 37], "tabl": [6, 37], "look": [6, 37, 41, 68, 73, 74], "up": [6, 37, 67, 68, 73, 74], "fix": [6, 37, 73, 74], "dictionari": [6, 59], "often": [6, 37, 74], "store": [6, 68], "word": [6, 37], "retriev": [6, 22, 37, 67, 68], "them": [6, 12, 46, 59, 67, 68, 72], "list": [6, 8, 37, 61, 68, 72], "correspond": [6, 19, 22, 32, 37, 59, 67, 70], "vector": [6, 37, 41], "entri": [6, 37], "therefor": [6, 37], "updat": [6, 37, 74], "remain": [6, 37], "pad": [6, 37], "newli": 6, "construct": [6, 37], "anoth": 6, "norm": [6, 37], "larger": [6, 37, 59, 74], "than": [6, 37, 45, 52, 58, 59, 68], "renorm": [6, 37], "invers": [6, 37, 73], "frequenc": [6, 37], "mini": [6, 8, 37], "matrix": [6, 37, 41], "regard": [6, 37, 74], "learnabl": [6, 8, 9], "initi": [6, 8, 9, 37, 74], "mathcal": [6, 9], "type": [6, 9, 13, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 34, 37, 38, 42, 43, 44, 45, 46, 48, 49, 51, 52, 53, 54, 55, 56, 57, 58, 59, 61, 62, 63, 68, 69, 70], "inttensor": 6, "longtensor": [6, 37], "arbitrari": [6, 17, 18, 19, 37, 59, 66, 70, 74], "extract": [6, 37, 68], "h": [6, 8], "_dim": 6, "10": [6, 8, 34, 37, 69, 74], "4": [6, 11, 34, 37, 67, 69, 74], "9": [6, 37], "xdoctest": [6, 37, 67], "ignore_w": [6, 37], "determinist": [6, 37, 45], "0251": 6, "6902": 6, "7172": 6, "6431": 6, "0748": 6, "6969": 6, "4970": 6, "3448": 6, "9685": 6, "3677": 6, "7265": 6, "1685": 6, "4362": 6, "4004": 6, "9400": 6, "9124": 6, "3616": 6, "1151": 6, "0000": [6, 37], "1535": 6, "0309": 6, "9315": 6, "1655": 6, "9897": 6, "0635": 6, "chang": [6, 18, 45, 52, 54, 73, 74], "7895": 6, "7089": 6, "0364": 6, "6778": 6, "5803": 6, "2678": 6, "no_grad": 6, "ones": [6, 8, 37, 45], "classmethod": 6, "from_pretrain": 6, "freez": 6, "creat": 6, "instanc": [6, 8, 58], "floattensor": 6, "pass": [6, 17, 18, 19, 30, 43, 45, 47, 48, 49, 51, 56, 57, 58, 59, 62, 66, 67, 68, 69, 70, 73, 74], "second": [6, 41, 67], "get": [6, 72, 74], "learn": [6, 8, 9, 73, 74], "pretrain": 6, "6": [6, 34, 69], "1000": 6, "3000": 6, "approxim": [7, 11, 13, 14, 38, 74], "constraint": [7, 9, 10, 11, 12, 13, 14, 34, 38, 40, 41, 44, 46, 68, 71, 74], "gmean": [7, 9, 10, 11, 12, 13, 14, 34, 38, 40, 41, 44, 46, 71, 74], "gaussian": [7, 38], "error": [7, 18, 19, 38, 45, 67, 68, 70], "linear": [7, 38, 56, 57, 69, 71, 74], "phi": [7, 38], "cumul": [7, 38], "tanh": [7, 38], "estim": [7, 8, 38], "sqrt": [7, 8, 9, 38, 45], "pi": [7, 38], "044715": [7, 38], "algorithm": [7, 45], "name": [7, 9, 10, 11, 12, 13, 14, 16, 19, 22, 34, 38, 40, 41, 44, 46, 68, 70], "In": [7, 9, 10, 11, 12, 13, 14, 18, 34, 38, 40, 41, 43, 44, 45, 46, 59, 62, 67, 73, 74], "must": [7, 9, 10, 11, 12, 13, 14, 22, 34, 38, 40, 41, 44, 45, 46, 52, 53, 54, 67, 73, 74], "one": [7, 9, 10, 11, 12, 13, 14, 22, 34, 38, 40, 41, 44, 45, 46, 52, 67, 74], "hmean": [7, 9, 10, 11, 12, 13, 14, 34, 38, 40, 41, 44, 46, 71], "amean": [7, 9, 10, 11, 12, 13, 14, 34, 38, 40, 41, 44, 46, 71], "to_output_scal": [7, 9, 10, 11, 12, 13, 14, 34, 38, 40, 41, 44, 46, 71], "to_grad_input_scal": [7, 9, 11, 12, 38, 40, 44, 46, 71], "normalized_shap": [8, 39], "ep": [8, 39], "1e": [8, 39, 74], "05": [8, 39, 54, 74], "elementwise_affin": 8, "bia": [8, 9, 39, 40, 69, 74], "layer": [8, 9, 10, 11, 13, 14, 39, 42, 43, 52, 59, 74], "normal": [8, 30, 39, 73, 74], "mathrm": [8, 73], "var": 8, "epsilon": 8, "gamma": 8, "deviat": [8, 66, 67, 68, 69, 74], "calcul": 8, "d": [8, 40, 67, 69, 74], "affin": 8, "via": [8, 53, 54, 58, 59, 68, 74], "bias": [8, 59], "unbias": 8, "unlik": [8, 18, 19, 70, 74], "entir": [8, 74], "plane": 8, "statist": 8, "data": [8, 9, 16, 40, 46, 51, 68], "both": [8, 41, 45, 67, 69, 74], "mode": [8, 67], "_shape": 8, "ldot": 8, "integ": [8, 34, 67], "treat": [8, 12], "singleton": 8, "specif": [8, 45, 56, 57, 68], "denomin": 8, "numer": [8, 18, 19, 37, 50, 56, 57, 70, 74], "stabil": 8, "boolean": [8, 45, 67], "addit": [8, 9, 12, 34, 40, 58, 74], "nlp": 8, "sentence_length": 8, "embed": [8, 13, 71], "layer_norm": [8, 71], "three": [8, 26, 28, 45, 73], "spatial": 8, "shown": [8, 18, 74], "in_featur": 9, "out_featur": 9, "incom": [9, 40], "tensorfloat32": [9, 40, 41], "On": [9, 41], "certain": [9, 39, 41, 54, 68], "rocm": [9, 41], "float16": [9, 41, 45], "_featur": [9, 40], "h_": 9, "includ": [9, 40, 72, 73], "30": 9, "128": [9, 45], "print": [9, 69, 74], "hidden_s": [10, 11, 13, 14, 69], "head": [10, 13, 14, 73], "dropout_p": [10, 13, 14, 45], "multi": [10, 13, 14], "self": [10, 13, 14, 42, 43, 68, 69, 71, 74], "attent": [10, 13, 14, 16, 42, 43, 45, 71, 74], "warn": [10, 13, 14, 19, 45, 70], "here": [10, 13, 14, 45, 59, 61, 72, 74], "like": [10, 13, 14, 67, 74], "give": [10, 13, 14, 59, 71, 73, 74], "incorrect": [10, 13, 14, 67], "hidden": [10, 11, 13, 14], "post": [10, 13, 14, 73], "dropout": [10, 13, 14, 45, 71], "act_fn": [11, 13, 14], "gelu": [11, 13, 14, 59, 71, 74], "expansion_factor": 11, "": [11, 25, 26, 27, 28, 40, 41, 45, 58, 67, 68, 69, 73, 74], "intermedi": [11, 58, 68], "increas": [11, 45, 67], "rel": [11, 13, 14, 42, 43, 54, 73], "lie": [12, 46], "multipli": [12, 41, 73, 74], "li": 12, "adjust": 12, "accordingli": 12, "defin": [12, 22, 45, 46, 59, 67, 74], "x_i": [12, 46], "sum_j": [12, 46], "x_j": [12, 46], "unspecifi": 12, "inf": [12, 45], "along": [12, 16, 46, 74], "slice": [12, 46, 54, 68], "vocab_s": 13, "mhsa_tau": [13, 14], "01": [13, 14, 42, 43, 74], "mlp_tau": [13, 14], "decod": 13, "just": [13, 16, 67, 68, 73, 74], "lack": 13, "kei": [13, 45, 51, 58, 59, 71], "causal": [13, 45], "mask": [13, 16, 45], "usag": 13, "infer": 13, "token": [13, 16, 19, 70], "vocabulari": 13, "branch": [13, 14, 42, 43, 74], "skip": [13, 14, 42, 43, 67, 73, 74], "connect": [13, 14, 42, 43, 59, 73, 74], "mlp": [13, 14, 42, 43, 69, 71, 74], "prenorm": 14, "arxiv": 14, "org": 14, "ab": 14, "2002": 14, "04745": 14, "tool": [15, 74], "analys": [15, 69, 74], "other": [15, 34, 41, 45, 58, 72, 74], "metric": [15, 17, 18, 58, 71], "within": [15, 52, 61, 68, 74], "pretrainedtokenizerbas": [16, 19, 70], "batch_siz": [16, 19, 67, 70, 74], "seq_len": [16, 19, 70], "dataset_path": [16, 19, 70], "wikitext": [16, 19, 70], "dataset_nam": [16, 19, 70], "103": [16, 19, 70], "v1": [16, 19, 70], "shuffle_buffer_s": 16, "10000": 16, "seed": 16, "1472": 16, "tupl": [16, 22, 31, 32, 43, 63, 67, 68, 69, 74], "dataset": [16, 19, 70], "shift": 16, "sequenc": [16, 19, 39, 70, 73], "length": [16, 19, 70, 73], "huggingfac": [16, 19, 70], "visualis": [16, 18, 58, 71], "random": [16, 45, 67], "chunk": 16, "determin": [16, 41, 74], "10_000": 16, "shuffl": 16, "input_idx": 16, "attn_mask": [16, 19, 45, 70], "g": [17, 18, 53, 54, 58, 67, 73], "graph": [17, 18, 19, 53, 54, 55, 58, 59, 61, 62, 63, 64, 67, 68, 70], "datafram": 17, "convert": [17, 31, 64, 74], "fx": [17, 18, 52, 53, 54, 55, 58, 61, 62, 64, 68, 69, 74], "annot": [17, 69], "panda": 17, "indend": 17, "been": [17, 18, 22, 53, 54, 59, 67, 74], "track_scal": [17, 18, 19, 53, 54, 70, 71], "possibli": [17, 18], "scales_graph": [17, 18, 19, 53, 54, 58, 70], "result": [17, 18, 42, 43, 58, 68], "inform": [17, 45, 51, 54, 58], "intern": [17, 56, 57, 58], "plot": [17, 19, 58, 70, 71], "pd": 17, "titl": 18, "mean_ab": [18, 51], "prune_same_scal": 18, "show_arrow": 18, "show_error_bar": 18, "show_zero_tensor": 18, "xmin": 18, "xmax": 18, "ax": [18, 19, 70], "matplotlib": [18, 19, 70], "intend": [18, 54, 58, 66, 67], "inpt": [18, 53, 54, 58], "automat": [18, 19, 45, 58, 59, 62, 67, 69, 70, 74], "prune": [18, 19, 53, 54, 55, 70], "deem": [18, 19, 54, 70], "perspect": [18, 19, 70, 74], "faint": [18, 19, 70], "colour": [18, 19, 70], "horizont": [18, 19, 70], "line": [18, 19, 70, 74], "row": [18, 19, 37, 70], "repres": [18, 19, 51, 55, 58, 59, 61, 63, 66, 67, 68, 69, 70, 74], "bar": [18, 19, 70], "maximum": [18, 19, 30, 37, 70], "minimum": [18, 19, 30, 70], "seen": [18, 19, 70, 73, 74], "track": [18, 19, 53, 58, 70], "axi": 18, "abs_mean": [18, 51], "std": [18, 51], "abs_max": [18, 51], "abs_min": [18, 51], "numel": [18, 51], "reshap": [18, 54], "clearer": 18, "arrow": 18, "denot": [18, 74], "max": [18, 74], "min": [18, 74], "displai": 18, "plot_kwarg": [19, 70], "experiment": [19, 56, 57, 59, 70], "conveni": [19, 61, 70], "method": [19, 52, 53, 54, 56, 57, 58, 61, 67, 68, 69, 70, 71, 74], "combin": [19, 40, 41, 42, 52, 70, 74], "example_batch": [19, 70, 71], "wide": [19, 59, 70], "interfac": [19, 59, 61, 70], "futur": [19, 52, 67, 70], "now": [19, 58, 62, 67, 70, 74], "templat": [19, 70], "tracked_model": [19, 70], "keyword": [19, 45, 68, 70], "alias": 20, "arithmet": 21, "group": [21, 22, 23, 24], "constrain": [21, 23, 24, 59, 74], "constraint_nam": 22, "rais": [22, 45, 67], "valueerror": 22, "after": [22, 41, 59, 67], "geometr": [23, 74], "harmon": 24, "xavier": [24, 74], "glorot": [24, 74], "output_scal": [25, 26, 27, 28, 44, 74], "grad_input_scal": [25, 27, 44, 74], "select": [25, 26, 27, 28, 45, 73], "op": [25, 26, 27, 28, 52, 56, 57, 67, 68, 72, 74], "equal": [25, 26, 27, 28, 37, 74], "left_grad_scal": [26, 28], "right_grad_scal": [26, 28], "left": [26, 28, 41, 45, 74], "right": [26, 28, 41], "grad": [27, 44, 48, 49, 67, 74], "simul": [29, 56, 57], "exponent_bit": [30, 31, 32], "mantissa_bit": [30, 31, 32], "round": [30, 56, 57], "stochast": [30, 56, 57], "srbit": 30, "represent": [30, 56, 57], "properti": [30, 73], "bit": 30, "max_absolute_valu": 30, "absolut": 30, "min_absolute_norm": 30, "min_absolute_subnorm": 30, "subnorm": 30, "quantis": [30, 56, 57], "differenti": [30, 67], "quantise_bwd": 30, "quantise_fwd": 30, "fpformat": [31, 32, 56, 71], "alpha": 34, "_i": 34, "broadcast": [34, 41, 45], "promot": 34, "complex": [34, 68], "to_left_grad_scal": [34, 41, 71], "to_right_grad_scal": [34, 41, 71], "0202": 34, "0985": 34, "3506": 34, "6056": 34, "21": 34, "19": 34, "3944": 34, "b": [34, 40, 67], "9732": 34, "3497": 34, "6245": 34, "4022": 34, "3743": 34, "7724": 34, "5811": 34, "8017": 34, "7695": 34, "3930": 34, "3672": 34, "1450": 34, "18": 34, "6971": 34, "0736": 34, "17": 34, "0994": 34, "3216": 34, "7845": 34, "1610": 34, "1868": 34, "4090": 34, "8": [34, 45, 74], "9902": 34, "3667": 34, "7": 34, "3925": 34, "6147": 34, "crossentropyloss": [35, 71, 74], "predict": 35, "section": [35, 71, 74], "divid": 35, "randint": 35, "int64": 35, "dictionaryand": 37, "analyt": 37, "respect": [37, 67], "column": 37, "modifi": [37, 67, 73], "v": [37, 42, 43, 73], "embedding_matrix": 37, "rand": [37, 45], "8490": 37, "9625": 37, "6753": 37, "9666": 37, "7761": 37, "6108": 37, "6246": 37, "9751": 37, "3618": 37, "4161": 37, "2419": 37, "7383": 37, "0237": 37, "7794": 37, "0528": 37, "3385": 37, "8612": 37, "1867": 37, "zero_": 37, "5609": 37, "5384": 37, "8720": 37, "6262": 37, "2438": 37, "7471": 37, "wise": [38, 44], "param": 38, "layernorm": [39, 71], "xa": 40, "layout": [40, 41, 68], "autograd": [40, 41, 67], "miss": [40, 41, 72], "pleas": [40, 41, 45, 67, 74], "open": [40, 41, 73], "request": [40, 41, 72], "product": [41, 45, 71], "behavior": [41, 67], "prepend": 41, "purpos": [41, 56, 57, 74], "remov": [41, 54, 63, 74], "least": 41, "append": [41, 74], "thu": [41, 74], "j": 41, "logic": 41, "valid": [41, 59, 74], "even": [41, 74], "though": [41, 43, 52, 61, 72, 74], "final": [41, 58, 59], "particular": [41, 59, 73, 74], "mm": 41, "residu": [42, 43, 59, 73, 74], "tau": [42, 43, 74], "add": [42, 59, 67, 71, 72, 74], "togeth": [42, 74], "conjunct": [42, 43, 58, 62, 74], "residual_split": [42, 71, 74], "These": [42, 43, 58, 74], "reflect": [42, 43, 69, 74], "empir": [42, 43], "fairli": [42, 43], "insensit": [42, 43], "001": [42, 43], "caus": [42, 43, 74], "signific": [42, 43, 54, 74], "degrad": [42, 43, 74], "come": [42, 52], "split": 43, "prior": [43, 45, 67], "residual_add": [43, 71, 74], "necessari": [43, 53, 67, 74], "delai": [43, 74], "still": [43, 52, 59, 67, 72], "normalis": 43, "benefici": 43, "behav": 43, "order": [43, 45, 68, 74], "callabl": [44, 55, 59, 61, 62, 63, 68, 69, 74], "take": [44, 45, 59, 74], "kwarg": [44, 63, 67, 68], "queri": 45, "is_caus": 45, "usewhatev": 45, "underli": [45, 52], "implementationi": 45, "avail": [45, 58, 74], "flash": 45, "aprob": 45, "greater": 45, "effici": [45, 67, 74], "def": [45, 59, 67, 69, 74], "scale_factor": 45, "math": [45, 69], "els": 45, "attn_bia": 45, "assert": 45, "temp_mask": 45, "tril": 45, "diagon": 45, "masked_fill_": 45, "logical_not": 45, "attn_weight": 45, "transpos": 45, "subject": 45, "There": [45, 67, 74], "flashattent": 45, "faster": [45, 74], "parallel": 45, "partit": 45, "memori": [45, 67, 74], "match": 45, "abov": [45, 73, 74], "formul": 45, "kernel": [45, 74], "cuda": 45, "backend": [45, 52, 61, 62], "attempt": [45, 67, 74], "most": [45, 67, 72, 73, 74], "fine": 45, "grain": 45, "control": [45, 74], "what": [45, 53, 67, 71, 73], "disabl": 45, "context": [45, 67], "manag": 45, "prefer": 45, "mechan": [45, 74], "sdpa_kernel": 45, "enable_flash_sdp": 45, "global": [45, 52], "enable_mem_efficient_sdp": 45, "enable_math_sdp": 45, "fuse": [45, 74], "limit": [45, 58, 71], "event": 45, "reason": [45, 58, 72, 73], "cannot": 45, "due": 45, "natur": 45, "float64": 45, "numerical_accuraci": 45, "circumst": 45, "cudnn": 45, "nondeterminist": 45, "undesir": 45, "try": [45, 74], "potenti": 45, "cost": 45, "ev": 45, "part": 45, "score": 45, "upper": 45, "ensur": [45, 67, 68, 73, 74], "32": 45, "64": [45, 74], "sdp_kernel": 45, "enable_math": 45, "desir": [46, 74], "cast": 46, "befor": [46, 56, 57, 67, 68, 73, 74], "overflow": [46, 74], "unchang": 48, "dynamo": 50, "sake": [50, 58], "fwd_tensor": 51, "fwd": [51, 74], "bwd": [51, 69, 74], "object": [51, 58, 67], "slightli": [52, 54, 73, 74], "doesn": [52, 59, 61, 62, 64, 67], "nest": [52, 59, 61], "unit_scal": [52, 58, 71, 72], "address": [52, 74], "introduc": [52, 73, 74], "compos": 52, "move": [52, 61], "_dynamo": [52, 61, 62], "execut": [52, 61, 68], "new": [52, 56, 57, 58, 61, 62, 63, 71, 72, 74], "optimis": [52, 61, 62, 71], "cach": [52, 61], "thereaft": [52, 61], "written": [52, 67], "successfulli": 52, "rather": 52, "graphmodul": [52, 61, 68], "simulate_fp8": [52, 58, 59, 71, 72], "without": [52, 69, 72, 74], "wai": [52, 59, 67, 74], "node": [53, 54, 55, 58, 63, 68], "suppli": [53, 54, 56, 59, 61, 67, 74], "identifi": [53, 59], "pruned_graph": [53, 54], "rtol": 54, "52587890625e": 54, "previou": [54, 59], "never": 54, "negligibli": 54, "toler": 54, "iter": [55, 61], "onc": [55, 67], "complet": [55, 72], "fwd_format": 56, "bwd_format": 56, "torchdynamo": [56, 57, 59, 61, 62, 64], "matmul": [56, 57, 71], "scaled_dot_product_attent": [56, 57, 71], "insert": [56, 57], "inspect": [56, 57], "correct": [56, 57, 67, 73, 74], "fp32": [56, 57, 74], "speedup": [56, 57, 74], "variou": [56, 58], "As": [57, 74], "literatur": 57, "noun": 57, "et": 57, "al": 57, "2022": 57, "micikeviciu": 57, "e4": [57, 74], "e5": [57, 74], "record": [58, 67, 68], "access": [58, 67], "meta": 58, "associ": 58, "analysi": [58, 59, 69, 70, 71, 74], "requires_grad_": [58, 69, 74], "alwai": [58, 67], "chain": 58, "prune_non_float_tensor": [58, 71], "prune_same_scale_tensor": [58, 71], "tend": [58, 74], "dict": [59, 63, 68], "trace": 59, "procedur": 59, "recurs": [59, 61, 62, 64, 68, 69], "whether": [59, 67], "inner": 59, "build": [59, 74], "fundament": 59, "proce": 59, "five": 59, "stage": 59, "accord": 59, "identif": 59, "done": 59, "special": [59, 72], "compar": 59, "unconstrain": 59, "proof": 59, "henc": 59, "initialis": [59, 73, 74], "abl": [59, 74], "much": [59, 74], "approach": [59, 61, 74], "express": [59, 63, 73], "compil": [59, 61, 62, 71, 72, 74], "own": [59, 61], "system": [59, 61], "easi": [59, 61], "howev": [59, 61, 73, 74], "interoper": [59, 61], "definit": 59, "custom": [59, 67], "basic": [59, 74], "told": 59, "explicitli": [59, 73], "substitut": 59, "new_gelu": 59, "test": [59, 72, 73, 74], "said": 59, "suffici": [59, 74], "anticip": 59, "mani": [59, 67, 73, 74], "ultim": 59, "reli": 59, "alon": 59, "prioriti": 59, "copi": 59, "non_recurse_funct": 61, "graph_modul": 61, "backend_1": 61, "backend_2": 61, "_modul": 61, "fn": 62, "captur": [62, 64], "wrap": [62, 68, 69, 74], "typic": [62, 64, 74], "torch_nn_modules_to_user_modul": [62, 71], "patch": 62, "target_fn": 63, "keep_type_expr": 63, "accompani": [63, 73], "retain": [63, 73], "mod": 64, "trivial_subclass": 64, "develop": [65, 74], "dataclass": 66, "pair": 66, "scalepair": [67, 71], "static": 67, "ctx": 67, "functionctx": 67, "formula": 67, "overridden": 67, "subclass": 67, "vjp": 67, "were": 67, "attribut": [67, 68], "needs_input_grad": 67, "is_trac": 67, "autogener": 67, "vmap": 67, "jvp": 67, "extend": 67, "func": 67, "grad_input": 67, "got": 67, "mark_dirti": 67, "mark": 67, "insid": 67, "matter": 67, "torch_doctest_autograd": 67, "staticmethod": 67, "x_npy": 67, "numpi": 67, "share": [67, 74], "storag": 67, "once_differenti": 67, "grad_output": 67, "doubl": 67, "clone": [67, 71, 74], "would": 67, "lead": [67, 74], "wrong": 67, "engin": 67, "know": [67, 73], "unless": 67, "runtimeerror": 67, "variabl": 67, "mark_non_differenti": 67, "go": [67, 73, 74], "sort": 67, "idx": 67, "save_for_backward": 67, "g1": 67, "g2": 67, "saved_tensor": 67, "zeros_lik": 67, "index_add_": 67, "oppos": 67, "directli": [67, 72, 74], "leak": 67, "hook": 67, "saved_tensors_hook": 67, "intermediari": 67, "neither": 67, "nor": 67, "decor": 67, "recomput": 67, "tutori": [67, 74], "through": [67, 68, 72, 73, 74], "made": 67, "weren": 67, "content": 67, "z": [67, 73], "grad_out": 67, "gx": 67, "gy": 67, "gz": 67, "save_for_forward": 67, "x_t": 67, "y_t": 67, "fwad": 67, "dual_level": 67, "a_dual": 67, "make_du": 67, "set_materialize_grad": 67, "materi": 67, "undefin": 67, "expand": 67, "simplefunc": 67, "No": 67, "handl": [67, 68], "induc": 67, "setup_context": 67, "signatur": 67, "happen": [67, 73], "info": 67, "in_dim": 67, "underneath": 67, "generate_vmap_rul": 67, "choos": 67, "out_dim": 67, "similar": [67, 74], "structur": [67, 68], "instrument": 68, "boxed_run": 68, "args_list": 68, "interpret": 68, "convent": 68, "clear": 68, "promptli": 68, "dealloc": 68, "compat": 68, "api": [68, 71, 74], "guarante": [68, 72], "call_funct": 68, "semant": 68, "invoc": 68, "call_method": 68, "memory_format": 68, "opoverload": 68, "call_modul": 68, "fetch_args_kwargs_from_env": 68, "fetch": 68, "concret": 68, "environ": 68, "fetch_attr": 68, "hierarchi": 68, "qualifi": 68, "get_attr": 68, "Will": 68, "wa": 68, "map_nodes_to_valu": 68, "descend": 68, "belong": 68, "report": 68, "realli": 68, "referenc": 68, "placehold": 68, "tracer": 68, "target_to_funct": 68, "initial_env": 68, "enable_io_process": 68, "start": [68, 74], "map": 68, "popul": 68, "partial": 68, "process_input": 68, "process_output": 68, "run_nod": 68, "recurse_modul": 69, "syntax_highlight": 69, "autowrap_modul": 69, "einop": 69, "home": 69, "runner": 69, "local": 69, "lib": 69, "site": 69, "packag": 69, "__init__": [69, 74], "py": 69, "autowrap_funct": 69, "dummi": 69, "union": 69, "fed": [69, 74], "plain": 69, "toggl": 69, "behavour": 69, "moduletyp": 69, "whose": 69, "string": 69, "super": [69, 74], "fc1": 69, "relu": 69, "fc2": 69, "236": 69, "fc1_weight": 69, "018": [69, 74], "54": 69, "fc1_bia": 69, "0182": 69, "51": 69, "_c": [69, 74], "_nn": [69, 74], "578": [69, 74], "204": [69, 74], "337": 69, "288": 69, "fc2_weight": 69, "00902": [69, 74], "13": 69, "fc2_bia": 69, "00904": 69, "31": 69, "linear_1": [69, 74], "235": 69, "999": [69, 74], "welcom": 71, "design": [71, 73, 74], "facilit": 71, "outlin": [71, 74], "icml": [71, 74], "refer": [71, 74], "video": 71, "broad": 71, "fork": [71, 74], "repo": [71, 74], "instruct": [71, 74], "consider": 71, "licens": 71, "blog": 71, "almost": 71, "mhsa": 71, "transformerdecod": 71, "transformerlay": 71, "graph_to_datafram": 71, "apply_constraint": 71, "format_to_tupl": 71, "tuple_to_format": 71, "cross_entropi": [71, 74], "scale_elementwis": 71, "scale_bwd": 71, "scale_fwd": 71, "prune_selected_nod": 71, "simulate_format": 71, "util": [71, 74], "apply_transform": 71, "patch_to_expand_modul": 71, "replace_node_with_funct": 71, "analyse_modul": [71, 74], "scaletrack": 71, "scaletrackinginterpret": 71, "despit": 72, "best": [72, 74], "effort": 72, "free": 72, "assist": 72, "anyon": 72, "want": 72, "issu": [72, 74], "known": 72, "coverag": 72, "ve": [72, 73], "focuss": 72, "difficulti": 72, "although": [72, 74], "suspect": 72, "haven": 72, "exhaust": 72, "encourag": 72, "touch": 72, "tl": 73, "dr": 73, "isn": 73, "properli": 73, "good": [73, 74], "thing": 73, "deep": [73, 74], "roughli": [73, 74], "preserv": [73, 74], "varianc": 73, "behaviour": [73, 74], "satur": 73, "nonlinear": 73, "stabl": 73, "prime": 73, "q": 73, "color": 73, "green": 73, "But": 73, "insuffici": 73, "whole": 73, "deriv": [73, 74], "red": 73, "ll": 73, "explain": 73, "dynam": [73, 74], "wors": 73, "condens": 73, "summari": 73, "temperatur": 73, "think": 73, "sim": 73, "infti": 73, "flat": 73, "uncorrel": 73, "spike": 73, "gt": 73, "assumpt": [73, 74], "companion": 73, "find": [73, 74], "rule": 73, "propos": 73, "small": [73, 74], "autoregress": 73, "charact": 73, "languag": 73, "shakespear": 73, "saw": 73, "rate": 73, "sweep": 73, "unfortun": 73, "block": [73, 74], "tini": 73, "shakespar": 73, "bert": 73, "intrigu": 73, "presum": 73, "accid": 73, "turn": 73, "solut": 73, "bad": 73, "reproduc": 73, "inde": 73, "care": [73, 74], "core": 73, "principl": 73, "underpin": 73, "far": [73, 74], "question": 73, "interest": 73, "With": 73, "thank": 73, "charli": 73, "blake": 73, "feedback": 73, "douglaso": 73, "ai": 73, "read": 74, "cover": 74, "brief": 74, "discuss": 74, "paradigm": 74, "aim": 74, "involv": 74, "term": 74, "usual": 74, "scratch": 74, "advantag": 74, "great": 74, "headroom": 74, "grow": 74, "shrink": 74, "underflow": 74, "occur": 74, "becaus": 74, "drift": 74, "stai": 74, "smaller": 74, "fp16": 74, "experi": 74, "decreas": 74, "treatment": 74, "motiv": 74, "keep": 74, "sens": 74, "might": 74, "bf16": 74, "veri": 74, "larg": 74, "3e": 74, "38": 74, "45": 74, "60": 74, "000": 74, "6e": 74, "put": 74, "speed": 74, "scope": 74, "next": 74, "step": 74, "tricki": 74, "easier": 74, "breakdown": 74, "alongsid": 74, "unscaledmlp": 74, "linear_2": 74, "annotated_cod": 74, "linear_1_weight": 74, "83": 74, "linear_1_bia": 74, "84": 74, "177": 74, "322": 74, "289": 74, "linear_2_weight": 74, "48": 74, "linear_2_bia": 74, "00894": 74, "198": 74, "firstli": 74, "decompos": 74, "level": 74, "secondli": 74, "fwd_scale": 74, "bwd_scale": 74, "sign": 74, "receiv": 74, "enough": 74, "unscal": 74, "could": 74, "drop": 74, "scaledmlp": 74, "716": 74, "729": 74, "707": 74, "706": 74, "693": 74, "03": 74, "979": 74, "repeat": 74, "until": 74, "measur": 74, "art": 74, "aris": 74, "clearli": 74, "explod": 74, "clip": 74, "convers": 74, "steadili": 74, "exactli": 74, "meet": 74, "concern": 74, "significantli": 74, "merit": 74, "investig": 74, "attain": 74, "divis": 74, "substanti": 74, "push": 74, "themselv": 74, "solv": 74, "outsid": 74, "separ": 74, "altern": 74, "form": 74, "residuallay": 74, "contrast": 74, "ratio": 74, "50": 74, "hyperparamet": 74, "leav": 74, "tune": 74, "fact": 74, "down": 74, "emploi": 74, "trick": 74, "comprehens": 74, "scenario": 74, "produc": 74, "arriv": 74, "fan_in": 74, "fan_out": 74, "grad_weight_scal": 74, "grad_bias_scal": 74, "ideal": 74, "exact": 74, "compromis": 74, "extra": 74, "eager": 74, "trip": 74, "fortun": 74, "hi": 74, "overhead": 74, "elimin": 74, "fusion": 74, "stack": 74, "answer": 74, "old": 74, "jit": 74, "script": 74, "torchscript": 74, "program": 74, "rectifi": 74, "flexibl": 74, "theori": 74, "unit_scaled_funct": 74, "unitscaledmodul": 74, "incur": 74, "naiv": 74, "benchmark": 74, "thorough": 74, "strongli": 74, "latest": 74, "fail": 74, "recent": 74, "upgrad": 74, "preview": 74, "nightli": 74}, "objects": {"": [[3, 0, 0, "-", "unit_scaling"]], "unit_scaling": [[4, 1, 1, "", "CrossEntropyLoss"], [5, 1, 1, "", "Dropout"], [6, 1, 1, "", "Embedding"], [7, 1, 1, "", "GELU"], [8, 1, 1, "", "LayerNorm"], [9, 1, 1, "", "Linear"], [10, 1, 1, "", "MHSA"], [11, 1, 1, "", "MLP"], [12, 1, 1, "", "Softmax"], [13, 1, 1, "", "TransformerDecoder"], [14, 1, 1, "", "TransformerLayer"], [15, 0, 0, "-", "analysis"], [20, 0, 0, "-", "constraints"], [29, 0, 0, "-", "formats"], [33, 0, 0, "-", "functional"], [47, 0, 0, "-", "scale"], [50, 0, 0, "-", "transforms"], [65, 0, 0, "-", "utils"], [70, 4, 1, "", "visualiser"]], "unit_scaling.Embedding": [[6, 2, 1, "", "from_pretrained"], [6, 3, 1, "", "weight"]], "unit_scaling.LayerNorm": [[8, 3, 1, "", "bias"], [8, 3, 1, "", "weight"]], "unit_scaling.Linear": [[9, 3, 1, "", "bias"], [9, 3, 1, "", "weight"]], "unit_scaling.analysis": [[16, 4, 1, "", "example_batch"], [17, 4, 1, "", "graph_to_dataframe"], [18, 4, 1, "", "plot"], [19, 4, 1, "", "visualiser"]], "unit_scaling.constraints": [[21, 4, 1, "", "amean"], [22, 4, 1, "", "apply_constraint"], [23, 4, 1, "", "gmean"], [24, 4, 1, "", "hmean"], [25, 4, 1, "", "to_grad_input_scale"], [26, 4, 1, "", "to_left_grad_scale"], [27, 4, 1, "", "to_output_scale"], [28, 4, 1, "", "to_right_grad_scale"]], "unit_scaling.formats": [[30, 1, 1, "", "FPFormat"], [31, 4, 1, "", "format_to_tuple"], [32, 4, 1, "", "tuple_to_format"]], "unit_scaling.formats.FPFormat": [[30, 5, 1, "", "bits"], [30, 5, 1, "", "max_absolute_value"], [30, 5, 1, "", "min_absolute_normal"], [30, 5, 1, "", "min_absolute_subnormal"], [30, 2, 1, "", "quantise"], [30, 2, 1, "", "quantise_bwd"], [30, 2, 1, "", "quantise_fwd"]], "unit_scaling.functional": [[34, 4, 1, "", "add"], [35, 4, 1, "", "cross_entropy"], [36, 4, 1, "", "dropout"], [37, 4, 1, "", "embedding"], [38, 4, 1, "", "gelu"], [39, 4, 1, "", "layer_norm"], [40, 4, 1, "", "linear"], [41, 4, 1, "", "matmul"], [42, 4, 1, "", "residual_add"], [43, 4, 1, "", "residual_split"], [44, 4, 1, "", "scale_elementwise"], [45, 4, 1, "", "scaled_dot_product_attention"], [46, 4, 1, "", "softmax"]], "unit_scaling.scale": [[48, 4, 1, "", "scale_bwd"], [49, 4, 1, "", "scale_fwd"]], "unit_scaling.transforms": [[51, 1, 1, "", "Metrics"], [52, 4, 1, "", "compile"], [53, 4, 1, "", "prune_non_float_tensors"], [54, 4, 1, "", "prune_same_scale_tensors"], [55, 4, 1, "", "prune_selected_nodes"], [56, 4, 1, "", "simulate_format"], [57, 4, 1, "", "simulate_fp8"], [58, 4, 1, "", "track_scales"], [59, 4, 1, "", "unit_scale"], [60, 0, 0, "-", "utils"]], "unit_scaling.transforms.Metrics": [[51, 1, 1, "", "Data"]], "unit_scaling.transforms.utils": [[61, 4, 1, "", "apply_transform"], [62, 4, 1, "", "patch_to_expand_modules"], [63, 4, 1, "", "replace_node_with_function"], [64, 4, 1, "", "torch_nn_modules_to_user_modules"]], "unit_scaling.utils": [[66, 1, 1, "", "ScalePair"], [67, 1, 1, "", "ScaleTracker"], [68, 1, 1, "", "ScaleTrackingInterpreter"], [69, 4, 1, "", "analyse_module"]], "unit_scaling.utils.ScaleTracker": [[67, 2, 1, "", "backward"], [67, 3, 1, "", "is_traceable"], [67, 2, 1, "", "jvp"], [67, 2, 1, "", "mark_dirty"], [67, 2, 1, "", "mark_non_differentiable"], [67, 2, 1, "", "save_for_backward"], [67, 2, 1, "", "save_for_forward"], [67, 2, 1, "", "set_materialize_grads"], [67, 2, 1, "", "setup_context"], [67, 2, 1, "", "vjp"], [67, 2, 1, "", "vmap"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[68, 2, 1, "", "boxed_run"], [68, 2, 1, "", "call_function"], [68, 2, 1, "", "call_method"], [68, 2, 1, "", "call_module"], [68, 2, 1, "", "fetch_args_kwargs_from_env"], [68, 2, 1, "", "fetch_attr"], [68, 2, 1, "", "get_attr"], [68, 2, 1, "", "map_nodes_to_values"], [68, 2, 1, "", "output"], [68, 2, 1, "", "placeholder"], [68, 2, 1, "", "run"], [68, 2, 1, "", "run_node"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:function", "5": "py:property"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "function", "Python function"], "5": ["py", "property", "Python property"]}, "titleterms": {"api": 0, "refer": 0, "unit": [1, 2, 71, 74], "scale": [1, 2, 47, 48, 49, 71, 73, 74], "blog": 1, "almost": [1, 73], "dot": [1, 73], "product": [1, 73], "self": 1, "attent": [1, 73], "instal": [2, 71, 74], "what": [2, 74], "i": [2, 74], "develop": [2, 71], "licens": 2, "unit_sc": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70], "crossentropyloss": 4, "dropout": [5, 36], "embed": [6, 37], "gelu": [7, 38], "layernorm": 8, "linear": [9, 40], "mhsa": 10, "mlp": 11, "softmax": [12, 46], "transformerdecod": 13, "transformerlay": 14, "analysi": [15, 16, 17, 18, 19], "example_batch": 16, "graph_to_datafram": 17, "plot": 18, "visualis": [19, 70], "constraint": [20, 21, 22, 23, 24, 25, 26, 27, 28], "amean": 21, "apply_constraint": 22, "gmean": 23, "hmean": 24, "to_grad_input_scal": 25, "to_left_grad_scal": 26, "to_output_scal": 27, "to_right_grad_scal": 28, "format": [29, 30, 31, 32], "fpformat": 30, "format_to_tupl": 31, "tuple_to_format": 32, "function": [33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46], "add": 34, "cross_entropi": 35, "layer_norm": 39, "matmul": 41, "residual_add": 42, "residual_split": 43, "scale_elementwis": 44, "scaled_dot_product_attent": 45, "scale_bwd": 48, "scale_fwd": 49, "transform": [50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64], "metric": 51, "compil": 52, "prune_non_float_tensor": 53, "prune_same_scale_tensor": 54, "prune_selected_nod": 55, "simulate_format": 56, "simulate_fp8": 57, "track_scal": 58, "unit_scal": 59, "util": [60, 61, 62, 63, 64, 65, 66, 67, 68, 69], "apply_transform": 61, "patch_to_expand_modul": 62, "replace_node_with_funct": 63, "torch_nn_modules_to_user_modul": 64, "scalepair": 66, "scaletrack": 67, "scaletrackinginterpret": 68, "analyse_modul": 69, "get": 71, "start": 71, "content": 71, "limit": 72, "where": 73, "doe": 73, "d_": 73, "seq": 73, "e": 73, "1": 73, "2": 73, "come": 73, "from": 73, "work": 73, "No": 73, "conclus": 73, "user": 74, "guid": 74, "how": 74, "model": 74, "kei": 74, "consider": 74, "optimis": 74}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"API reference": [[0, "api-reference"]], "Unit Scaling blog": [[1, "unit-scaling-blog"]], "Almost scaled dot-product self attention": [[1, "almost-scaled-dot-product-self-attention"]], "Unit Scaling": [[2, "unit-scaling"], [71, "unit-scaling"]], "Installation": [[2, "installation"], [71, "installation"], [74, "installation"]], "What is unit scaling?": [[2, "what-is-unit-scaling"], [74, "what-is-unit-scaling"]], "Development": [[2, "development"], [71, "development"]], "License": [[2, "license"]], "unit_scaling": [[3, "module-unit_scaling"]], "unit_scaling.CrossEntropyLoss": [[4, "unit-scaling-crossentropyloss"]], "unit_scaling.Dropout": [[5, "unit-scaling-dropout"]], "unit_scaling.Embedding": [[6, "unit-scaling-embedding"]], "unit_scaling.GELU": [[7, "unit-scaling-gelu"]], "unit_scaling.LayerNorm": [[8, "unit-scaling-layernorm"]], "unit_scaling.Linear": [[9, "unit-scaling-linear"]], "unit_scaling.MHSA": [[10, "unit-scaling-mhsa"]], "unit_scaling.MLP": [[11, "unit-scaling-mlp"]], "unit_scaling.Softmax": [[12, "unit-scaling-softmax"]], "unit_scaling.TransformerDecoder": [[13, "unit-scaling-transformerdecoder"]], "unit_scaling.TransformerLayer": [[14, "unit-scaling-transformerlayer"]], "unit_scaling.analysis": [[15, "module-unit_scaling.analysis"]], "unit_scaling.analysis.example_batch": [[16, "unit-scaling-analysis-example-batch"]], "unit_scaling.analysis.graph_to_dataframe": [[17, "unit-scaling-analysis-graph-to-dataframe"]], "unit_scaling.analysis.plot": [[18, "unit-scaling-analysis-plot"]], "unit_scaling.analysis.visualiser": [[19, "unit-scaling-analysis-visualiser"]], "unit_scaling.constraints": [[20, "module-unit_scaling.constraints"]], "unit_scaling.constraints.amean": [[21, "unit-scaling-constraints-amean"]], "unit_scaling.constraints.apply_constraint": [[22, "unit-scaling-constraints-apply-constraint"]], "unit_scaling.constraints.gmean": [[23, "unit-scaling-constraints-gmean"]], "unit_scaling.constraints.hmean": [[24, "unit-scaling-constraints-hmean"]], "unit_scaling.constraints.to_grad_input_scale": [[25, "unit-scaling-constraints-to-grad-input-scale"]], "unit_scaling.constraints.to_left_grad_scale": [[26, "unit-scaling-constraints-to-left-grad-scale"]], "unit_scaling.constraints.to_output_scale": [[27, "unit-scaling-constraints-to-output-scale"]], "unit_scaling.constraints.to_right_grad_scale": [[28, "unit-scaling-constraints-to-right-grad-scale"]], "unit_scaling.formats": [[29, "module-unit_scaling.formats"]], "unit_scaling.formats.FPFormat": [[30, "unit-scaling-formats-fpformat"]], "unit_scaling.formats.format_to_tuple": [[31, "unit-scaling-formats-format-to-tuple"]], "unit_scaling.formats.tuple_to_format": [[32, "unit-scaling-formats-tuple-to-format"]], "unit_scaling.functional": [[33, "module-unit_scaling.functional"]], "unit_scaling.functional.add": [[34, "unit-scaling-functional-add"]], "unit_scaling.functional.cross_entropy": [[35, "unit-scaling-functional-cross-entropy"]], "unit_scaling.functional.dropout": [[36, "unit-scaling-functional-dropout"]], "unit_scaling.functional.embedding": [[37, "unit-scaling-functional-embedding"]], "unit_scaling.functional.gelu": [[38, "unit-scaling-functional-gelu"]], "unit_scaling.functional.layer_norm": [[39, "unit-scaling-functional-layer-norm"]], "unit_scaling.functional.linear": [[40, "unit-scaling-functional-linear"]], "unit_scaling.functional.matmul": [[41, "unit-scaling-functional-matmul"]], "unit_scaling.functional.residual_add": [[42, "unit-scaling-functional-residual-add"]], "unit_scaling.functional.residual_split": [[43, "unit-scaling-functional-residual-split"]], "unit_scaling.functional.scale_elementwise": [[44, "unit-scaling-functional-scale-elementwise"]], "unit_scaling.functional.scaled_dot_product_attention": [[45, "unit-scaling-functional-scaled-dot-product-attention"]], "unit_scaling.functional.softmax": [[46, "unit-scaling-functional-softmax"]], "unit_scaling.scale": [[47, "module-unit_scaling.scale"]], "unit_scaling.scale.scale_bwd": [[48, "unit-scaling-scale-scale-bwd"]], "unit_scaling.scale.scale_fwd": [[49, "unit-scaling-scale-scale-fwd"]], "unit_scaling.transforms": [[50, "module-unit_scaling.transforms"]], "unit_scaling.transforms.Metrics": [[51, "unit-scaling-transforms-metrics"]], "unit_scaling.transforms.compile": [[52, "unit-scaling-transforms-compile"]], "unit_scaling.transforms.prune_non_float_tensors": [[53, "unit-scaling-transforms-prune-non-float-tensors"]], "unit_scaling.transforms.prune_same_scale_tensors": [[54, "unit-scaling-transforms-prune-same-scale-tensors"]], "unit_scaling.transforms.prune_selected_nodes": [[55, "unit-scaling-transforms-prune-selected-nodes"]], "unit_scaling.transforms.simulate_format": [[56, "unit-scaling-transforms-simulate-format"]], "unit_scaling.transforms.simulate_fp8": [[57, "unit-scaling-transforms-simulate-fp8"]], "unit_scaling.transforms.track_scales": [[58, "unit-scaling-transforms-track-scales"]], "unit_scaling.transforms.unit_scale": [[59, "unit-scaling-transforms-unit-scale"]], "unit_scaling.transforms.utils": [[60, "module-unit_scaling.transforms.utils"]], "unit_scaling.transforms.utils.apply_transform": [[61, "unit-scaling-transforms-utils-apply-transform"]], "unit_scaling.transforms.utils.patch_to_expand_modules": [[62, "unit-scaling-transforms-utils-patch-to-expand-modules"]], "unit_scaling.transforms.utils.replace_node_with_function": [[63, "unit-scaling-transforms-utils-replace-node-with-function"]], "unit_scaling.transforms.utils.torch_nn_modules_to_user_modules": [[64, "unit-scaling-transforms-utils-torch-nn-modules-to-user-modules"]], "unit_scaling.utils": [[65, "module-unit_scaling.utils"]], "unit_scaling.utils.ScalePair": [[66, "unit-scaling-utils-scalepair"]], "unit_scaling.utils.ScaleTracker": [[67, "unit-scaling-utils-scaletracker"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[68, "unit-scaling-utils-scaletrackinginterpreter"]], "unit_scaling.utils.analyse_module": [[69, "unit-scaling-utils-analyse-module"]], "unit_scaling.visualiser": [[70, "unit-scaling-visualiser"]], "Getting Started": [[71, "getting-started"]], "Contents": [[71, null]], "Limitations": [[72, "limitations"]], "Almost-scaled dot-product attention": [[73, "almost-scaled-dot-product-attention"]], "Where does (d_{seq}/e)^{1/2} come from?": [[73, "where-does-d-seq-e-1-2-come-from"]], "Does it work? \u2026No!": [[73, "does-it-work-no"]], "Conclusion": [[73, "conclusion"]], "User guide": [[74, "user-guide"]], "How to unit-scale a model": [[74, "how-to-unit-scale-a-model"]], "Key considerations for unit scaling": [[74, "key-considerations-for-unit-scaling"]], "Optimising unit-scaled models": [[74, "optimising-unit-scaled-models"]]}, "indexentries": {"module": [[3, "module-unit_scaling"], [15, "module-unit_scaling.analysis"], [20, "module-unit_scaling.constraints"], [29, "module-unit_scaling.formats"], [33, "module-unit_scaling.functional"], [47, "module-unit_scaling.scale"], [50, "module-unit_scaling.transforms"], [60, "module-unit_scaling.transforms.utils"], [65, "module-unit_scaling.utils"]], "unit_scaling": [[3, "module-unit_scaling"]], "crossentropyloss (class in unit_scaling)": [[4, "unit_scaling.CrossEntropyLoss"]], "dropout (class in unit_scaling)": [[5, "unit_scaling.Dropout"]], "embedding (class in unit_scaling)": [[6, "unit_scaling.Embedding"]], "from_pretrained() (unit_scaling.embedding class method)": [[6, "unit_scaling.Embedding.from_pretrained"]], "weight (unit_scaling.embedding attribute)": [[6, "unit_scaling.Embedding.weight"]], "gelu (class in unit_scaling)": [[7, "unit_scaling.GELU"]], "layernorm (class in unit_scaling)": [[8, "unit_scaling.LayerNorm"]], "bias (unit_scaling.layernorm attribute)": [[8, "unit_scaling.LayerNorm.bias"]], "weight (unit_scaling.layernorm attribute)": [[8, "unit_scaling.LayerNorm.weight"]], "linear (class in unit_scaling)": [[9, "unit_scaling.Linear"]], "bias (unit_scaling.linear attribute)": [[9, "unit_scaling.Linear.bias"]], "weight (unit_scaling.linear attribute)": [[9, "unit_scaling.Linear.weight"]], "mhsa (class in unit_scaling)": [[10, "unit_scaling.MHSA"]], "mlp (class in unit_scaling)": [[11, "unit_scaling.MLP"]], "softmax (class in unit_scaling)": [[12, "unit_scaling.Softmax"]], "transformerdecoder (class in unit_scaling)": [[13, "unit_scaling.TransformerDecoder"]], "transformerlayer (class in unit_scaling)": [[14, "unit_scaling.TransformerLayer"]], "unit_scaling.analysis": [[15, "module-unit_scaling.analysis"]], "example_batch() (in module unit_scaling.analysis)": [[16, "unit_scaling.analysis.example_batch"]], "graph_to_dataframe() (in module unit_scaling.analysis)": [[17, "unit_scaling.analysis.graph_to_dataframe"]], "plot() (in module unit_scaling.analysis)": [[18, "unit_scaling.analysis.plot"]], "visualiser() (in module unit_scaling.analysis)": [[19, "unit_scaling.analysis.visualiser"]], "unit_scaling.constraints": [[20, "module-unit_scaling.constraints"]], "amean() (in module unit_scaling.constraints)": [[21, "unit_scaling.constraints.amean"]], "apply_constraint() (in module unit_scaling.constraints)": [[22, "unit_scaling.constraints.apply_constraint"]], "gmean() (in module unit_scaling.constraints)": [[23, "unit_scaling.constraints.gmean"]], "hmean() (in module unit_scaling.constraints)": [[24, "unit_scaling.constraints.hmean"]], "to_grad_input_scale() (in module unit_scaling.constraints)": [[25, "unit_scaling.constraints.to_grad_input_scale"]], "to_left_grad_scale() (in module unit_scaling.constraints)": [[26, "unit_scaling.constraints.to_left_grad_scale"]], "to_output_scale() (in module unit_scaling.constraints)": [[27, "unit_scaling.constraints.to_output_scale"]], "to_right_grad_scale() (in module unit_scaling.constraints)": [[28, "unit_scaling.constraints.to_right_grad_scale"]], "unit_scaling.formats": [[29, "module-unit_scaling.formats"]], "fpformat (class in unit_scaling.formats)": [[30, "unit_scaling.formats.FPFormat"]], "bits (unit_scaling.formats.fpformat property)": [[30, "unit_scaling.formats.FPFormat.bits"]], "max_absolute_value (unit_scaling.formats.fpformat property)": [[30, "unit_scaling.formats.FPFormat.max_absolute_value"]], "min_absolute_normal (unit_scaling.formats.fpformat property)": [[30, "unit_scaling.formats.FPFormat.min_absolute_normal"]], "min_absolute_subnormal (unit_scaling.formats.fpformat property)": [[30, "unit_scaling.formats.FPFormat.min_absolute_subnormal"]], "quantise() (unit_scaling.formats.fpformat method)": [[30, "unit_scaling.formats.FPFormat.quantise"]], "quantise_bwd() (unit_scaling.formats.fpformat method)": [[30, "unit_scaling.formats.FPFormat.quantise_bwd"]], "quantise_fwd() (unit_scaling.formats.fpformat method)": [[30, "unit_scaling.formats.FPFormat.quantise_fwd"]], "format_to_tuple() (in module unit_scaling.formats)": [[31, "unit_scaling.formats.format_to_tuple"]], "tuple_to_format() (in module unit_scaling.formats)": [[32, "unit_scaling.formats.tuple_to_format"]], "unit_scaling.functional": [[33, "module-unit_scaling.functional"]], "add() (in module unit_scaling.functional)": [[34, "unit_scaling.functional.add"]], "cross_entropy() (in module unit_scaling.functional)": [[35, "unit_scaling.functional.cross_entropy"]], "dropout() (in module unit_scaling.functional)": [[36, "unit_scaling.functional.dropout"]], "embedding() (in module unit_scaling.functional)": [[37, "unit_scaling.functional.embedding"]], "gelu() (in module unit_scaling.functional)": [[38, "unit_scaling.functional.gelu"]], "layer_norm() (in module unit_scaling.functional)": [[39, "unit_scaling.functional.layer_norm"]], "linear() (in module unit_scaling.functional)": [[40, "unit_scaling.functional.linear"]], "matmul() (in module unit_scaling.functional)": [[41, "unit_scaling.functional.matmul"]], "residual_add() (in module unit_scaling.functional)": [[42, "unit_scaling.functional.residual_add"]], "residual_split() (in module unit_scaling.functional)": [[43, "unit_scaling.functional.residual_split"]], "scale_elementwise() (in module unit_scaling.functional)": [[44, "unit_scaling.functional.scale_elementwise"]], "scaled_dot_product_attention() (in module unit_scaling.functional)": [[45, "unit_scaling.functional.scaled_dot_product_attention"]], "softmax() (in module unit_scaling.functional)": [[46, "unit_scaling.functional.softmax"]], "unit_scaling.scale": [[47, "module-unit_scaling.scale"]], "scale_bwd() (in module unit_scaling.scale)": [[48, "unit_scaling.scale.scale_bwd"]], "scale_fwd() (in module unit_scaling.scale)": [[49, "unit_scaling.scale.scale_fwd"]], "unit_scaling.transforms": [[50, "module-unit_scaling.transforms"]], "metrics (class in unit_scaling.transforms)": [[51, "unit_scaling.transforms.Metrics"]], "metrics.data (class in unit_scaling.transforms)": [[51, "unit_scaling.transforms.Metrics.Data"]], "compile() (in module unit_scaling.transforms)": [[52, "unit_scaling.transforms.compile"]], "prune_non_float_tensors() (in module unit_scaling.transforms)": [[53, "unit_scaling.transforms.prune_non_float_tensors"]], "prune_same_scale_tensors() (in module unit_scaling.transforms)": [[54, "unit_scaling.transforms.prune_same_scale_tensors"]], "prune_selected_nodes() (in module unit_scaling.transforms)": [[55, "unit_scaling.transforms.prune_selected_nodes"]], "simulate_format() (in module unit_scaling.transforms)": [[56, "unit_scaling.transforms.simulate_format"]], "simulate_fp8() (in module unit_scaling.transforms)": [[57, "unit_scaling.transforms.simulate_fp8"]], "track_scales() (in module unit_scaling.transforms)": [[58, "unit_scaling.transforms.track_scales"]], "unit_scale() (in module unit_scaling.transforms)": [[59, "unit_scaling.transforms.unit_scale"]], "unit_scaling.transforms.utils": [[60, "module-unit_scaling.transforms.utils"]], "apply_transform() (in module unit_scaling.transforms.utils)": [[61, "unit_scaling.transforms.utils.apply_transform"]], "patch_to_expand_modules() (in module unit_scaling.transforms.utils)": [[62, "unit_scaling.transforms.utils.patch_to_expand_modules"]], "replace_node_with_function() (in module unit_scaling.transforms.utils)": [[63, "unit_scaling.transforms.utils.replace_node_with_function"]], "torch_nn_modules_to_user_modules() (in module unit_scaling.transforms.utils)": [[64, "unit_scaling.transforms.utils.torch_nn_modules_to_user_modules"]], "unit_scaling.utils": [[65, "module-unit_scaling.utils"]], "scalepair (class in unit_scaling.utils)": [[66, "unit_scaling.utils.ScalePair"]], "scaletracker (class in unit_scaling.utils)": [[67, "unit_scaling.utils.ScaleTracker"]], "backward() (unit_scaling.utils.scaletracker static method)": [[67, "unit_scaling.utils.ScaleTracker.backward"]], "is_traceable (unit_scaling.utils.scaletracker attribute)": [[67, "unit_scaling.utils.ScaleTracker.is_traceable"]], "jvp() (unit_scaling.utils.scaletracker static method)": [[67, "unit_scaling.utils.ScaleTracker.jvp"]], "mark_dirty() (unit_scaling.utils.scaletracker method)": [[67, "unit_scaling.utils.ScaleTracker.mark_dirty"]], "mark_non_differentiable() (unit_scaling.utils.scaletracker method)": [[67, "unit_scaling.utils.ScaleTracker.mark_non_differentiable"]], "save_for_backward() (unit_scaling.utils.scaletracker method)": [[67, "unit_scaling.utils.ScaleTracker.save_for_backward"]], "save_for_forward() (unit_scaling.utils.scaletracker method)": [[67, "unit_scaling.utils.ScaleTracker.save_for_forward"]], "set_materialize_grads() (unit_scaling.utils.scaletracker method)": [[67, "unit_scaling.utils.ScaleTracker.set_materialize_grads"]], "setup_context() (unit_scaling.utils.scaletracker static method)": [[67, "unit_scaling.utils.ScaleTracker.setup_context"]], "vjp() (unit_scaling.utils.scaletracker static method)": [[67, "unit_scaling.utils.ScaleTracker.vjp"]], "vmap() (unit_scaling.utils.scaletracker static method)": [[67, "unit_scaling.utils.ScaleTracker.vmap"]], "scaletrackinginterpreter (class in unit_scaling.utils)": [[68, "unit_scaling.utils.ScaleTrackingInterpreter"]], "boxed_run() (unit_scaling.utils.scaletrackinginterpreter method)": [[68, "unit_scaling.utils.ScaleTrackingInterpreter.boxed_run"]], "call_function() (unit_scaling.utils.scaletrackinginterpreter method)": [[68, "unit_scaling.utils.ScaleTrackingInterpreter.call_function"]], "call_method() (unit_scaling.utils.scaletrackinginterpreter method)": [[68, "unit_scaling.utils.ScaleTrackingInterpreter.call_method"]], "call_module() (unit_scaling.utils.scaletrackinginterpreter method)": [[68, "unit_scaling.utils.ScaleTrackingInterpreter.call_module"]], "fetch_args_kwargs_from_env() (unit_scaling.utils.scaletrackinginterpreter method)": [[68, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_args_kwargs_from_env"]], "fetch_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[68, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_attr"]], "get_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[68, "unit_scaling.utils.ScaleTrackingInterpreter.get_attr"]], "map_nodes_to_values() (unit_scaling.utils.scaletrackinginterpreter method)": [[68, "unit_scaling.utils.ScaleTrackingInterpreter.map_nodes_to_values"]], "output() (unit_scaling.utils.scaletrackinginterpreter method)": [[68, "unit_scaling.utils.ScaleTrackingInterpreter.output"]], "placeholder() (unit_scaling.utils.scaletrackinginterpreter method)": [[68, "unit_scaling.utils.ScaleTrackingInterpreter.placeholder"]], "run() (unit_scaling.utils.scaletrackinginterpreter method)": [[68, "unit_scaling.utils.ScaleTrackingInterpreter.run"]], "run_node() (unit_scaling.utils.scaletrackinginterpreter method)": [[68, "unit_scaling.utils.ScaleTrackingInterpreter.run_node"]], "analyse_module() (in module unit_scaling.utils)": [[69, "unit_scaling.utils.analyse_module"]], "visualiser() (in module unit_scaling)": [[70, "unit_scaling.visualiser"]]}})