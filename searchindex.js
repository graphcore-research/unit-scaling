Search.setIndex({"docnames": ["api_reference", "development", "generated/unit_scaling", "generated/unit_scaling.CrossEntropyLoss", "generated/unit_scaling.Dropout", "generated/unit_scaling.Embedding", "generated/unit_scaling.GELU", "generated/unit_scaling.LayerNorm", "generated/unit_scaling.Linear", "generated/unit_scaling.MHSA", "generated/unit_scaling.MLP", "generated/unit_scaling.Softmax", "generated/unit_scaling.TransformerDecoder", "generated/unit_scaling.TransformerLayer", "generated/unit_scaling.constraints", "generated/unit_scaling.constraints.BinaryConstraint", "generated/unit_scaling.constraints.TernaryConstraint", "generated/unit_scaling.constraints.VariadicConstraint", "generated/unit_scaling.constraints.amean", "generated/unit_scaling.constraints.gmean", "generated/unit_scaling.constraints.hmean", "generated/unit_scaling.constraints.to_grad_input_scale", "generated/unit_scaling.constraints.to_left_grad_scale", "generated/unit_scaling.constraints.to_output_scale", "generated/unit_scaling.constraints.to_right_grad_scale", "generated/unit_scaling.functional", "generated/unit_scaling.functional.add", "generated/unit_scaling.functional.cross_entropy", "generated/unit_scaling.functional.dropout", "generated/unit_scaling.functional.embedding", "generated/unit_scaling.functional.gelu", "generated/unit_scaling.functional.layer_norm", "generated/unit_scaling.functional.linear", "generated/unit_scaling.functional.matmul", "generated/unit_scaling.functional.residual_add", "generated/unit_scaling.functional.residual_split", "generated/unit_scaling.functional.scale_elementwise", "generated/unit_scaling.functional.scaled_dot_product_attention", "generated/unit_scaling.functional.softmax", "generated/unit_scaling.scale", "generated/unit_scaling.scale.scale_bwd", "generated/unit_scaling.scale.scale_fwd", "generated/unit_scaling.utils", "generated/unit_scaling.utils.ScalePair", "generated/unit_scaling.utils.ScaleTracker", "generated/unit_scaling.utils.ScaleTrackingInterpreter", "generated/unit_scaling.utils.analyse_module", "index", "limitations", "user_guide"], "filenames": ["api_reference.rst", "development.rst", "generated/unit_scaling.rst", "generated/unit_scaling.CrossEntropyLoss.rst", "generated/unit_scaling.Dropout.rst", "generated/unit_scaling.Embedding.rst", "generated/unit_scaling.GELU.rst", "generated/unit_scaling.LayerNorm.rst", "generated/unit_scaling.Linear.rst", "generated/unit_scaling.MHSA.rst", "generated/unit_scaling.MLP.rst", "generated/unit_scaling.Softmax.rst", "generated/unit_scaling.TransformerDecoder.rst", "generated/unit_scaling.TransformerLayer.rst", "generated/unit_scaling.constraints.rst", "generated/unit_scaling.constraints.BinaryConstraint.rst", "generated/unit_scaling.constraints.TernaryConstraint.rst", "generated/unit_scaling.constraints.VariadicConstraint.rst", "generated/unit_scaling.constraints.amean.rst", "generated/unit_scaling.constraints.gmean.rst", "generated/unit_scaling.constraints.hmean.rst", "generated/unit_scaling.constraints.to_grad_input_scale.rst", "generated/unit_scaling.constraints.to_left_grad_scale.rst", "generated/unit_scaling.constraints.to_output_scale.rst", "generated/unit_scaling.constraints.to_right_grad_scale.rst", "generated/unit_scaling.functional.rst", "generated/unit_scaling.functional.add.rst", "generated/unit_scaling.functional.cross_entropy.rst", "generated/unit_scaling.functional.dropout.rst", "generated/unit_scaling.functional.embedding.rst", "generated/unit_scaling.functional.gelu.rst", "generated/unit_scaling.functional.layer_norm.rst", "generated/unit_scaling.functional.linear.rst", "generated/unit_scaling.functional.matmul.rst", "generated/unit_scaling.functional.residual_add.rst", "generated/unit_scaling.functional.residual_split.rst", "generated/unit_scaling.functional.scale_elementwise.rst", "generated/unit_scaling.functional.scaled_dot_product_attention.rst", "generated/unit_scaling.functional.softmax.rst", "generated/unit_scaling.scale.rst", "generated/unit_scaling.scale.scale_bwd.rst", "generated/unit_scaling.scale.scale_fwd.rst", "generated/unit_scaling.utils.rst", "generated/unit_scaling.utils.ScalePair.rst", "generated/unit_scaling.utils.ScaleTracker.rst", "generated/unit_scaling.utils.ScaleTrackingInterpreter.rst", "generated/unit_scaling.utils.analyse_module.rst", "index.rst", "limitations.rst", "user_guide.rst"], "titles": ["<span class=\"section-number\">4. </span>API reference", "<span class=\"section-number\">2. </span>Unit Scaling", "<span class=\"section-number\">4.1. </span>unit_scaling", "<span class=\"section-number\">4.1.4. </span>unit_scaling.CrossEntropyLoss", "<span class=\"section-number\">4.1.5. </span>unit_scaling.Dropout", "<span class=\"section-number\">4.1.6. </span>unit_scaling.Embedding", "<span class=\"section-number\">4.1.1. </span>unit_scaling.GELU", "<span class=\"section-number\">4.1.7. </span>unit_scaling.LayerNorm", "<span class=\"section-number\">4.1.8. </span>unit_scaling.Linear", "<span class=\"section-number\">4.1.2. </span>unit_scaling.MHSA", "<span class=\"section-number\">4.1.3. </span>unit_scaling.MLP", "<span class=\"section-number\">4.1.9. </span>unit_scaling.Softmax", "<span class=\"section-number\">4.1.10. </span>unit_scaling.TransformerDecoder", "<span class=\"section-number\">4.1.11. </span>unit_scaling.TransformerLayer", "<span class=\"section-number\">4.2. </span>unit_scaling.constraints", "<span class=\"section-number\">4.2.1. </span>unit_scaling.constraints.BinaryConstraint", "<span class=\"section-number\">4.2.2. </span>unit_scaling.constraints.TernaryConstraint", "<span class=\"section-number\">4.2.3. </span>unit_scaling.constraints.VariadicConstraint", "<span class=\"section-number\">4.2.4. </span>unit_scaling.constraints.amean", "<span class=\"section-number\">4.2.5. </span>unit_scaling.constraints.gmean", "<span class=\"section-number\">4.2.6. </span>unit_scaling.constraints.hmean", "<span class=\"section-number\">4.2.7. </span>unit_scaling.constraints.to_grad_input_scale", "<span class=\"section-number\">4.2.8. </span>unit_scaling.constraints.to_left_grad_scale", "<span class=\"section-number\">4.2.9. </span>unit_scaling.constraints.to_output_scale", "<span class=\"section-number\">4.2.10. </span>unit_scaling.constraints.to_right_grad_scale", "<span class=\"section-number\">4.3. </span>unit_scaling.functional", "<span class=\"section-number\">4.3.1. </span>unit_scaling.functional.add", "<span class=\"section-number\">4.3.2. </span>unit_scaling.functional.cross_entropy", "<span class=\"section-number\">4.3.3. </span>unit_scaling.functional.dropout", "<span class=\"section-number\">4.3.4. </span>unit_scaling.functional.embedding", "<span class=\"section-number\">4.3.5. </span>unit_scaling.functional.gelu", "<span class=\"section-number\">4.3.6. </span>unit_scaling.functional.layer_norm", "<span class=\"section-number\">4.3.7. </span>unit_scaling.functional.linear", "<span class=\"section-number\">4.3.8. </span>unit_scaling.functional.matmul", "<span class=\"section-number\">4.3.9. </span>unit_scaling.functional.residual_add", "<span class=\"section-number\">4.3.10. </span>unit_scaling.functional.residual_split", "<span class=\"section-number\">4.3.11. </span>unit_scaling.functional.scale_elementwise", "<span class=\"section-number\">4.3.12. </span>unit_scaling.functional.scaled_dot_product_attention", "<span class=\"section-number\">4.3.13. </span>unit_scaling.functional.softmax", "<span class=\"section-number\">4.4. </span>unit_scaling.scale", "<span class=\"section-number\">4.4.1. </span>unit_scaling.scale.scale_bwd", "<span class=\"section-number\">4.4.2. </span>unit_scaling.scale.scale_fwd", "<span class=\"section-number\">4.5. </span>unit_scaling.utils", "<span class=\"section-number\">4.5.2. </span>unit_scaling.utils.ScalePair", "<span class=\"section-number\">4.5.3. </span>unit_scaling.utils.ScaleTracker", "<span class=\"section-number\">4.5.4. </span>unit_scaling.utils.ScaleTrackingInterpreter", "<span class=\"section-number\">4.5.1. </span>unit_scaling.utils.analyse_module", "Unit Scaling", "<span class=\"section-number\">3. </span>Limitations", "<span class=\"section-number\">1. </span>User guide"], "terms": {"unit": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 19, 26, 27, 28, 29, 30, 31, 32, 33, 35, 37, 38, 42, 46, 48], "scale": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 18, 19, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 37, 38, 42, 46, 48], "i": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 23, 27, 28, 29, 30, 32, 33, 35, 36, 37, 38, 44, 45, 47, 48], "implement": [0, 4, 9, 10, 11, 12, 13, 37, 46, 48, 49], "us": [0, 1, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 20, 28, 29, 33, 34, 35, 37, 38, 44, 45, 46, 47, 49], "thin": 0, "wrapper": 0, "around": 0, "exist": [0, 44, 49], "torch": [0, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 26, 27, 29, 30, 32, 33, 36, 37, 38, 44, 46, 49], "nn": [0, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 29, 44, 45, 46, 49], "class": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 27, 38, 42, 43, 44, 45, 46, 49], "function": [0, 1, 2, 4, 6, 8, 9, 10, 11, 12, 13, 14, 39, 42, 44, 45, 46, 47, 48, 49], "document": [0, 1, 5, 11, 49], "also": [0, 3, 44, 49], "inherit": 0, "from": [0, 4, 5, 7, 8, 11, 28, 44, 45, 46, 49], "standard": [0, 7, 11, 35, 43, 44, 45, 46, 49], "pytorch": [0, 1, 37, 44, 49], "doc": [0, 1], "modif": [0, 44], "note": [0, 1, 3, 5, 12, 27, 29, 33, 37, 44, 49], "some": [0, 1, 3, 27, 32, 33, 37, 47, 48, 49], "mai": [0, 3, 32, 33, 37, 44, 49], "longer": 0, "relev": 0, "ar": [0, 3, 4, 7, 8, 11, 27, 33, 35, 37, 44, 49], "nevertheless": 0, "The": [0, 3, 5, 7, 8, 11, 27, 29, 33, 35, 37, 44, 45, 47, 48, 49], "built": [0, 46], "mirror": 0, "close": 0, "possibl": [0, 29, 49], "can": [0, 1, 3, 4, 5, 37, 44, 45, 49], "easili": 0, "swap": [0, 49], "out": [0, 1, 4, 8, 26, 32, 33, 34, 44, 47, 49], "equival": [0, 3, 5, 7, 37, 46, 49], "For": [0, 1, 5, 7, 33, 37, 44, 47, 49], "code": [0, 46, 49], "which": [0, 3, 6, 7, 8, 9, 10, 11, 12, 13, 30, 32, 33, 35, 36, 38, 44, 45, 49], "follow": [0, 1, 33, 36, 37, 44, 47, 48, 49], "import": [0, 48, 49], "f": [0, 27, 29, 36, 37, 49], "appli": [0, 3, 6, 7, 8, 9, 10, 11, 12, 13, 26, 27, 28, 30, 31, 32, 33, 34, 35, 36, 37, 38, 40, 41, 44, 49], "first": [0, 1, 5, 33, 36, 44, 45, 49], "ad": [0, 7, 37, 49], "unit_sc": [0, 47, 49], "uu": [0, 49], "u": [0, 8, 46, 49], "replac": [0, 49], "letter": 0, "those": [0, 3, 27, 48, 49], "assum": [0, 21, 22, 23, 24, 37, 49], "thei": [0, 1, 44, 47, 49], "support": [0, 1, 3, 4, 5, 8, 26, 27, 28, 29, 32, 33, 37, 44, 48], "click": 0, "below": [0, 7, 11, 27, 49], "full": [0, 44, 49], "A": [1, 3, 4, 5, 9, 10, 11, 12, 13, 27, 29, 33, 37, 38, 49], "librari": [1, 47, 48, 49], "base": [1, 32, 37, 44, 49], "paper": [1, 4, 7, 47, 49], "box": [1, 47, 49], "low": [1, 47, 49], "precis": [1, 8, 33, 37, 47, 49], "train": [1, 3, 4, 5, 7, 28, 29, 47, 48, 49], "found": [1, 49], "http": [1, 13, 49], "graphcor": [1, 49], "research": [1, 49], "github": [1, 49], "io": [1, 37], "warn": [1, 9, 12, 13], "thi": [1, 3, 4, 5, 7, 8, 12, 28, 29, 32, 33, 35, 37, 38, 44, 45, 47, 48, 49], "current": [1, 12, 37, 45, 47, 48, 49], "its": [1, 33, 36, 41, 44, 47, 49], "alpha": [1, 26, 47, 49], "releas": [1, 47, 49], "mean": [1, 3, 4, 6, 7, 8, 11, 18, 19, 20, 27, 32, 47, 49], "": [1, 10, 21, 22, 23, 24, 32, 33, 37, 44, 45, 46, 47, 49], "miss": [1, 32, 33, 47, 48, 49], "should": [1, 3, 11, 27, 34, 35, 36, 37, 44, 45, 46, 47, 49], "expect": [1, 3, 7, 33, 47, 49], "work": [1, 46, 47, 48, 49], "seamlessli": [1, 47, 49], "we": [1, 44, 45, 47, 48, 49], "re": [1, 38, 47, 49], "keen": [1, 47, 49], "help": [1, 47, 49], "earli": [1, 47, 48, 49], "user": [1, 37, 44, 47], "ani": [1, 4, 6, 8, 9, 11, 12, 13, 23, 32, 37, 44, 45, 46, 47, 49], "problem": [1, 3, 47, 49], "encount": [1, 47, 49], "who": [1, 49], "wish": [1, 49], "codebas": [1, 49], "setup": 1, "requir": [1, 3, 37, 44, 48, 49], "time": [1, 7, 26, 33, 49], "python3": [1, 46], "m": [1, 4, 6, 8, 11, 33], "venv": 1, "sourc": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 18, 19, 20, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 40, 41, 43, 44, 45, 46], "bin": 1, "activ": [1, 7, 10, 12, 13, 49], "pip": [1, 49], "instal": [1, 47], "r": [1, 5, 29, 44], "dev": 1, "txt": 1, "Or": 1, "ipu": 1, "subsequ": 1, "run": [1, 37, 45, 49], "pre": [1, 45, 49], "flight": 1, "check": [1, 44, 49], "see": [1, 3, 5, 13, 27, 28, 29, 30, 31, 37, 38, 44, 45, 47, 49], "command": 1, "id": 1, "recommend": [1, 19, 47, 49], "python": [1, 46], "intepret": 1, "set": [1, 3, 4, 7, 8, 27, 28, 37, 44, 48, 49], "format": [1, 49], "save": [1, 44], "enabl": [1, 37, 39, 44, 49], "consid": [1, 3, 49], "env": [1, 44], "file": 1, "pythonpath": 1, "exampl": [1, 3, 4, 5, 6, 7, 8, 11, 12, 26, 27, 29, 33, 37, 44, 45, 46, 49], "echo": 1, "pwd": 1, "differ": [1, 8, 33, 37, 39, 49], "path": 1, "devcontain": 1, "cd": 1, "make": [1, 37, 49], "html": 1, "view": 1, "_build": 1, "index": [1, 3, 5, 29, 44], "your": [1, 44, 49], "browser": 1, "copyright": 1, "c": [1, 3, 7, 26, 27, 37, 44], "2023": [1, 47, 49], "ltd": 1, "under": [1, 29], "mit": 1, "notic": [1, 32, 33], "md": 1, "further": [1, 49], "detail": [1, 5, 27, 28, 29, 31, 38, 44, 45, 49], "version": [2, 33, 36, 49], "common": [2, 14, 26, 49], "modul": [2, 4, 5, 7, 8, 10, 12, 13, 29, 33, 45, 46, 49], "weight": [3, 5, 7, 8, 12, 13, 27, 29, 31, 32, 34, 35, 46, 49], "tensor": [3, 4, 5, 8, 11, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 40, 41, 43, 44, 45, 46, 49], "none": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 26, 27, 29, 30, 31, 32, 33, 36, 37, 38, 43, 44, 45, 46, 49], "size_averag": [3, 27], "ignore_index": [3, 27], "int": [3, 5, 7, 8, 9, 10, 11, 12, 13, 26, 27, 29, 31, 38, 44, 45, 49], "100": [3, 27], "reduc": [3, 27], "reduct": [3, 27], "str": [3, 6, 27, 45, 46], "label_smooth": [3, 27], "float": [3, 4, 5, 7, 9, 12, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 26, 27, 28, 29, 31, 33, 34, 35, 36, 37, 40, 41, 43, 45, 49], "0": [3, 4, 5, 6, 7, 11, 12, 13, 26, 27, 28, 29, 30, 34, 35, 37, 38, 44, 46, 49], "comput": [3, 4, 5, 7, 11, 18, 19, 20, 27, 29, 37, 38, 44, 49], "cross": [3, 27, 49], "entropi": [3, 27, 49], "loss": [3, 27, 49], "between": [3, 27, 35, 48, 49], "input": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 21, 22, 23, 24, 26, 27, 28, 29, 30, 31, 32, 33, 35, 36, 37, 38, 40, 41, 44, 45, 46, 49], "logit": [3, 27], "target": [3, 27, 45, 49], "It": [3, 38, 44, 49], "when": [3, 6, 7, 8, 11, 27, 30, 33, 37, 45, 49], "classif": 3, "If": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 27, 28, 29, 30, 32, 33, 36, 37, 38, 44, 45], "provid": [3, 6, 8, 9, 10, 11, 12, 13, 18, 19, 20, 21, 22, 23, 24, 30, 32, 33, 36, 37, 38, 49], "option": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 29, 30, 32, 33, 34, 35, 36, 37, 38, 44, 45, 46], "argument": [3, 6, 30, 33, 44, 45, 49], "1d": 3, "assign": 3, "each": [3, 4, 5, 7, 8, 27, 29, 37, 44, 45, 46, 49], "particularli": [3, 49], "you": [3, 32, 33, 37, 44, 48, 49], "have": [3, 5, 29, 32, 33, 44, 48, 49], "an": [3, 4, 5, 7, 8, 10, 11, 23, 28, 29, 33, 35, 36, 37, 43, 44, 45, 49], "unbalanc": 3, "contain": [3, 5, 27, 29, 43, 44, 49], "unnorm": [3, 27], "do": [3, 4, 5, 28, 29, 44, 45, 49], "need": [3, 35, 44, 46, 49], "posit": [3, 12, 45, 48], "sum": [3, 11, 27, 38], "1": [3, 4, 5, 6, 7, 8, 11, 26, 27, 29, 30, 33, 37, 38, 44, 46, 47, 49], "gener": [3, 46, 48, 49], "ha": [3, 4, 7, 27, 33, 37, 44, 48, 49], "size": [3, 5, 7, 8, 9, 10, 12, 13, 27, 29, 37, 44], "unbatch": 3, "minibatch": [3, 27], "d_1": [3, 27], "d_2": [3, 27], "d_k": [3, 27], "k": [3, 8, 27, 33, 37], "geq": [3, 27], "dimension": [3, 5, 7, 11, 27, 33], "case": [3, 27, 49], "last": [3, 7, 8, 31], "being": [3, 5, 27, 35, 44, 45], "higher": [3, 37], "dimens": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 31, 32, 33, 38, 44], "per": [3, 7, 27, 44], "pixel": 3, "2d": 3, "imag": [3, 7], "criterion": 3, "either": [3, 27, 33, 44], "indic": [3, 5, 27, 29, 37, 44], "rang": [3, 11, 38, 45, 49], "where": [3, 5, 6, 7, 8, 11, 27, 29, 30, 32, 33, 37, 49], "number": [3, 6, 8, 9, 11, 12, 13, 23, 26, 27, 29, 31, 32, 49], "specifi": [3, 5, 27, 29, 37, 38, 44, 49], "accept": [3, 44], "necessarili": 3, "unreduc": 3, "e": [3, 5, 7, 29, 33, 37, 44], "describ": [3, 4, 27], "ell": 3, "x": [3, 6, 7, 30, 44, 46, 49], "y": [3, 7, 32, 44], "l": [3, 37], "l_1": 3, "dot": [3, 33, 37], "l_n": 3, "top": 3, "quad": 3, "w_": 3, "y_n": 3, "log": [3, 49], "frac": [3, 4, 7, 8, 11, 38], "exp": [3, 11, 38], "x_": [3, 11, 38], "n": [3, 5, 7, 11, 27, 33, 37, 45], "sum_": 3, "cdot": 3, "mathbb": 3, "text": [3, 5, 6, 7, 8, 11, 26, 27, 30, 38], "ignor": [3, 27, 49], "_index": 3, "w": [3, 5, 7, 29, 44], "span": 3, "well": [3, 49], "default": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 27, 28, 29, 30, 32, 33, 34, 35, 36, 37, 38, 44, 46, 49], "begin": [3, 27, 49], "end": [3, 27, 49], "combin": [3, 32, 33, 34, 49], "logsoftmax": 3, "nllloss": 3, "probabl": [3, 4, 9, 12, 13, 27, 28, 37], "label": 3, "beyond": [3, 49], "singl": [3, 6, 7, 8, 9, 10, 11, 12, 13, 30, 32, 33, 36, 38], "item": 3, "blend": 3, "smooth": [3, 27], "etc": 3, "w_c": 3, "y_": 3, "perform": [3, 37, 38, 44, 49], "better": 3, "allow": [3, 49], "optim": [3, 37], "onli": [3, 21, 22, 23, 24, 27, 33, 40, 41, 44, 45, 49], "too": [3, 37], "restrict": [3, 33], "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 18, 19, 20, 21, 22, 23, 24, 26, 27, 28, 29, 32, 33, 34, 35, 36, 37, 38, 40, 41, 45, 46], "manual": [3, 27, 49], "rescal": [3, 11, 27], "given": [3, 5, 27, 29, 37, 44, 46, 49], "bool": [3, 4, 5, 7, 8, 27, 28, 29, 37, 44, 45, 46], "deprec": [3, 27], "By": [3, 27, 49], "averag": [3, 27], "over": [3, 7, 27, 37, 44, 49], "element": [3, 4, 7, 11, 27, 28, 30, 36, 37, 38], "batch": [3, 5, 7, 27, 29, 33], "multipl": [3, 27, 33, 40, 41, 49], "sampl": [3, 4, 5, 8, 27, 28, 29], "field": [3, 27], "fals": [3, 4, 5, 7, 8, 27, 28, 29, 37, 44, 46], "instead": [3, 27], "true": [3, 4, 5, 7, 8, 27, 28, 29, 37, 44, 45, 46], "valu": [3, 5, 7, 8, 11, 27, 37, 44, 45, 49], "doe": [3, 5, 27, 33, 49], "contribut": [3, 5, 27, 29], "gradient": [3, 5, 6, 8, 9, 10, 11, 12, 13, 21, 22, 23, 24, 27, 29, 30, 32, 33, 35, 36, 38, 44, 49], "non": [3, 5, 27, 29, 33, 44, 49], "applic": [3, 27, 44], "observ": [3, 27], "depend": [3, 27, 33, 37, 45, 49], "return": [3, 6, 8, 9, 10, 11, 12, 13, 18, 19, 20, 21, 22, 23, 24, 27, 30, 32, 33, 34, 35, 36, 37, 38, 40, 41, 44, 45, 46, 49], "output": [3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 21, 22, 23, 24, 27, 29, 32, 33, 36, 37, 44, 45, 46, 49], "taken": [3, 49], "process": [3, 5, 27, 45], "meantim": [3, 27], "two": [3, 21, 27, 33, 35, 37, 44, 49], "arg": [3, 27, 36, 44, 45], "overrid": [3, 27, 44], "amount": [3, 27], "becom": [3, 27], "mixtur": [3, 27], "origin": [3, 27, 41, 45], "ground": [3, 27], "truth": [3, 27], "uniform": [3, 27], "distribut": [3, 4, 6, 27, 28, 30, 48, 49], "rethink": [3, 27], "incept": [3, 27], "architectur": [3, 27], "vision": [3, 27], "shape": [3, 4, 5, 6, 7, 8, 11, 26, 27, 29, 32, 37, 44], "same": [3, 4, 6, 7, 8, 11, 27, 33, 37, 44, 49], "otherwis": [3, 44], "scalar": [3, 7, 33, 40, 41, 43, 49], "align": [3, 27], "randn": [3, 4, 6, 7, 8, 11, 26, 27, 46, 49], "3": [3, 5, 6, 7, 11, 26, 27, 29, 30, 49], "5": [3, 4, 5, 6, 7, 26, 27, 28, 29, 30, 49], "requires_grad": [3, 5, 27, 44], "empti": 3, "dtype": [3, 5, 7, 8, 27, 32, 33, 37, 38, 44, 45], "long": 3, "random_": 3, "backward": [3, 8, 27, 33, 35, 39, 40, 43, 44, 45, 46, 49], "softmax": [3, 9, 12, 13, 27, 37, 47, 49], "dim": [3, 11, 27, 37, 38], "p": [4, 5, 28, 29, 33], "inplac": [4, 28, 44, 46], "bernoulli": [4, 28], "channel": [4, 7], "zero": [4, 5, 7, 28, 44], "independ": 4, "everi": [4, 11, 44, 45], "forward": [4, 39, 40, 41, 43, 44, 45, 46, 49], "call": [4, 37, 44, 45, 46], "proven": 4, "effect": [4, 49], "techniqu": [4, 47, 49], "regular": 4, "prevent": [4, 38, 44], "co": 4, "adapt": [4, 49], "neuron": 4, "improv": [4, 37], "neural": 4, "network": [4, 35], "featur": [4, 32, 33, 48, 49], "detector": 4, "_": [4, 37, 44], "furthermor": 4, "factor": [4, 10, 21, 22, 23, 24, 39, 40, 41, 49], "dure": [4, 5, 29, 44, 49], "evalu": [4, 7, 45, 49], "simpli": [4, 49], "ident": [4, 49], "oper": [4, 14, 28, 32, 33, 37, 38, 39, 44, 46, 49], "place": [4, 28, 29, 44, 49], "2": [4, 5, 6, 7, 11, 12, 13, 26, 29, 30, 32, 33, 34, 35, 37, 44, 46, 49], "20": [4, 7, 8, 26], "16": [4, 49], "num_embed": 5, "embedding_dim": [5, 7, 29], "padding_idx": [5, 29], "max_norm": [5, 29], "norm_typ": [5, 29], "scale_grad_by_freq": [5, 29], "spars": [5, 11, 29, 32, 33], "_weight": 5, "_freez": 5, "devic": [5, 7, 8, 32, 33, 37, 45], "lookup": [5, 29], "tabl": [5, 29], "look": [5, 29, 33, 45, 49], "up": [5, 29, 44, 45, 49], "fix": [5, 29, 49], "dictionari": 5, "often": [5, 29, 33, 49], "store": [5, 45], "word": [5, 29], "retriev": [5, 29, 44, 45], "them": [5, 11, 38, 44, 45], "list": [5, 7, 29, 45, 48], "correspond": [5, 29, 44], "vector": [5, 29, 33], "entri": [5, 29], "therefor": [5, 29], "updat": [5, 29, 49], "remain": [5, 29], "pad": [5, 29], "newli": 5, "construct": 5, "all": [5, 8, 33, 37, 38, 44, 49], "anoth": 5, "norm": [5, 29], "larger": [5, 29, 49], "than": [5, 29, 37, 45], "renorm": [5, 29], "invers": [5, 29], "frequenc": [5, 29], "mini": [5, 7, 29], "t": [5, 29, 32, 44, 49], "matrix": [5, 29, 33], "more": [5, 29, 37, 38, 44, 48, 49], "regard": [5, 29, 49], "learnabl": [5, 7, 8], "initi": [5, 7, 8, 49], "mathcal": [5, 8], "type": [5, 8, 12, 14, 18, 19, 20, 21, 22, 23, 24, 26, 29, 30, 34, 35, 36, 37, 38, 40, 41, 45, 46], "inttensor": 5, "longtensor": [5, 29], "arbitrari": [5, 29, 43, 48, 49], "extract": [5, 29, 45], "h": [5, 7], "_dim": 5, "10": [5, 7, 26, 29, 46, 49], "4": [5, 10, 26, 29, 44, 46, 49], "9": [5, 29], "xdoctest": [5, 29, 44], "ignore_w": [5, 29], "determinist": [5, 29, 37], "0251": 5, "6902": 5, "7172": 5, "6431": 5, "0748": 5, "6969": 5, "4970": 5, "3448": 5, "9685": 5, "3677": 5, "7265": 5, "1685": 5, "4362": 5, "4004": 5, "9400": 5, "9124": 5, "3616": 5, "1151": 5, "0000": [5, 29], "1535": 5, "0309": 5, "9315": 5, "1655": 5, "9897": 5, "0635": 5, "chang": [5, 37, 49], "7895": 5, "7089": 5, "0364": 5, "6778": 5, "5803": 5, "2678": 5, "no_grad": 5, "ones": [5, 7, 37], "classmethod": 5, "from_pretrain": 5, "freez": 5, "creat": 5, "instanc": [5, 7], "floattensor": 5, "pass": [5, 35, 37, 39, 40, 41, 43, 44, 45, 46, 49], "second": [5, 33, 44], "get": [5, 47, 48, 49], "learn": [5, 8, 49], "pretrain": 5, "6": [5, 26, 46], "1000": 5, "3000": 5, "constraint": [6, 8, 9, 10, 11, 12, 13, 26, 30, 32, 33, 36, 38, 45, 47, 49], "binaryconstraint": [6, 8, 10, 11, 30, 32, 36, 38, 47], "gmean": [6, 8, 9, 10, 11, 12, 13, 26, 30, 32, 33, 36, 38, 47, 49], "gaussian": [6, 30], "error": [6, 30, 37, 44, 45], "linear": [6, 30, 46, 47, 49], "phi": [6, 30], "cumul": [6, 30], "approxim": [6, 10, 12, 13, 30, 49], "tanh": [6, 30], "estim": [6, 7, 30], "sqrt": [6, 7, 8, 30, 37], "pi": [6, 30], "044715": [6, 30], "algorithm": [6, 37], "take": [6, 8, 9, 10, 11, 12, 13, 30, 32, 33, 36, 37, 38, 49], "output_scal": [6, 8, 10, 11, 21, 22, 23, 24, 30, 32, 33, 36, 38, 49], "grad_input_scal": [6, 8, 10, 11, 21, 23, 30, 32, 36, 38, 49], "constrain": [6, 8, 9, 10, 11, 12, 13, 18, 19, 20, 30, 32, 33, 36, 38, 49], "usual": [6, 8, 10, 11, 30, 32, 36, 38, 49], "necessari": [6, 8, 10, 11, 30, 32, 33, 35, 36, 38, 44, 49], "valid": [6, 8, 10, 11, 30, 32, 33, 36, 38, 49], "normalized_shap": [7, 31], "ep": [7, 31], "1e": [7, 31, 49], "05": [7, 31, 49], "elementwise_affin": 7, "layer": [7, 8, 9, 10, 12, 13, 31, 35, 49], "normal": [7, 31, 49], "mathrm": 7, "var": 7, "epsilon": 7, "gamma": 7, "beta": [7, 32, 33, 37], "deviat": [7, 43, 44, 45, 46, 49], "calcul": 7, "d": [7, 32, 44, 46, 49], "affin": 7, "transform": [7, 8, 12, 13, 32, 36, 48, 49], "via": [7, 45, 49], "bias": 7, "unbias": 7, "unlik": [7, 49], "bia": [7, 8, 31, 32, 46, 49], "entir": [7, 49], "plane": 7, "statist": 7, "data": [7, 8, 32, 38, 45], "both": [7, 33, 37, 44, 46, 49], "mode": [7, 44], "_shape": 7, "ldot": 7, "integ": [7, 26, 44], "treat": [7, 11], "singleton": 7, "specif": [7, 37, 45], "denomin": 7, "numer": [7, 49], "stabil": 7, "boolean": [7, 37, 44], "nlp": 7, "sentence_length": 7, "embed": [7, 12, 47, 48], "layer_norm": [7, 47], "three": [7, 22, 24, 33, 37], "spatial": 7, "shown": [7, 49], "in_featur": 8, "out_featur": 8, "incom": [8, 32], "tensorfloat32": [8, 32, 33], "On": [8, 33], "certain": [8, 31, 33, 45], "rocm": [8, 33], "float16": [8, 33, 37], "addit": [8, 11, 26, 32, 49], "_featur": [8, 32], "h_": 8, "includ": [8, 32], "30": 8, "128": [8, 37], "print": [8, 46, 49], "hidden_s": [9, 10, 12, 13, 46], "head": [9, 12, 13], "dropout_p": [9, 12, 13, 37], "variadicconstraint": [9, 12, 13, 47], "multi": 9, "self": [9, 45, 46, 49], "attent": [9, 12, 13, 37, 48], "here": [9, 12, 13, 37, 48, 49], "like": [9, 12, 13, 44, 49], "give": [9, 12, 13, 49], "incorrect": [9, 12, 13, 44], "hidden": [9, 10, 12, 13], "post": [9, 12, 13, 47], "dropout": [9, 12, 13, 37, 47], "callabl": [9, 12, 13, 15, 16, 17, 33, 36, 45, 46, 49], "grad": [9, 12, 13, 23, 36, 40, 41, 44, 49], "act_fn": [10, 12, 13], "gelu": [10, 12, 13, 47, 49], "expansion_factor": 10, "intermedi": [10, 45], "increas": [10, 37, 44], "rel": [10, 12, 13, 34, 35], "so": [11, 37, 38, 44, 45, 49], "lie": [11, 38], "multipli": [11, 33, 49], "li": 11, "adjust": 11, "accordingli": 11, "defin": [11, 37, 38, 44, 49], "x_i": [11, 38], "sum_j": [11, 38], "x_j": [11, 38], "unspecifi": 11, "inf": [11, 37], "along": [11, 38, 49], "slice": [11, 38, 45], "vocab_s": 12, "tau": [12, 13, 34, 35, 49], "decod": 12, "just": [12, 44, 45, 49], "demonstr": 12, "lack": 12, "kei": [12, 37, 47, 48], "causal": [12, 37, 48], "mask": [12, 37, 48], "usag": 12, "infer": 12, "token": 12, "vocabulari": 12, "residu": [12, 13, 34, 35, 49], "branch": [12, 13, 34, 35, 49], "skip": [12, 13, 34, 35, 44, 49], "connect": [12, 13, 34, 35, 49], "prenorm": 13, "arxiv": 13, "org": 13, "ab": 13, "2002": 13, "04745": 13, "alias": 14, "alia": [15, 16, 17, 44], "union": [16, 33, 46], "tupl": [16, 33, 35, 44, 45, 46, 49], "arithmet": 18, "group": [18, 19, 20], "geometr": [19, 49], "harmon": 20, "xavier": [20, 49], "glorot": [20, 49], "select": [21, 22, 23, 24, 37], "chosen": [21, 22, 23, 24, 37], "op": [21, 22, 23, 24, 44, 45, 48, 49], "equal": [21, 22, 23, 24, 29, 35, 49], "left_grad_scal": [22, 24, 33], "right_grad_scal": [22, 24, 33], "left": [22, 24, 33, 49], "right": [22, 24, 33], "other": [26, 33, 37, 49], "ternaryconstraint": [26, 33, 47], "_i": 26, "broadcast": [26, 33], "promot": 26, "complex": [26, 45], "0202": 26, "0985": 26, "3506": 26, "6056": 26, "21": 26, "19": 26, "3944": 26, "b": [26, 32, 33, 44], "9732": 26, "3497": 26, "6245": 26, "4022": 26, "3743": 26, "7724": 26, "5811": 26, "8017": 26, "7695": 26, "3930": 26, "3672": 26, "1450": 26, "18": 26, "6971": 26, "0736": 26, "17": 26, "0994": 26, "3216": 26, "7845": 26, "1610": 26, "1868": 26, "4090": 26, "8": [26, 37, 49], "9902": 26, "3667": 26, "7": 26, "3925": 26, "6147": 26, "crossentropyloss": [27, 47, 49], "predict": 27, "section": [27, 47, 49], "divid": 27, "randint": 27, "int64": 27, "dictionaryand": 29, "row": 29, "maximum": 29, "column": 29, "modifi": [29, 44], "point": [29, 37, 49], "v": [29, 37], "embedding_matrix": 29, "rand": [29, 37], "8490": 29, "9625": 29, "6753": 29, "9666": 29, "7761": 29, "6108": 29, "6246": 29, "9751": 29, "3618": 29, "4161": 29, "2419": 29, "7383": 29, "0237": 29, "7794": 29, "0528": 29, "3385": 29, "8612": 29, "1867": 29, "zero_": 29, "5609": 29, "5384": 29, "8720": 29, "6262": 29, "2438": 29, "7471": 29, "wise": [30, 36], "param": 30, "sequenc": 31, "layernorm": [31, 47], "xa": 32, "layout": [32, 33, 45], "autograd": [32, 33, 44], "pleas": [32, 33, 37, 44, 49], "open": [32, 33], "request": [32, 33, 48], "product": [33, 37], "behavior": [33, 44], "prepend": 33, "purpos": [33, 49], "after": [33, 44], "remov": [33, 49], "least": 33, "one": [33, 37, 44, 49], "append": [33, 49], "thu": [33, 49], "must": [33, 44, 49], "j": 33, "logic": 33, "determin": [33, 49], "even": [33, 49], "though": [33, 49], "final": 33, "In": [33, 37, 44, 49], "particular": [33, 49], "mm": 33, "order": [33, 35, 37, 45, 49], "add": [34, 44, 47, 49], "togeth": [34, 49], "conjunct": [34, 35, 49], "residual_split": [34, 47, 49], "come": 34, "result": [34, 35, 45], "split": 35, "prior": [35, 44], "residual_add": [35, 47, 49], "delai": [35, 49], "still": [35, 44, 48], "normalis": 35, "typic": [35, 49], "kwarg": [36, 44, 45], "queri": 37, "attn_mask": 37, "is_caus": 37, "usewhatev": 37, "underli": 37, "implementationi": 37, "avail": [37, 49], "flash": [37, 48], "aprob": 37, "greater": 37, "effici": [37, 44, 49], "tril": 37, "diagon": 37, "els": 37, "masked_fil": 37, "attn_weight": 37, "q": 37, "transpos": 37, "math": [37, 46], "subject": 37, "There": [37, 44, 49], "flashattent": 37, "fast": 37, "memori": [37, 44, 49], "exact": [37, 49], "awar": 37, "match": 37, "abov": [37, 49], "formul": 37, "kernel": [37, 49], "cuda": 37, "backend": 37, "attempt": [37, 44], "automat": [37, 44, 46, 49], "most": [37, 44, 49], "fine": 37, "grain": 37, "control": [37, 49], "what": [37, 44, 47], "disabl": 37, "context": [37, 44], "manag": 37, "prefer": 37, "mechan": [37, 49], "sdp_kernel": 37, "enable_flash_sdp": 37, "enable_mem_efficient_sdp": 37, "enable_math_sdp": 37, "fuse": [37, 49], "limit": [37, 47], "event": 37, "rais": [37, 44], "reason": 37, "why": [37, 49], "cannot": 37, "due": 37, "natur": 37, "float64": 37, "inform": 37, "numerical_accuraci": 37, "circumst": 37, "cudnn": 37, "nondeterminist": 37, "undesir": 37, "try": [37, 49], "potenti": 37, "cost": 37, "random": [37, 44], "ev": 37, "part": 37, "score": 37, "ensur": [37, 44, 49], "kerenel": 37, "32": 37, "64": [37, 49], "enable_math": 37, "desir": [38, 49], "cast": 38, "befor": [38, 44, 45, 49], "overflow": [38, 49], "unchang": 40, "develop": [42, 47, 48, 49], "model": [42, 47, 48], "dataclass": 43, "pair": 43, "intend": [43, 44], "repres": [43, 44, 45, 46, 49], "record": [44, 45], "suppli": [44, 49], "scalepair": [44, 47], "static": 44, "ctx": 44, "functionctx": 44, "formula": 44, "differenti": 44, "vjp": 44, "overridden": 44, "subclass": 44, "mani": [44, 48, 49], "were": 44, "attribut": [44, 45], "needs_input_grad": 44, "whether": 44, "g": 44, "is_trac": 44, "autogener": 44, "vmap": 44, "jvp": 44, "written": 44, "extend": 44, "func": 44, "grad_input": 44, "got": 44, "respect": 44, "object": 44, "mark_dirti": 44, "mark": 44, "onc": [44, 48], "insid": 44, "method": [44, 45, 46, 47, 48, 49], "been": [44, 48, 49], "correct": [44, 49], "our": [44, 49], "doesn": 44, "matter": 44, "torch_doctest_autograd": 44, "staticmethod": 44, "def": [44, 46, 49], "x_npy": 44, "numpi": 44, "share": [44, 49], "storag": 44, "once_differenti": 44, "grad_output": 44, "doubl": 44, "clone": [44, 49], "would": 44, "lead": [44, 49], "wrong": 44, "engin": 44, "know": 44, "unless": 44, "runtimeerror": 44, "variabl": 44, "mark_non_differenti": 44, "alwai": 44, "go": [44, 49], "sort": 44, "idx": 44, "save_for_backward": 44, "g1": 44, "g2": 44, "saved_tensor": 44, "zeros_lik": 44, "index_add_": 44, "futur": 44, "oppos": 44, "directli": [44, 49], "leak": 44, "hook": 44, "graph": [44, 45], "saved_tensors_hook": 44, "intermediari": 44, "neither": 44, "nor": 44, "custom": 44, "decor": 44, "recomput": 44, "tutori": [44, 49], "access": 44, "through": [44, 45, 49], "made": 44, "weren": 44, "content": 44, "how": [44, 47], "z": 44, "grad_out": 44, "gx": 44, "gy": 44, "gz": 44, "save_for_forward": 44, "x_t": 44, "y_t": 44, "fwad": 44, "dual_level": 44, "a_dual": 44, "make_du": 44, "set_materialize_grad": 44, "materi": 44, "undefin": 44, "expand": 44, "simplefunc": 44, "No": 44, "handl": [44, 45], "now": [44, 49], "induc": 44, "setup_context": 44, "wai": [44, 49], "signatur": 44, "happen": 44, "info": 44, "in_dim": 44, "rule": 44, "underneath": 44, "generate_vmap_rul": 44, "choos": 44, "batch_siz": [44, 49], "while": 44, "out_dim": 44, "similar": [44, 49], "structur": [44, 45], "graphmodul": 45, "wrap": [45, 46, 49], "fx": [45, 46, 49], "execut": 45, "instrument": 45, "call_funct": 45, "dict": 45, "node": 45, "semant": 45, "invoc": 45, "keyword": 45, "compat": 45, "api": [45, 47, 49], "guarante": 45, "call_method": 45, "memory_format": 45, "call_modul": 45, "fetch_args_kwargs_from_env": 45, "fetch": 45, "concret": 45, "environ": 45, "fetch_attr": 45, "hierarchi": 45, "fulli": 45, "qualifi": 45, "name": 45, "get_attr": 45, "Will": 45, "wa": 45, "map_nodes_to_valu": 45, "recurs": [45, 46], "descend": 45, "within": [45, 49], "belong": 45, "report": 45, "realli": 45, "referenc": 45, "placehold": 45, "To": [45, 49], "tracer": 45, "target_to_funct": 45, "initial_env": 45, "enable_io_process": 45, "interpret": 45, "start": [45, 47, 49], "map": 45, "popul": 45, "partial": 45, "process_input": 45, "process_output": 45, "run_nod": 45, "recurse_modul": 46, "syntax_highlight": 46, "autowrap_modul": 46, "einop": 46, "home": 46, "runner": 46, "local": 46, "lib": 46, "site": 46, "packag": 46, "__init__": [46, 49], "py": 46, "autowrap_funct": 46, "dummi": 46, "annot": 46, "analys": [46, 49], "fed": [46, 49], "analysi": [46, 49], "plain": 46, "toggl": 46, "behavour": 46, "moduletyp": 46, "whose": 46, "without": [46, 49], "string": 46, "reflect": 46, "mlp": [46, 47, 49], "super": [46, 49], "fc1": 46, "relu": 46, "fc2": 46, "requires_grad_": [46, 49], "bwd": [46, 49], "236": 46, "fc1_weight": 46, "018": [46, 49], "54": 46, "fc1_bia": 46, "0182": 46, "51": 46, "_c": [46, 49], "_nn": [46, 49], "578": [46, 49], "204": [46, 49], "337": 46, "288": 46, "fc2_weight": 46, "00902": [46, 49], "13": 46, "fc2_bia": 46, "00904": 46, "31": 46, "linear_1": [46, 49], "235": 46, "999": [46, 49], "welcom": 47, "design": [47, 49], "facilit": 47, "outlin": [47, 49], "icml": [47, 49], "video": 47, "illustr": 47, "new": [47, 49], "guid": 47, "high": 47, "level": [47, 49], "overview": [47, 49], "blog": 47, "simpl": 47, "fp16": [47, 49], "fp8": [47, 49], "consider": 47, "optimis": 47, "licens": 47, "refer": [47, 49], "mhsa": 47, "transformerdecod": 47, "transformerlay": 47, "amean": 47, "hmean": 47, "to_grad_input_scal": 47, "to_left_grad_scal": 47, "to_output_scal": 47, "to_right_grad_scal": 47, "cross_entropi": [47, 49], "matmul": 47, "scale_elementwis": 47, "scaled_dot_product_attent": 47, "scale_bwd": 47, "scale_fwd": 47, "util": [47, 49], "analyse_modul": [47, 49], "scaletrack": 47, "scaletrackinginterpret": 47, "stage": 48, "yet": [48, 49], "roadmap": 48, "interplai": 48, "investig": [48, 49], "exhaust": 48, "encourag": 48, "touch": 48, "git": 49, "com": 49, "fork": 49, "repo": 49, "instruct": 49, "paradigm": 49, "deep": 49, "aim": 49, "involv": 49, "term": 49, "preserv": 49, "As": 49, "scratch": 49, "assumpt": 49, "advantag": 49, "great": 49, "perspect": 49, "roughli": 49, "headroom": 49, "grow": 49, "shrink": 49, "underflow": 49, "occur": 49, "becaus": 49, "although": 49, "drift": 49, "stai": 49, "test": 49, "far": 49, "smaller": 49, "behaviour": 49, "dynam": 49, "slightli": 49, "experi": 49, "decreas": 49, "faster": 49, "depth": 49, "treatment": 49, "approach": 49, "motiv": 49, "keep": 49, "sens": 49, "understand": 49, "might": 49, "fp32": 49, "bf16": 49, "issu": 49, "veri": 49, "larg": 49, "small": 49, "3e": 49, "38": 49, "45": 49, "e5": 49, "60": 49, "000": 49, "6e": 49, "e4": 49, "put": 49, "speed": 49, "discuss": 49, "scope": 49, "introduct": 49, "next": 49, "step": 49, "present": 49, "tricki": 49, "tool": 49, "easier": 49, "line": 49, "breakdown": 49, "alongsid": 49, "unscaledmlp": 49, "linear_2": 49, "deriv": 49, "fwd": 49, "annotated_cod": 49, "linear_1_weight": 49, "83": 49, "linear_1_bia": 49, "84": 49, "177": 49, "322": 49, "289": 49, "linear_2_weight": 49, "48": 49, "linear_2_bia": 49, "00894": 49, "198": 49, "firstli": 49, "decompos": 49, "secondli": 49, "fwd_scale": 49, "bwd_scale": 49, "denot": 49, "sign": 49, "receiv": 49, "These": 49, "enough": 49, "unscal": 49, "could": 49, "caus": 49, "signific": 49, "show": 49, "address": 49, "compil": 49, "drop": 49, "scaledmlp": 49, "01": 49, "716": 49, "729": 49, "707": 49, "706": 49, "693": 49, "03": 49, "979": 49, "basic": 49, "repeat": 49, "until": 49, "good": 49, "measur": 49, "someth": 49, "art": 49, "max": 49, "min": 49, "aris": 49, "seen": 49, "clearli": 49, "explod": 49, "clip": 49, "convers": 49, "tend": 49, "degrad": 49, "steadili": 49, "exactli": 49, "meet": 49, "practic": 49, "concern": 49, "significantli": 49, "merit": 49, "attain": 49, "best": 49, "divis": 49, "substanti": 49, "initialis": 49, "push": 49, "themselv": 49, "howev": 49, "solv": 49, "outsid": 49, "separ": 49, "altern": 49, "care": 49, "form": 49, "residuallay": 49, "contrast": 49, "down": 49, "domin": 49, "hyperparamet": 49, "abl": 49, "leav": 49, "tune": 49, "emploi": 49, "trick": 49, "comprehens": 49, "introduc": 49, "scenario": 49, "produc": 49, "arriv": 49, "fan_in": 49, "fan_out": 49, "grad_weight_scal": 49, "grad_bias_scal": 49, "ideal": 49, "compromis": 49, "don": 49, "extra": 49, "eager": 49, "trip": 49, "fortun": 49, "hi": 49, "overhead": 49, "elimin": 49, "fusion": 49, "stack": 49, "answer": 49, "old": 49, "jit": 49, "script": 49, "convert": 49, "torchscript": 49, "program": 49, "rectifi": 49, "much": 49, "flexibl": 49, "theori": 49, "unit_scaled_funct": 49, "unitscaledmodul": 49, "incur": 49, "naiv": 49, "benchmark": 49, "notebook": 49, "thorough": 49, "strongli": 49, "speedup": 49, "block": 49, "bug": 49, "latest": 49, "fail": 49, "recent": 49, "upgrad": 49, "preview": 49, "nightli": 49, "build": 49}, "objects": {"": [[2, 0, 0, "-", "unit_scaling"]], "unit_scaling": [[3, 1, 1, "", "CrossEntropyLoss"], [4, 1, 1, "", "Dropout"], [5, 1, 1, "", "Embedding"], [6, 1, 1, "", "GELU"], [7, 1, 1, "", "LayerNorm"], [8, 1, 1, "", "Linear"], [9, 1, 1, "", "MHSA"], [10, 1, 1, "", "MLP"], [11, 1, 1, "", "Softmax"], [12, 1, 1, "", "TransformerDecoder"], [13, 1, 1, "", "TransformerLayer"], [14, 0, 0, "-", "constraints"], [25, 0, 0, "-", "functional"], [39, 0, 0, "-", "scale"], [42, 0, 0, "-", "utils"]], "unit_scaling.Embedding": [[5, 2, 1, "", "from_pretrained"], [5, 3, 1, "", "weight"]], "unit_scaling.LayerNorm": [[7, 3, 1, "", "bias"], [7, 3, 1, "", "weight"]], "unit_scaling.Linear": [[8, 3, 1, "", "bias"], [8, 3, 1, "", "weight"]], "unit_scaling.constraints": [[15, 4, 1, "", "BinaryConstraint"], [16, 4, 1, "", "TernaryConstraint"], [17, 4, 1, "", "VariadicConstraint"], [18, 5, 1, "", "amean"], [19, 5, 1, "", "gmean"], [20, 5, 1, "", "hmean"], [21, 5, 1, "", "to_grad_input_scale"], [22, 5, 1, "", "to_left_grad_scale"], [23, 5, 1, "", "to_output_scale"], [24, 5, 1, "", "to_right_grad_scale"]], "unit_scaling.functional": [[26, 5, 1, "", "add"], [27, 5, 1, "", "cross_entropy"], [28, 5, 1, "", "dropout"], [29, 5, 1, "", "embedding"], [30, 5, 1, "", "gelu"], [31, 5, 1, "", "layer_norm"], [32, 5, 1, "", "linear"], [33, 5, 1, "", "matmul"], [34, 5, 1, "", "residual_add"], [35, 5, 1, "", "residual_split"], [36, 5, 1, "", "scale_elementwise"], [37, 5, 1, "", "scaled_dot_product_attention"], [38, 5, 1, "", "softmax"]], "unit_scaling.scale": [[40, 5, 1, "", "scale_bwd"], [41, 5, 1, "", "scale_fwd"]], "unit_scaling.utils": [[43, 1, 1, "", "ScalePair"], [44, 1, 1, "", "ScaleTracker"], [45, 1, 1, "", "ScaleTrackingInterpreter"], [46, 5, 1, "", "analyse_module"]], "unit_scaling.utils.ScaleTracker": [[44, 2, 1, "", "backward"], [44, 3, 1, "", "is_traceable"], [44, 2, 1, "", "jvp"], [44, 2, 1, "", "mark_dirty"], [44, 2, 1, "", "mark_non_differentiable"], [44, 2, 1, "", "save_for_backward"], [44, 2, 1, "", "save_for_forward"], [44, 2, 1, "", "set_materialize_grads"], [44, 2, 1, "", "setup_context"], [44, 2, 1, "", "vjp"], [44, 2, 1, "", "vmap"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[45, 2, 1, "", "call_function"], [45, 2, 1, "", "call_method"], [45, 2, 1, "", "call_module"], [45, 2, 1, "", "fetch_args_kwargs_from_env"], [45, 2, 1, "", "fetch_attr"], [45, 2, 1, "", "get_attr"], [45, 2, 1, "", "map_nodes_to_values"], [45, 2, 1, "", "output"], [45, 2, 1, "", "placeholder"], [45, 2, 1, "", "run"], [45, 2, 1, "", "run_node"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute", "4": "py:data", "5": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"], "4": ["py", "data", "Python data"], "5": ["py", "function", "Python function"]}, "titleterms": {"api": 0, "refer": 0, "unit": [1, 47, 49], "scale": [1, 39, 40, 41, 47, 49], "develop": 1, "licens": 1, "unit_sc": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46], "crossentropyloss": 3, "dropout": [4, 28], "embed": [5, 29], "gelu": [6, 30], "layernorm": 7, "linear": [8, 32], "mhsa": 9, "mlp": 10, "softmax": [11, 38], "transformerdecod": 12, "transformerlay": 13, "constraint": [14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24], "binaryconstraint": 15, "ternaryconstraint": 16, "variadicconstraint": 17, "amean": 18, "gmean": 19, "hmean": 20, "to_grad_input_scal": 21, "to_left_grad_scal": 22, "to_output_scal": 23, "to_right_grad_scal": 24, "function": [25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38], "add": 26, "cross_entropi": 27, "layer_norm": 31, "matmul": 33, "residual_add": 34, "residual_split": 35, "scale_elementwis": 36, "scaled_dot_product_attent": 37, "scale_bwd": 40, "scale_fwd": 41, "util": [42, 43, 44, 45, 46], "scalepair": 43, "scaletrack": 44, "scaletrackinginterpret": 45, "analyse_modul": 46, "content": 47, "limit": 48, "user": 49, "guid": 49, "instal": 49, "what": 49, "i": 49, "how": 49, "model": 49, "kei": 49, "consider": 49, "optimis": 49}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"API reference": [[0, "api-reference"]], "Unit Scaling": [[1, "unit-scaling"], [47, "unit-scaling"]], "Development": [[1, "development"]], "License": [[1, "license"]], "unit_scaling": [[2, "module-unit_scaling"]], "unit_scaling.CrossEntropyLoss": [[3, "unit-scaling-crossentropyloss"]], "unit_scaling.Dropout": [[4, "unit-scaling-dropout"]], "unit_scaling.Embedding": [[5, "unit-scaling-embedding"]], "unit_scaling.GELU": [[6, "unit-scaling-gelu"]], "unit_scaling.LayerNorm": [[7, "unit-scaling-layernorm"]], "unit_scaling.Linear": [[8, "unit-scaling-linear"]], "unit_scaling.MHSA": [[9, "unit-scaling-mhsa"]], "unit_scaling.MLP": [[10, "unit-scaling-mlp"]], "unit_scaling.Softmax": [[11, "unit-scaling-softmax"]], "unit_scaling.TransformerDecoder": [[12, "unit-scaling-transformerdecoder"]], "unit_scaling.TransformerLayer": [[13, "unit-scaling-transformerlayer"]], "unit_scaling.constraints": [[14, "module-unit_scaling.constraints"]], "unit_scaling.constraints.BinaryConstraint": [[15, "unit-scaling-constraints-binaryconstraint"]], "unit_scaling.constraints.TernaryConstraint": [[16, "unit-scaling-constraints-ternaryconstraint"]], "unit_scaling.constraints.VariadicConstraint": [[17, "unit-scaling-constraints-variadicconstraint"]], "unit_scaling.constraints.amean": [[18, "unit-scaling-constraints-amean"]], "unit_scaling.constraints.gmean": [[19, "unit-scaling-constraints-gmean"]], "unit_scaling.constraints.hmean": [[20, "unit-scaling-constraints-hmean"]], "unit_scaling.constraints.to_grad_input_scale": [[21, "unit-scaling-constraints-to-grad-input-scale"]], "unit_scaling.constraints.to_left_grad_scale": [[22, "unit-scaling-constraints-to-left-grad-scale"]], "unit_scaling.constraints.to_output_scale": [[23, "unit-scaling-constraints-to-output-scale"]], "unit_scaling.constraints.to_right_grad_scale": [[24, "unit-scaling-constraints-to-right-grad-scale"]], "unit_scaling.functional": [[25, "module-unit_scaling.functional"]], "unit_scaling.functional.add": [[26, "unit-scaling-functional-add"]], "unit_scaling.functional.cross_entropy": [[27, "unit-scaling-functional-cross-entropy"]], "unit_scaling.functional.dropout": [[28, "unit-scaling-functional-dropout"]], "unit_scaling.functional.embedding": [[29, "unit-scaling-functional-embedding"]], "unit_scaling.functional.gelu": [[30, "unit-scaling-functional-gelu"]], "unit_scaling.functional.layer_norm": [[31, "unit-scaling-functional-layer-norm"]], "unit_scaling.functional.linear": [[32, "unit-scaling-functional-linear"]], "unit_scaling.functional.matmul": [[33, "unit-scaling-functional-matmul"]], "unit_scaling.functional.residual_add": [[34, "unit-scaling-functional-residual-add"]], "unit_scaling.functional.residual_split": [[35, "unit-scaling-functional-residual-split"]], "unit_scaling.functional.scale_elementwise": [[36, "unit-scaling-functional-scale-elementwise"]], "unit_scaling.functional.scaled_dot_product_attention": [[37, "unit-scaling-functional-scaled-dot-product-attention"]], "unit_scaling.functional.softmax": [[38, "unit-scaling-functional-softmax"]], "unit_scaling.scale": [[39, "module-unit_scaling.scale"]], "unit_scaling.scale.scale_bwd": [[40, "unit-scaling-scale-scale-bwd"]], "unit_scaling.scale.scale_fwd": [[41, "unit-scaling-scale-scale-fwd"]], "unit_scaling.utils": [[42, "module-unit_scaling.utils"]], "unit_scaling.utils.ScalePair": [[43, "unit-scaling-utils-scalepair"]], "unit_scaling.utils.ScaleTracker": [[44, "unit-scaling-utils-scaletracker"]], "unit_scaling.utils.ScaleTrackingInterpreter": [[45, "unit-scaling-utils-scaletrackinginterpreter"]], "unit_scaling.utils.analyse_module": [[46, "unit-scaling-utils-analyse-module"]], "Contents": [[47, null]], "Limitations": [[48, "limitations"]], "User guide": [[49, "user-guide"]], "Installation": [[49, "installation"]], "What is unit scaling?": [[49, "what-is-unit-scaling"]], "How to unit-scale a model": [[49, "how-to-unit-scale-a-model"]], "Key considerations for unit scaling": [[49, "key-considerations-for-unit-scaling"]], "Optimising unit-scaled models": [[49, "optimising-unit-scaled-models"]]}, "indexentries": {"module": [[2, "module-unit_scaling"], [14, "module-unit_scaling.constraints"], [25, "module-unit_scaling.functional"], [39, "module-unit_scaling.scale"], [42, "module-unit_scaling.utils"]], "unit_scaling": [[2, "module-unit_scaling"]], "crossentropyloss (class in unit_scaling)": [[3, "unit_scaling.CrossEntropyLoss"]], "dropout (class in unit_scaling)": [[4, "unit_scaling.Dropout"]], "embedding (class in unit_scaling)": [[5, "unit_scaling.Embedding"]], "from_pretrained() (unit_scaling.embedding class method)": [[5, "unit_scaling.Embedding.from_pretrained"]], "weight (unit_scaling.embedding attribute)": [[5, "unit_scaling.Embedding.weight"]], "gelu (class in unit_scaling)": [[6, "unit_scaling.GELU"]], "layernorm (class in unit_scaling)": [[7, "unit_scaling.LayerNorm"]], "bias (unit_scaling.layernorm attribute)": [[7, "unit_scaling.LayerNorm.bias"]], "weight (unit_scaling.layernorm attribute)": [[7, "unit_scaling.LayerNorm.weight"]], "linear (class in unit_scaling)": [[8, "unit_scaling.Linear"]], "bias (unit_scaling.linear attribute)": [[8, "unit_scaling.Linear.bias"]], "weight (unit_scaling.linear attribute)": [[8, "unit_scaling.Linear.weight"]], "mhsa (class in unit_scaling)": [[9, "unit_scaling.MHSA"]], "mlp (class in unit_scaling)": [[10, "unit_scaling.MLP"]], "softmax (class in unit_scaling)": [[11, "unit_scaling.Softmax"]], "transformerdecoder (class in unit_scaling)": [[12, "unit_scaling.TransformerDecoder"]], "transformerlayer (class in unit_scaling)": [[13, "unit_scaling.TransformerLayer"]], "unit_scaling.constraints": [[14, "module-unit_scaling.constraints"]], "binaryconstraint (in module unit_scaling.constraints)": [[15, "unit_scaling.constraints.BinaryConstraint"]], "ternaryconstraint (in module unit_scaling.constraints)": [[16, "unit_scaling.constraints.TernaryConstraint"]], "variadicconstraint (in module unit_scaling.constraints)": [[17, "unit_scaling.constraints.VariadicConstraint"]], "amean() (in module unit_scaling.constraints)": [[18, "unit_scaling.constraints.amean"]], "gmean() (in module unit_scaling.constraints)": [[19, "unit_scaling.constraints.gmean"]], "hmean() (in module unit_scaling.constraints)": [[20, "unit_scaling.constraints.hmean"]], "to_grad_input_scale() (in module unit_scaling.constraints)": [[21, "unit_scaling.constraints.to_grad_input_scale"]], "to_left_grad_scale() (in module unit_scaling.constraints)": [[22, "unit_scaling.constraints.to_left_grad_scale"]], "to_output_scale() (in module unit_scaling.constraints)": [[23, "unit_scaling.constraints.to_output_scale"]], "to_right_grad_scale() (in module unit_scaling.constraints)": [[24, "unit_scaling.constraints.to_right_grad_scale"]], "unit_scaling.functional": [[25, "module-unit_scaling.functional"]], "add() (in module unit_scaling.functional)": [[26, "unit_scaling.functional.add"]], "cross_entropy() (in module unit_scaling.functional)": [[27, "unit_scaling.functional.cross_entropy"]], "dropout() (in module unit_scaling.functional)": [[28, "unit_scaling.functional.dropout"]], "embedding() (in module unit_scaling.functional)": [[29, "unit_scaling.functional.embedding"]], "gelu() (in module unit_scaling.functional)": [[30, "unit_scaling.functional.gelu"]], "layer_norm() (in module unit_scaling.functional)": [[31, "unit_scaling.functional.layer_norm"]], "linear() (in module unit_scaling.functional)": [[32, "unit_scaling.functional.linear"]], "matmul() (in module unit_scaling.functional)": [[33, "unit_scaling.functional.matmul"]], "residual_add() (in module unit_scaling.functional)": [[34, "unit_scaling.functional.residual_add"]], "residual_split() (in module unit_scaling.functional)": [[35, "unit_scaling.functional.residual_split"]], "scale_elementwise() (in module unit_scaling.functional)": [[36, "unit_scaling.functional.scale_elementwise"]], "scaled_dot_product_attention() (in module unit_scaling.functional)": [[37, "unit_scaling.functional.scaled_dot_product_attention"]], "softmax() (in module unit_scaling.functional)": [[38, "unit_scaling.functional.softmax"]], "unit_scaling.scale": [[39, "module-unit_scaling.scale"]], "scale_bwd() (in module unit_scaling.scale)": [[40, "unit_scaling.scale.scale_bwd"]], "scale_fwd() (in module unit_scaling.scale)": [[41, "unit_scaling.scale.scale_fwd"]], "unit_scaling.utils": [[42, "module-unit_scaling.utils"]], "scalepair (class in unit_scaling.utils)": [[43, "unit_scaling.utils.ScalePair"]], "scaletracker (class in unit_scaling.utils)": [[44, "unit_scaling.utils.ScaleTracker"]], "backward() (unit_scaling.utils.scaletracker static method)": [[44, "unit_scaling.utils.ScaleTracker.backward"]], "is_traceable (unit_scaling.utils.scaletracker attribute)": [[44, "unit_scaling.utils.ScaleTracker.is_traceable"]], "jvp() (unit_scaling.utils.scaletracker static method)": [[44, "unit_scaling.utils.ScaleTracker.jvp"]], "mark_dirty() (unit_scaling.utils.scaletracker method)": [[44, "unit_scaling.utils.ScaleTracker.mark_dirty"]], "mark_non_differentiable() (unit_scaling.utils.scaletracker method)": [[44, "unit_scaling.utils.ScaleTracker.mark_non_differentiable"]], "save_for_backward() (unit_scaling.utils.scaletracker method)": [[44, "unit_scaling.utils.ScaleTracker.save_for_backward"]], "save_for_forward() (unit_scaling.utils.scaletracker method)": [[44, "unit_scaling.utils.ScaleTracker.save_for_forward"]], "set_materialize_grads() (unit_scaling.utils.scaletracker method)": [[44, "unit_scaling.utils.ScaleTracker.set_materialize_grads"]], "setup_context() (unit_scaling.utils.scaletracker static method)": [[44, "unit_scaling.utils.ScaleTracker.setup_context"]], "vjp() (unit_scaling.utils.scaletracker static method)": [[44, "unit_scaling.utils.ScaleTracker.vjp"]], "vmap() (unit_scaling.utils.scaletracker static method)": [[44, "unit_scaling.utils.ScaleTracker.vmap"]], "scaletrackinginterpreter (class in unit_scaling.utils)": [[45, "unit_scaling.utils.ScaleTrackingInterpreter"]], "call_function() (unit_scaling.utils.scaletrackinginterpreter method)": [[45, "unit_scaling.utils.ScaleTrackingInterpreter.call_function"]], "call_method() (unit_scaling.utils.scaletrackinginterpreter method)": [[45, "unit_scaling.utils.ScaleTrackingInterpreter.call_method"]], "call_module() (unit_scaling.utils.scaletrackinginterpreter method)": [[45, "unit_scaling.utils.ScaleTrackingInterpreter.call_module"]], "fetch_args_kwargs_from_env() (unit_scaling.utils.scaletrackinginterpreter method)": [[45, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_args_kwargs_from_env"]], "fetch_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[45, "unit_scaling.utils.ScaleTrackingInterpreter.fetch_attr"]], "get_attr() (unit_scaling.utils.scaletrackinginterpreter method)": [[45, "unit_scaling.utils.ScaleTrackingInterpreter.get_attr"]], "map_nodes_to_values() (unit_scaling.utils.scaletrackinginterpreter method)": [[45, "unit_scaling.utils.ScaleTrackingInterpreter.map_nodes_to_values"]], "output() (unit_scaling.utils.scaletrackinginterpreter method)": [[45, "unit_scaling.utils.ScaleTrackingInterpreter.output"]], "placeholder() (unit_scaling.utils.scaletrackinginterpreter method)": [[45, "unit_scaling.utils.ScaleTrackingInterpreter.placeholder"]], "run() (unit_scaling.utils.scaletrackinginterpreter method)": [[45, "unit_scaling.utils.ScaleTrackingInterpreter.run"]], "run_node() (unit_scaling.utils.scaletrackinginterpreter method)": [[45, "unit_scaling.utils.ScaleTrackingInterpreter.run_node"]], "analyse_module() (in module unit_scaling.utils)": [[46, "unit_scaling.utils.analyse_module"]]}})