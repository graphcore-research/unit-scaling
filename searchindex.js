Search.setIndex({"docnames": ["api_reference", "development", "generated/unit_scaling", "generated/unit_scaling.CrossEntropyLoss", "generated/unit_scaling.Dropout", "generated/unit_scaling.Embedding", "generated/unit_scaling.GELU", "generated/unit_scaling.LayerNorm", "generated/unit_scaling.Linear", "generated/unit_scaling.MHSA", "generated/unit_scaling.MLP", "generated/unit_scaling.Softmax", "generated/unit_scaling.TransformerDecoder", "generated/unit_scaling.TransformerLayer", "index", "limitations", "user_guide"], "filenames": ["api_reference.rst", "development.rst", "generated/unit_scaling.rst", "generated/unit_scaling.CrossEntropyLoss.rst", "generated/unit_scaling.Dropout.rst", "generated/unit_scaling.Embedding.rst", "generated/unit_scaling.GELU.rst", "generated/unit_scaling.LayerNorm.rst", "generated/unit_scaling.Linear.rst", "generated/unit_scaling.MHSA.rst", "generated/unit_scaling.MLP.rst", "generated/unit_scaling.Softmax.rst", "generated/unit_scaling.TransformerDecoder.rst", "generated/unit_scaling.TransformerLayer.rst", "index.rst", "limitations.rst", "user_guide.rst"], "titles": ["API Reference", "Unit Scaling", "unit_scaling", "unit_scaling.CrossEntropyLoss", "unit_scaling.Dropout", "unit_scaling.Embedding", "unit_scaling.GELU", "unit_scaling.LayerNorm", "unit_scaling.Linear", "unit_scaling.MHSA", "unit_scaling.MLP", "unit_scaling.Softmax", "unit_scaling.TransformerDecoder", "unit_scaling.TransformerLayer", "Unit Scaling", "Limitations", "User Guide"], "terms": {"unit": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15], "scale": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 15], "i": [0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15], "implement": [0, 4, 9, 10, 11, 12, 13, 15, 16], "us": [0, 1, 3, 4, 5, 6, 7, 8, 9, 12, 13, 14, 16], "thin": 0, "wrapper": 0, "around": 0, "exist": [0, 16], "torch": [0, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 16], "nn": [0, 2, 3, 4, 5, 6, 7, 8, 10, 11, 12, 13, 16], "class": [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 16], "function": [0, 1, 2, 4, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16], "document": [0, 1, 5], "also": [0, 3, 16], "inherit": 0, "from": [0, 4, 5, 7, 8, 11, 16], "standard": [0, 7, 11, 16], "pytorch": [0, 1, 16], "doc": [0, 1, 11], "modif": 0, "note": [0, 1, 3, 5, 12, 16], "some": [0, 3, 15, 16], "mai": [0, 3, 16], "longer": 0, "relev": 0, "ar": [0, 1, 3, 4, 7, 8, 11, 14, 15, 16], "nevertheless": 0, "The": [0, 3, 5, 7, 8, 11, 15, 16], "built": 0, "mirror": 0, "close": 0, "possibl": [0, 16], "can": [0, 1, 3, 4, 5, 16], "easili": 0, "swap": [0, 16], "out": [0, 1, 4, 8, 14, 16], "equival": [0, 3, 5, 7, 16], "For": [0, 1, 5, 7, 14, 16], "code": [0, 16], "which": [0, 3, 7, 9, 10, 11, 12, 13, 16], "follow": [0, 1, 15, 16], "import": [0, 1, 14, 15, 16], "f": [0, 16], "appli": [0, 3, 6, 7, 8, 9, 10, 11, 12, 13, 16], "first": [0, 1, 5, 16], "ad": [0, 7, 16], "unit_sc": [0, 14, 16], "uu": [0, 16], "u": [0, 8, 16], "replac": [0, 2, 16], "letter": 0, "those": [0, 3, 15, 16], "assum": [0, 16], "thei": [0, 1, 14, 15, 16], "support": [0, 1, 3, 4, 5, 8, 15], "click": 0, "below": [0, 7, 11, 16], "full": [0, 16], "A": [1, 2, 3, 4, 5, 9, 10, 11, 12, 13, 16], "librari": [1, 14, 15, 16], "base": [1, 16], "paper": [1, 4, 7, 14, 16], "box": [1, 14, 16], "low": [1, 14, 16], "precis": [1, 8, 14, 16], "train": [1, 3, 4, 5, 7, 14, 15, 16], "found": [1, 16], "http": [1, 13, 16], "graphcor": [1, 16], "research": [1, 16], "github": [1, 16], "io": 1, "warn": [1, 9, 12, 13, 14, 16], "thi": [1, 3, 4, 5, 7, 8, 12, 14, 15, 16], "current": [1, 12, 14, 15, 16], "its": [1, 14, 16], "alpha": 1, "releas": [1, 14, 16], "mean": [1, 3, 4, 6, 7, 8, 11, 14, 15, 16], "unoptimis": [1, 14, 16], "miss": [1, 14, 15, 16], "we": [1, 14, 15, 16], "hope": [1, 14, 16], "user": [1, 14, 15], "still": [1, 14, 15, 16], "find": [1, 14, 16], "valuabl": [1, 14, 16], "should": [1, 3, 11, 14, 16], "expect": [1, 3, 7, 14, 16], "work": [1, 14, 15, 16], "seamlessli": [1, 14, 16], "keen": [1, 14, 16], "help": [1, 14, 16], "earli": [1, 14, 15, 16], "ani": [1, 4, 6, 8, 9, 11, 12, 13, 14, 16], "problem": [1, 3, 14, 15, 16], "encount": [1, 14, 16], "who": [1, 16], "wish": [1, 16], "codebas": [1, 16], "setup": 1, "requir": [1, 3, 15, 16], "time": [1, 7], "python3": 1, "m": [1, 4, 6, 8, 11], "venv": 1, "sourc": [1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "bin": 1, "activ": [1, 7, 10, 12, 13, 16], "pip": [1, 16], "instal": [1, 14], "r": [1, 5], "dev": 1, "txt": 1, "Or": 1, "ipu": 1, "subsequ": 1, "run": [1, 16], "pre": [1, 16], "flight": 1, "check": [1, 16], "see": [1, 3, 5, 13, 14, 16], "command": 1, "id": 1, "recommend": [1, 14, 16], "python": 1, "intepret": 1, "set": [1, 3, 4, 7, 8, 15, 16], "format": [1, 16], "save": 1, "enabl": [1, 16], "consid": [1, 3, 16], "env": 1, "file": 1, "pythonpath": 1, "e": [1, 3, 5, 7, 11, 12, 16], "g": [1, 11, 12], "echo": 1, "pwd": 1, "differ": [1, 8, 16], "path": 1, "devcontain": 1, "cd": 1, "make": [1, 16], "html": 1, "view": 1, "_build": 1, "index": [1, 3, 5], "your": [1, 16], "browser": 1, "copyright": 1, "c": [1, 3, 7], "2023": [1, 14, 16], "ltd": 1, "under": 1, "mit": 1, "notic": 1, "md": 1, "further": [1, 16], "detail": [1, 5, 16], "version": [2, 16], "variou": 2, "weight": [3, 5, 7, 8, 12, 13, 16], "tensor": [3, 4, 5, 8, 11, 16], "none": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 16], "size_averag": 3, "ignore_index": 3, "int": [3, 5, 7, 8, 9, 10, 11, 12, 13, 16], "100": 3, "reduc": 3, "reduct": 3, "str": [3, 6], "label_smooth": 3, "float": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 16], "0": [3, 4, 5, 6, 7, 11, 12, 13, 16], "comput": [3, 4, 5, 7, 11, 16], "cross": [3, 16], "entropi": [3, 16], "loss": [3, 16], "between": [3, 15, 16], "input": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 16], "logit": 3, "target": [3, 16], "It": [3, 16], "when": [3, 6, 7, 8, 11, 16], "classif": 3, "If": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "provid": [3, 6, 8, 9, 10, 11, 12, 13, 16], "option": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13], "argument": [3, 6, 16], "1d": 3, "assign": 3, "each": [3, 4, 5, 7, 8, 16], "particularli": [3, 16], "you": 3, "have": [3, 5, 15, 16], "an": [3, 4, 5, 7, 8, 10, 11, 16], "unbalanc": 3, "contain": [3, 5, 16], "unnorm": 3, "do": [3, 4, 5], "need": [3, 16], "posit": [3, 12, 15], "sum": [3, 11], "1": [3, 4, 5, 6, 7, 8, 11, 16], "gener": [3, 15, 16], "ha": [3, 4, 7, 15, 16], "size": [3, 5, 7, 8, 9, 10, 12, 13], "unbatch": 3, "minibatch": 3, "d_1": 3, "d_2": 3, "d_k": 3, "k": [3, 8], "geq": 3, "dimension": [3, 5, 7, 11], "case": [3, 16], "last": [3, 7, 8], "being": [3, 5], "higher": 3, "dimens": [3, 5, 6, 7, 8, 9, 10, 11, 12, 13], "per": [3, 7], "pixel": 3, "2d": 3, "imag": [3, 7], "criterion": 3, "either": 3, "indic": [3, 5], "rang": [3, 11, 16], "where": [3, 5, 6, 7, 8, 11, 16], "number": [3, 6, 8, 9, 11, 12, 13, 16], "specifi": [3, 5, 16], "accept": 3, "necessarili": 3, "unreduc": 3, "describ": [3, 4], "ell": 3, "x": [3, 6, 7, 16], "y": [3, 7], "l": 3, "l_1": 3, "dot": 3, "l_n": 3, "top": 3, "quad": 3, "w_": 3, "y_n": 3, "log": [3, 16], "frac": [3, 4, 7, 8, 11], "exp": [3, 11], "x_": [3, 11], "n": [3, 5, 7, 11], "sum_": 3, "cdot": 3, "mathbb": 3, "text": [3, 5, 6, 7, 8, 11], "ignor": [3, 16], "_index": 3, "w": [3, 5, 7], "span": 3, "well": [3, 16], "default": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 16], "begin": [3, 16], "end": [3, 16], "combin": [3, 16], "logsoftmax": 3, "nllloss": 3, "probabl": [3, 4, 9, 12, 13], "label": 3, "beyond": [3, 16], "singl": [3, 6, 7, 8, 9, 10, 11, 12, 13], "item": 3, "blend": 3, "smooth": 3, "etc": 3, "w_c": 3, "y_": 3, "perform": 3, "better": 3, "allow": [3, 16], "optim": 3, "onli": [3, 16], "too": 3, "restrict": 3, "paramet": [3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "manual": 3, "rescal": [3, 11], "given": [3, 5, 16], "bool": [3, 4, 5, 7, 8], "deprec": 3, "By": [3, 16], "averag": 3, "over": [3, 7, 16], "element": [3, 4, 7, 11], "batch": [3, 5, 7], "multipl": 3, "sampl": [3, 4, 5, 8], "field": 3, "fals": [3, 4, 5, 7, 8], "instead": 3, "true": [3, 4, 5, 7, 8], "valu": [3, 5, 7, 8, 11, 16], "doe": [3, 5, 16], "contribut": [3, 5], "gradient": [3, 5, 6, 8, 9, 10, 11, 12, 13, 16], "non": [3, 5, 15, 16], "applic": 3, "observ": 3, "depend": [3, 16], "return": [3, 6, 8, 9, 10, 11, 12, 13, 16], "output": [3, 4, 5, 6, 7, 8, 9, 11, 12, 13, 16], "taken": [3, 16], "process": [3, 5], "meantim": 3, "two": [3, 16], "arg": 3, "overrid": 3, "amount": 3, "becom": 3, "mixtur": 3, "origin": 3, "ground": 3, "truth": 3, "uniform": 3, "distribut": [3, 4, 6, 15, 16], "rethink": 3, "incept": 3, "architectur": 3, "vision": 3, "shape": [3, 4, 5, 6, 7, 8, 11], "same": [3, 4, 6, 7, 8, 11, 16], "otherwis": 3, "scalar": [3, 7, 16], "align": 3, "exampl": [3, 4, 5, 6, 7, 8, 11, 16], "randn": [3, 4, 6, 7, 8, 11, 16], "3": [3, 5, 6, 7, 11, 16], "5": [3, 4, 5, 6, 7, 16], "requires_grad": [3, 5], "empti": 3, "dtype": [3, 5, 7, 8], "long": 3, "random_": 3, "backward": [3, 8, 16], "softmax": [3, 9, 12, 13, 14, 16], "dim": [3, 11], "p": [4, 5], "inplac": 4, "bernoulli": 4, "channel": [4, 7], "zero": [4, 5, 7], "independ": 4, "everi": [4, 11], "forward": [4, 16], "call": 4, "proven": 4, "effect": [4, 16], "techniqu": [4, 14, 16], "regular": 4, "prevent": 4, "co": 4, "adapt": [4, 16], "neuron": 4, "improv": 4, "neural": 4, "network": 4, "featur": [4, 15, 16], "detector": 4, "_": 4, "furthermor": 4, "factor": [4, 10, 15, 16], "dure": [4, 5, 16], "evalu": [4, 7], "modul": [4, 5, 7, 8, 10, 12, 13, 16], "simpli": [4, 16], "ident": [4, 16], "oper": [4, 15, 16], "place": [4, 16], "2": [4, 5, 6, 7, 11, 12, 13, 16], "20": [4, 7, 8], "16": [4, 16], "num_embed": 5, "embedding_dim": [5, 7], "padding_idx": 5, "max_norm": 5, "norm_typ": 5, "scale_grad_by_freq": 5, "spars": [5, 11], "_weight": 5, "_freez": 5, "devic": [5, 7, 8], "lookup": 5, "tabl": 5, "look": [5, 16], "up": [5, 16], "fix": 5, "dictionari": 5, "often": [5, 16], "store": 5, "word": 5, "retriev": 5, "them": [5, 11], "list": [5, 7, 15], "correspond": 5, "vector": 5, "entri": 5, "therefor": 5, "updat": [5, 16], "remain": 5, "pad": 5, "newli": 5, "construct": 5, "all": [5, 8, 16], "anoth": 5, "norm": 5, "larger": [5, 16], "than": [5, 15], "renorm": 5, "invers": 5, "frequenc": 5, "mini": [5, 7], "t": [5, 16], "matrix": 5, "more": [5, 15, 16], "regard": [5, 16], "learnabl": [5, 7, 8], "initi": [5, 7, 8, 16], "mathcal": [5, 8], "type": [5, 6, 8, 9, 10, 11, 12, 13], "inttensor": 5, "longtensor": 5, "arbitrari": [5, 15, 16], "extract": 5, "h": [5, 7], "_dim": 5, "10": [5, 7, 16], "4": [5, 10, 16], "9": 5, "xdoctest": 5, "ignore_w": 5, "determinist": 5, "0251": 5, "6902": 5, "7172": 5, "6431": 5, "0748": 5, "6969": 5, "4970": 5, "3448": 5, "9685": 5, "3677": 5, "7265": 5, "1685": 5, "4362": 5, "4004": 5, "9400": 5, "9124": 5, "3616": 5, "1151": 5, "0000": 5, "1535": 5, "0309": 5, "9315": 5, "1655": 5, "9897": 5, "0635": 5, "chang": [5, 16], "7895": 5, "7089": 5, "0364": 5, "6778": 5, "5803": 5, "2678": 5, "no_grad": 5, "ones": [5, 7], "classmethod": 5, "from_pretrain": 5, "freez": 5, "creat": 5, "instanc": [5, 7], "floattensor": 5, "pass": [5, 16], "second": 5, "get": [5, 14, 15], "learn": [5, 8, 16], "pretrain": 5, "6": 5, "1000": 5, "3000": 5, "constraint": [6, 8, 9, 10, 11, 12, 13, 16], "callabl": [6, 8, 9, 10, 11, 12, 13, 16], "gmean": [6, 8, 9, 10, 11, 12, 13, 16], "gaussian": 6, "error": 6, "linear": [6, 14, 16], "phi": 6, "cumul": 6, "approxim": [6, 10, 12, 13, 16], "tanh": 6, "estim": [6, 7], "sqrt": [6, 7, 8], "pi": 6, "044715": 6, "algorithm": 6, "binaryconstraint": [6, 8, 10, 11], "whichtak": [6, 8, 10, 11], "output_scal": [6, 8, 10, 11, 16], "grad_input_scal": [6, 8, 10, 11, 16], "constrain": [6, 8, 9, 10, 11, 12, 13, 16], "usual": [6, 8, 10, 11, 16], "necessari": [6, 8, 10, 11, 16], "valid": [6, 8, 10, 11, 16], "normalized_shap": 7, "ep": 7, "1e": [7, 16], "05": [7, 16], "elementwise_affin": 7, "layer": [7, 8, 9, 10, 12, 13, 16], "normal": [7, 16], "mathrm": 7, "var": 7, "epsilon": 7, "gamma": 7, "beta": 7, "deviat": [7, 16], "calcul": 7, "d": [7, 16], "affin": 7, "transform": [7, 8, 12, 13, 15, 16], "via": 7, "bias": 7, "unbias": 7, "unlik": [7, 16], "bia": [7, 8, 16], "entir": 7, "plane": 7, "statist": 7, "data": [7, 8], "both": [7, 16], "mode": 7, "_shape": 7, "ldot": 7, "integ": 7, "treat": [7, 11], "singleton": 7, "specif": 7, "denomin": 7, "numer": [7, 16], "stabil": 7, "boolean": 7, "nlp": 7, "sentence_length": 7, "embed": [7, 12, 14, 15], "layer_norm": 7, "three": 7, "spatial": 7, "shown": [7, 16], "in_featur": 8, "out_featur": 8, "incom": 8, "tensorfloat32": 8, "On": 8, "certain": 8, "rocm": 8, "float16": 8, "addit": [8, 11, 16], "_featur": 8, "h_": 8, "includ": 8, "30": 8, "128": 8, "print": [8, 16], "hidden_s": [9, 10, 12, 13], "head": [9, 12, 13], "dropout_p": [9, 12, 13], "multi": 9, "self": [9, 16], "attent": [9, 12, 13, 15], "here": [9, 12, 13, 15, 16], "like": [9, 12, 13, 16], "give": [9, 12, 13, 16], "incorrect": [9, 12, 13], "hidden": [9, 10, 12, 13], "post": [9, 12, 13], "dropout": [9, 12, 13, 14], "take": [9, 12, 13, 16], "grad": [9, 12, 13, 16], "act_fn": [10, 12, 13], "gelu": [10, 12, 13, 14, 16], "expansion_factor": 10, "": [10, 16], "intermedi": 10, "increas": 10, "rel": [10, 12, 13], "so": [11, 16], "lie": 11, "multipli": [11, 16], "li": 11, "therein": 11, "adjust": 11, "accordingli": 11, "defin": [11, 16], "x_i": 11, "sum_j": 11, "x_j": 11, "unspecifi": 11, "inf": 11, "along": [11, 16], "slice": 11, "vocab_s": 12, "tau": [12, 13, 16], "decod": 12, "just": 12, "demonstr": 12, "lack": 12, "kei": [12, 14, 15], "causal": [12, 15], "mask": [12, 15], "usag": 12, "infer": 12, "token": 12, "vocabulari": 12, "residu": [12, 13, 16], "branch": [12, 13, 16], "skip": [12, 13, 16], "connect": [12, 13, 16], "prenorm": 13, "arxiv": 13, "org": 13, "ab": 13, "2002": 13, "04745": 13, "_alpha_": [14, 16], "welcom": 14, "design": [14, 16], "facilit": 14, "method": [14, 15, 16], "outlin": 14, "icml": [14, 16], "new": 14, "start": [14, 16], "our": [14, 16], "guid": 14, "high": 14, "level": [14, 16], "overview": [14, 16], "simpl": 14, "fp16": [14, 16], "fp8": [14, 16], "what": 14, "how": 14, "model": [14, 15], "consider": 14, "develop": [14, 15, 16], "licens": 14, "limit": 14, "api": [14, 16], "refer": [14, 16], "mhsa": 14, "mlp": [14, 16], "crossentropyloss": [14, 16], "layernorm": 14, "transformerdecod": 14, "transformerlay": 14, "stage": 15, "mani": [15, 16], "yet": [15, 16], "been": [15, 16], "roadmap": 15, "fuse": 15, "introduc": [15, 16], "slow": 15, "down": [15, 16], "trip": 15, "memori": 15, "intend": 15, "address": [15, 16], "next": [15, 16], "flash": 15, "interplai": 15, "investig": [15, 16], "op": [15, 16], "onc": 15, "exhaust": 15, "encourag": 15, "touch": 15, "request": 15, "To": 16, "git": 16, "com": 16, "clone": 16, "fork": 16, "repo": 16, "instruct": 16, "paradigm": 16, "deep": 16, "aim": 16, "befor": 16, "involv": 16, "term": 16, "unprincipl": 16, "wai": 16, "re": 16, "common": 16, "ensur": 16, "now": 16, "preserv": 16, "As": 16, "scratch": 16, "determin": 16, "assumpt": 16, "typic": 16, "advantag": 16, "great": 16, "point": 16, "perspect": 16, "roughli": 16, "equal": 16, "headroom": 16, "grow": 16, "shrink": 16, "underflow": 16, "occur": 16, "becaus": 16, "although": 16, "drift": 16, "stai": 16, "within": 16, "test": 16, "thu": 16, "far": 16, "smaller": 16, "effici": 16, "even": 16, "behaviour": 16, "dynam": 16, "slightli": 16, "In": 16, "experi": 16, "lead": 16, "decreas": 16, "faster": 16, "though": 16, "depth": 16, "treatment": 16, "approach": 16, "similar": 16, "motiv": 16, "keep": 16, "sens": 16, "understand": 16, "might": 16, "go": 16, "fp32": 16, "bf16": 16, "issu": 16, "repres": 16, "veri": 16, "larg": 16, "small": 16, "3e": 16, "38": 16, "45": 16, "e5": 16, "60": 16, "000": 16, "6e": 16, "e4": 16, "try": 16, "put": 16, "speed": 16, "most": 16, "discuss": 16, "scope": 16, "introduct": 16, "analys": 16, "step": 16, "present": 16, "analysi": 16, "tricki": 16, "tool": 16, "easi": 16, "util": 16, "analyse_modul": 16, "fx": 16, "line": 16, "breakdown": 16, "alongsid": 16, "unscaledmlp": 16, "def": 16, "__init__": 16, "super": 16, "linear_1": 16, "linear_2": 16, "deriv": 16, "8": 16, "requires_grad_": 16, "fed": 16, "fwd": 16, "bwd": 16, "annotated_cod": 16, "204": 16, "linear_1_weight": 16, "018": 16, "83": 16, "linear_1_bia": 16, "84": 16, "_c": 16, "_nn": 16, "578": 16, "177": 16, "322": 16, "289": 16, "linear_2_weight": 16, "00902": 16, "48": 16, "linear_2_bia": 16, "00894": 16, "198": 16, "firstli": 16, "decompos": 16, "secondli": 16, "append": 16, "tupl": 16, "fwd_scale": 16, "bwd_scale": 16, "denot": 16, "left": 16, "sign": 16, "abov": 16, "receiv": 16, "These": 16, "enough": 16, "unscal": 16, "could": 16, "caus": 16, "signific": 16, "show": 16, "correct": 16, "drop": 16, "scaledmlp": 16, "01": 16, "716": 16, "729": 16, "707": 16, "64": 16, "706": 16, "693": 16, "03": 16, "979": 16, "999": 16, "basic": 16, "avail": 16, "other": 16, "repeat": 16, "until": 16, "good": 16, "desir": 16, "There": 16, "measur": 16, "someth": 16, "art": 16, "max": 16, "min": 16, "aris": 16, "overflow": 16, "seen": 16, "clearli": 16, "explod": 16, "clip": 16, "convers": 16, "tend": 16, "degrad": 16, "steadili": 16, "exactli": 16, "meet": 16, "practic": 16, "concern": 16, "significantli": 16, "merit": 16, "divis": 16, "substanti": 16, "cross_entropi": 16, "mechan": 16, "control": 16, "initialis": 16, "xavier": 16, "glorot": 16, "push": 16, "themselv": 16, "howev": 16, "solv": 16, "outsid": 16, "separ": 16, "altern": 16, "conjunct": 16, "particular": 16, "care": 16, "must": 16, "togeth": 16, "form": 16, "residuallay": 16, "residual_split": 16, "residual_add": 16, "contrast": 16, "through": 16, "domin": 16, "hyperparamet": 16, "abl": 16, "leav": 16, "without": 16, "tune": 16, "emploi": 16, "trick": 16, "delai": 16, "comprehens": 16, "purpos": 16, "order": 16, "produc": 16, "arriv": 16, "share": 16, "fan_in": 16, "fan_out": 16, "grad_weight_scal": 16, "grad_bias_scal": 16, "batch_siz": 16, "ideal": 16, "one": 16, "suppli": 16, "exact": 16, "geometr": 16, "compromis": 16, "don": 16, "why": 16}, "objects": {"": [[2, 0, 0, "-", "unit_scaling"]], "unit_scaling": [[3, 1, 1, "", "CrossEntropyLoss"], [4, 1, 1, "", "Dropout"], [5, 1, 1, "", "Embedding"], [6, 1, 1, "", "GELU"], [7, 1, 1, "", "LayerNorm"], [8, 1, 1, "", "Linear"], [9, 1, 1, "", "MHSA"], [10, 1, 1, "", "MLP"], [11, 1, 1, "", "Softmax"], [12, 1, 1, "", "TransformerDecoder"], [13, 1, 1, "", "TransformerLayer"]], "unit_scaling.Embedding": [[5, 2, 1, "", "from_pretrained"], [5, 3, 1, "", "weight"]], "unit_scaling.LayerNorm": [[7, 3, 1, "", "bias"], [7, 3, 1, "", "weight"]], "unit_scaling.Linear": [[8, 3, 1, "", "bias"], [8, 3, 1, "", "weight"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:attribute"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "attribute", "Python attribute"]}, "titleterms": {"api": 0, "refer": 0, "unit": [1, 14, 16], "scale": [1, 14, 16], "develop": 1, "licens": 1, "unit_sc": [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13], "crossentropyloss": 3, "dropout": 4, "embed": 5, "gelu": 6, "layernorm": 7, "linear": 8, "mhsa": 9, "mlp": 10, "softmax": 11, "transformerdecod": 12, "transformerlay": 13, "content": 14, "limit": 15, "user": 16, "guid": 16, "instal": 16, "what": 16, "i": 16, "how": 16, "model": 16, "kei": 16, "consider": 16}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 8, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.viewcode": 1, "sphinx": 57}, "alltitles": {"API Reference": [[0, "api-reference"]], "Unit Scaling": [[1, "unit-scaling"], [14, "unit-scaling"]], "Development": [[1, "development"]], "License": [[1, "license"]], "unit_scaling": [[2, "module-unit_scaling"]], "unit_scaling.CrossEntropyLoss": [[3, "unit-scaling-crossentropyloss"]], "unit_scaling.Dropout": [[4, "unit-scaling-dropout"]], "unit_scaling.Embedding": [[5, "unit-scaling-embedding"]], "unit_scaling.GELU": [[6, "unit-scaling-gelu"]], "unit_scaling.LayerNorm": [[7, "unit-scaling-layernorm"]], "unit_scaling.Linear": [[8, "unit-scaling-linear"]], "unit_scaling.MHSA": [[9, "unit-scaling-mhsa"]], "unit_scaling.MLP": [[10, "unit-scaling-mlp"]], "unit_scaling.Softmax": [[11, "unit-scaling-softmax"]], "unit_scaling.TransformerDecoder": [[12, "unit-scaling-transformerdecoder"]], "unit_scaling.TransformerLayer": [[13, "unit-scaling-transformerlayer"]], "Contents": [[14, null]], "Limitations": [[15, "limitations"]], "User Guide": [[16, "user-guide"]], "Installation": [[16, "installation"]], "What is unit scaling?": [[16, "what-is-unit-scaling"]], "How to unit-scale a model": [[16, "how-to-unit-scale-a-model"]], "Key considerations for unit scaling": [[16, "key-considerations-for-unit-scaling"]]}, "indexentries": {"module": [[2, "module-unit_scaling"]], "unit_scaling": [[2, "module-unit_scaling"]], "crossentropyloss (class in unit_scaling)": [[3, "unit_scaling.CrossEntropyLoss"]], "dropout (class in unit_scaling)": [[4, "unit_scaling.Dropout"]], "embedding (class in unit_scaling)": [[5, "unit_scaling.Embedding"]], "from_pretrained() (unit_scaling.embedding class method)": [[5, "unit_scaling.Embedding.from_pretrained"]], "weight (unit_scaling.embedding attribute)": [[5, "unit_scaling.Embedding.weight"]], "gelu (class in unit_scaling)": [[6, "unit_scaling.GELU"]], "layernorm (class in unit_scaling)": [[7, "unit_scaling.LayerNorm"]], "bias (unit_scaling.layernorm attribute)": [[7, "unit_scaling.LayerNorm.bias"]], "weight (unit_scaling.layernorm attribute)": [[7, "unit_scaling.LayerNorm.weight"]], "linear (class in unit_scaling)": [[8, "unit_scaling.Linear"]], "bias (unit_scaling.linear attribute)": [[8, "unit_scaling.Linear.bias"]], "weight (unit_scaling.linear attribute)": [[8, "unit_scaling.Linear.weight"]], "mhsa (class in unit_scaling)": [[9, "unit_scaling.MHSA"]], "mlp (class in unit_scaling)": [[10, "unit_scaling.MLP"]], "softmax (class in unit_scaling)": [[11, "unit_scaling.Softmax"]], "transformerdecoder (class in unit_scaling)": [[12, "unit_scaling.TransformerDecoder"]], "transformerlayer (class in unit_scaling)": [[13, "unit_scaling.TransformerLayer"]]}})